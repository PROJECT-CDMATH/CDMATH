<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>MED fichier: Concepts et fonctionnalit&eacute;s avanc&eacute;s sur les maillages</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Généré par Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Documentation&nbsp;MED</span></a></li>
      <li class="current"><a href="pages.html"><span>Guides&nbsp;d'utilisation</span></a></li>
      <li><a href="modules.html"><span>Guides&nbsp;de&nbsp;référence</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">


<h1><a class="anchor" id="maillage_avances">Concepts et fonctionnalit&eacute;s avanc&eacute;s sur les maillages </a></h1><p><a class="anchor" id="____Concepts et fonctionnalit&eacute;s avanc&eacute;s sur les maillages____"></a>  <a href="#1.">Cr&eacute;er et lire dans un maillage des &eacute;l&eacute;ments de type polygones et poly&egrave;dres quelconques</a>  </p>
<p><a href="#2.">Cr&eacute;er et lire un maillage avec gestion des profils sur les entit&eacute;s</a>  </p>
<p><a href="#3.">Cr&eacute;er et lire un maillage &eacute;volutif</a>  </p>
<p><a href="#4.">Cr&eacute;er et lire une &eacute;quivalence entre les entit&eacute;s d'un maillage</a>  </p>
<p><a href="#5.">Cr&eacute;er et lire un maillage avec des &eacute;l&eacute;ments de structure</a>  </p>
<p><a href="#6.">Ecriture et lecture en parall&egrave;le par la d&eacute;composition de domaine </a>  </p>
<h3><a class="anchor" id="1."></a>Cr&eacute;er et lire dans un maillage des &eacute;l&eacute;ments de type polygones et poly&egrave;dres quelconques</h3>
<p>En plus des types g&eacute;om&eacute;triques pr&eacute;d&eacute;finis (exemples : MED_SEG2, MED_SEG3, MED_TRIA3, ...), il est possible de d&eacute;finir dans un maillage non structur&eacute; des &eacute;l&eacute;ments qui correspondent &agrave; des polygones (mailles ou faces) ou des poly&egrave;dres (mailles) quelconques.  </p>
<p>Pour d&eacute;crire la g&eacute;om&eacute;trie et la connectivit&eacute; des mailles/faces polygones quelconques, il s'agit d'adopter la convention suivante. L'ordre de stockage des polygones est libre -i.e. n'est pas r&eacute;gi par l'ordre des types g&eacute;om&eacute;triques (donn&eacute; par le nombre de sommets). Par exemple, si on a 2 polygones &agrave; 5 sommets (P5) et 1 polygone &agrave; 6 sommets (P6), on peut stocker la connectivit&eacute; de ces &eacute;l&eacute;ments dans l'ordre suivant : P5, P6, P5. On acc&egrave;de &agrave; la connectivit&eacute; de chaque polygone par l'interm&eacute;diaire d'un tableau d'indexation. Pour notre exemple cela revient &agrave; avoir les 2 tableaux suivants (les indexations dans MED d&eacute;butent par convention &agrave; l'indice 1) :  </p>
<div align="center">
<img src="../png/exemple_connectivite_polygones.png" alt="exemple_connectivite_polygones.png"/>
</div>
  <p>En connectivit&eacute; nodale, les entiers stock&eacute;s dans le tableau de connectivit&eacute; correspondent &agrave; des num&eacute;ros de noeuds alors qu'en connectivit&eacute; descendante, ils correspondent &agrave; des num&eacute;ros d'ar&ecirc;tes.  </p>
<p>L'&eacute;criture de la connectivit&eacute; des polygones d'un maillage s'appuie sur une routine d&eacute;di&eacute;e <a class="el" href="a01011_gad376c2d3d0e4d23604b2e3d148a8e796.html#gad376c2d3d0e4d23604b2e3d148a8e796">MEDmeshPolygonWr</a> / <a class="el" href="a01026_ga4db0ef0f4babe52baa64350185067da3.html#ga4db0ef0f4babe52baa64350185067da3">mmhpgw</a> qui prend en param&egrave;tres les tableaux d'indexation et de connectivit&eacute;. A noter que le seul mode de stockage possible du tableau de connectivit&eacute; est le mode non entrelac&eacute;. </p>
<div class="fragment"><pre class="fragment"><span class="comment">/*  This file is part of MED.</span>
<span class="comment"> *</span>
<span class="comment"> *  COPYRIGHT (C) 1999 - 2012  EDF R&amp;D, CEA/DEN</span>
<span class="comment"> *  MED is free software: you can redistribute it and/or modify</span>
<span class="comment"> *  it under the terms of the GNU Lesser General Public License as published by</span>
<span class="comment"> *  the Free Software Foundation, either version 3 of the License, or</span>
<span class="comment"> *  (at your option) any later version.</span>
<span class="comment"> *</span>
<span class="comment"> *  MED is distributed in the hope that it will be useful,</span>
<span class="comment"> *  but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="comment"> *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<span class="comment"> *  GNU Lesser General Public License for more details.</span>
<span class="comment"> *</span>
<span class="comment"> *  You should have received a copy of the GNU Lesser General Public License</span>
<span class="comment"> *  along with MED.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span>
<span class="comment"> */</span>

<span class="comment">/*</span>
<span class="comment"> *  Use case 13 : a 2D unstructured mesh with 12 nodes and 2 polygons</span>
<span class="comment"> */</span>

<span class="preprocessor">#include &lt;med.h&gt;</span>
<span class="preprocessor">#define MESGERR 1</span>
<span class="preprocessor"></span><span class="preprocessor">#include &lt;med_utils.h&gt;</span>

<span class="preprocessor">#include &lt;string.h&gt;</span>

<span class="keywordtype">int</span> <a class="code" href="a00750_a3c04138a5bfe5d72780bb7e82a18e627.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a> (<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> **argv) {
  <a class="code" href="a00320_afa4ec8284026c8c5545e5333475fb65a.html#afa4ec8284026c8c5545e5333475fb65a">med_idt</a> fid;
  <span class="keyword">const</span> <span class="keywordtype">char</span> meshname[<a class="code" href="a00321_a0ae989cbbfeecbb5296b3ceba8dab886.html#a0ae989cbbfeecbb5296b3ceba8dab886">MED_NAME_SIZE</a>+1] = <span class="stringliteral">&quot;2D unstructured mesh&quot;</span>;
  <span class="keyword">const</span> <a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> spacedim = 2;
  <span class="keyword">const</span> <a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> meshdim = 2;
  <span class="comment">/*                                         12345678901234561234567890123456 */</span>
  <span class="keyword">const</span> <span class="keywordtype">char</span> axisname[2*<a class="code" href="a00321_a213ecd1a546eb96092b980a870bc386b.html#a213ecd1a546eb96092b980a870bc386b">MED_SNAME_SIZE</a>+1] = <span class="stringliteral">&quot;x               y               &quot;</span>;
  <span class="keyword">const</span> <span class="keywordtype">char</span> unitname[2*<a class="code" href="a00321_a213ecd1a546eb96092b980a870bc386b.html#a213ecd1a546eb96092b980a870bc386b">MED_SNAME_SIZE</a>+1] = <span class="stringliteral">&quot;cm              cm              &quot;</span>;
  <span class="keyword">const</span> <a class="code" href="a00320_ab1eab99ca56ac95ce5b1c0e4ae0f095a.html#ab1eab99ca56ac95ce5b1c0e4ae0f095a">med_float</a> coordinates[2*12] = { 0.5,   0.,  
                                        1.5,   0.,  
                                        0.,    0.5,
                                        1.,    0.5,
                                        2.,    0.5,
                                        0.,    1.,
                                        1.,    1.,
                                        2.,    1.,
                                        0.5,   2.,
                                        1.5,   2. };
  <span class="keyword">const</span> <a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> nnodes = 12;
  <span class="keyword">const</span> <a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> indexsize = 3;
  <span class="keyword">const</span> <a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> index[3] = {1,7,13};
  <span class="comment">/* connectivity : 2 hexagons */</span>
  <span class="keyword">const</span> <a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> connectivity[12] = {1,4,7,9,6,3,
                                    2,5,8,10,7,4};
  <span class="keywordtype">int</span> ret=-1;
  
  <span class="comment">/* open MED file */</span>
  fid = <a class="code" href="a01005_ga9376a1654b7bf099c3f8941074c5fdfb.html#ga9376a1654b7bf099c3f8941074c5fdfb" title="Ouverture d&amp;#39;un fichier MED.">MEDfileOpen</a>(<span class="stringliteral">&quot;UsesCase_MEDmesh_13.med&quot;</span>,
                    <a class="code" href="a00321_adcd0322de9fec3b5e199ffeda3f44c85.html#adcd0322de9fec3b5e199ffeda3f44c85aa23dd1c18b596924d5f50c8402b84c8e">MED_ACC_CREAT</a>);
  <span class="keywordflow">if</span> (fid &lt; 0) {
    <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : file creation ...&quot;</span>);
    <span class="keywordflow">goto</span> ERROR;
  }

  <span class="comment">/* write a comment in the file */</span>
  <span class="keywordflow">if</span> (<a class="code" href="a01005_ga08d625f5403fefb9deb7d47f9a915c41.html#ga08d625f5403fefb9deb7d47f9a915c41" title="Ecriture d&amp;#39;un descripteur dans un fichier MED.">MEDfileCommentWr</a>(fid,
                       <span class="stringliteral">&quot;A 2D unstructured mesh : 12, 12 polygons&quot;</span>) &lt; 0) {
    <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : write file description ...&quot;</span>);
    <span class="keywordflow">goto</span> ERROR;
  }
  
  <span class="comment">/* mesh creation : a 2D unstructured mesh */</span>
  <span class="keywordflow">if</span> (<a class="code" href="a01011_ga6007c3f1a62732e7a46c5eca232be78a.html#ga6007c3f1a62732e7a46c5eca232be78a" title="Cette routine permet de créer un maillage dans un fichier.">MEDmeshCr</a>(fid, 
                meshname, 
                spacedim, 
                meshdim, 
                <a class="code" href="a00321_a821a4dd94c5c6b095318432bdec8d8a1.html#a821a4dd94c5c6b095318432bdec8d8a1a3719e53a4838d222f0a58148292fda41">MED_UNSTRUCTURED_MESH</a>, 
                <span class="stringliteral">&quot;A 2D mesh with 2 polygons&quot;</span>,
                <span class="stringliteral">&quot;&quot;</span>,
                <a class="code" href="a00321_a5b97067a30629cd60470d074691d6798.html#a5b97067a30629cd60470d074691d6798ae896b6adfbde9870b4e875e5167eddd0">MED_SORT_DTIT</a>,
                <a class="code" href="a00321_a57867e4bed1d104c865cfc9d23c9204d.html#a57867e4bed1d104c865cfc9d23c9204da682ef7f1042079519664eae87f90297e">MED_CARTESIAN</a>, 
                axisname, 
                unitname) &lt; 0) {
    <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : mesh creation ...&quot;</span>);
    <span class="keywordflow">goto</span> ERROR;
  }

  <span class="comment">/* nodes coordinates in a cartesian axis in full interlace mode </span>
<span class="comment">     (X1,Y1, X2,Y2, X3,Y3, ...) with no iteration and computation step </span>
<span class="comment">  */</span>
  <span class="keywordflow">if</span> (<a class="code" href="a01011_gab2a6fcbbb0dfb0dba573320ed07f503b.html#gab2a6fcbbb0dfb0dba573320ed07f503b" title="Cette routine permet d&amp;#39;écrire dans un maillage le tableau des coordonnées des...">MEDmeshNodeCoordinateWr</a>(fid, 
                              meshname, 
                              <a class="code" href="a00321_a8f72b6ceb3b6f5a67f9efd46cb90707a.html#a8f72b6ceb3b6f5a67f9efd46cb90707a">MED_NO_DT</a>, 
                              <a class="code" href="a00321_a95919207fd7a18ba26e6e03f04811e3f.html#a95919207fd7a18ba26e6e03f04811e3f">MED_NO_IT</a>, 
                              <a class="code" href="a00321_a609885580ce660eb5b7c80074d64f93f.html#a609885580ce660eb5b7c80074d64f93f">MED_UNDEF_DT</a>,
                              <a class="code" href="a00320_a0ac861d71fe5e0be056a86f9212f1c6a.html#a0ac861d71fe5e0be056a86f9212f1c6aa9a1509b3f93e5915a24f555890c73ee1">MED_FULL_INTERLACE</a>, 
                              nnodes, 
                              coordinates) &lt; 0) {
    <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : nodes coordinates ...&quot;</span>);
    <span class="keywordflow">goto</span> ERROR;
  }

  <span class="comment">/* cells connectiviy is defined in nodal mode */</span>
  <span class="comment">/* 2 polygons */</span>
  <span class="keywordflow">if</span> (<a class="code" href="a01011_gad376c2d3d0e4d23604b2e3d148a8e796.html#gad376c2d3d0e4d23604b2e3d148a8e796" title="Cette routine permet l&amp;#39;écriture des connectivités de polygones.">MEDmeshPolygonWr</a>(fid,
                       meshname,
                       <a class="code" href="a00321_a8f72b6ceb3b6f5a67f9efd46cb90707a.html#a8f72b6ceb3b6f5a67f9efd46cb90707a">MED_NO_DT</a>,
                       <a class="code" href="a00321_a95919207fd7a18ba26e6e03f04811e3f.html#a95919207fd7a18ba26e6e03f04811e3f">MED_NO_IT</a>,
                       <a class="code" href="a00321_a609885580ce660eb5b7c80074d64f93f.html#a609885580ce660eb5b7c80074d64f93f">MED_UNDEF_DT</a>,
                       <a class="code" href="a00321_aab0e957294723517d5c3641bb71b0470.html#aab0e957294723517d5c3641bb71b0470a227d14957ec5f221685cb1d6ec3b6c67">MED_CELL</a>,
                       <a class="code" href="a00321_afcd26ca66a179b9aa82f5c90602c4ed8.html#afcd26ca66a179b9aa82f5c90602c4ed8a4ae92e7de0898383577cbba640006baa">MED_NODAL</a>,
                       indexsize,
                       index,
                       connectivity) &lt; 0) {
    <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : polygon connectivity ...&quot;</span>);
    <span class="keywordflow">goto</span> ERROR;
  }


  <span class="comment">/* create family 0 : by default, all mesh entities family number is 0 */</span>
  <span class="keywordflow">if</span> (<a class="code" href="a01003_ga0873b54d0dc1472eee12c42aaf4fbca3.html#ga0873b54d0dc1472eee12c42aaf4fbca3" title="Cette routine permet la création d&amp;#39;une famille portant sur les entités d&amp;#39;un...">MEDfamilyCr</a>(fid, 
                  meshname,
                  <a class="code" href="a00321_afd1f2684a3484575283e2a46f2d809da.html#afd1f2684a3484575283e2a46f2d809da">MED_NO_NAME</a>, 
                  0, 
                  0, 
                  <a class="code" href="a00321_a41b68e0bf49e21cf091f12ee6d9ab66c.html#a41b68e0bf49e21cf091f12ee6d9ab66c">MED_NO_GROUP</a>) &lt; 0) {
    <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : family 0 creation ...&quot;</span>);
    <span class="keywordflow">goto</span> ERROR;
  }

  ret=0;
 ERROR:
  
  <span class="comment">/* close MED file */</span>
  <span class="keywordflow">if</span> (<a class="code" href="a01005_ga12a0e901c376be997a41a073ce426283.html#ga12a0e901c376be997a41a073ce426283" title="Fermeture d&amp;#39;un fichier MED.">MEDfileClose</a>(fid)  &lt; 0) {
    <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : close file ...&quot;</span>);
    ret=-1;
  }

  <span class="keywordflow">return</span> ret;
}
</pre></div> <p>La lecture de la connectivit&eacute; des polygones d'un maillage demande une approche sp&eacute;cifique. Il est d'abord n&eacute;cessaire d'appeler 2 fois la routine <a class="el" href="a01011_ga45758103360dacf7b8a6c53ebfa4d7e5.html#ga45758103360dacf7b8a6c53ebfa4d7e5">MEDmeshnEntity</a> / <a class="el" href="a01026_gad8041d49270c560eb727621625424759.html#gad8041d49270c560eb727621625424759">mmhnme</a>. Le premier appel permet de r&eacute;cup&eacute;rer la taille du tableau d'indexation (le nombre de polygone pr&eacute;sent dans le maillage est &eacute;gal &agrave; la taille de ce tableau -1). Le second appel permet de lire la taille du tableau de connectivit&eacute; qu'il est n&eacute;cessaire d'allouer en m&eacute;moire. Enfin la routine <a class="el" href="a01011_ga46e9af0a7a67660e728665c4b8e65f61.html#ga46e9af0a7a67660e728665c4b8e65f61">MEDmeshPolygonRd</a> / <a class="el" href="a01026_ga24a3b956d5dcf009aa28eb4f85918f1d.html#ga24a3b956d5dcf009aa28eb4f85918f1d">mmhpgr</a> va lire les tableaux d'indexation et de connectivit&eacute;. </p>
<p>Le cas d'utilisation suivant montre comment lire la connectivit&eacute; des polygones d'un maillage. </p>
<div class="fragment"><pre class="fragment"><span class="comment">/*  This file is part of MED.</span>
<span class="comment"> *</span>
<span class="comment"> *  COPYRIGHT (C) 1999 - 2012  EDF R&amp;D, CEA/DEN</span>
<span class="comment"> *  MED is free software: you can redistribute it and/or modify</span>
<span class="comment"> *  it under the terms of the GNU Lesser General Public License as published by</span>
<span class="comment"> *  the Free Software Foundation, either version 3 of the License, or</span>
<span class="comment"> *  (at your option) any later version.</span>
<span class="comment"> *</span>
<span class="comment"> *  MED is distributed in the hope that it will be useful,</span>
<span class="comment"> *  but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="comment"> *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<span class="comment"> *  GNU Lesser General Public License for more details.</span>
<span class="comment"> *</span>
<span class="comment"> *  You should have received a copy of the GNU Lesser General Public License</span>
<span class="comment"> *  along with MED.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span>
<span class="comment"> */</span>

<span class="comment">/*</span>
<span class="comment"> *  Use case 14 : read a 2D unstructured mesh with 2 polygons</span>
<span class="comment"> */</span>

<span class="preprocessor">#include &lt;med.h&gt;</span>
<span class="preprocessor">#define MESGERR 1</span>
<span class="preprocessor"></span><span class="preprocessor">#include &lt;med_utils.h&gt;</span>

<span class="preprocessor">#include &lt;string.h&gt;</span>

<span class="keywordtype">int</span> <a class="code" href="a00750_a3c04138a5bfe5d72780bb7e82a18e627.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a> (<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> **argv) {
  <a class="code" href="a00320_afa4ec8284026c8c5545e5333475fb65a.html#afa4ec8284026c8c5545e5333475fb65a">med_idt</a> fid;
  <span class="keyword">const</span> <span class="keywordtype">char</span> meshname[<a class="code" href="a00321_a0ae989cbbfeecbb5296b3ceba8dab886.html#a0ae989cbbfeecbb5296b3ceba8dab886">MED_NAME_SIZE</a>+1] = <span class="stringliteral">&quot;2D unstructured mesh&quot;</span>;
  <span class="keywordtype">char</span> meshdescription[<a class="code" href="a00321_ab69710ecf9f5257080a943579852d0f0.html#ab69710ecf9f5257080a943579852d0f0">MED_COMMENT_SIZE</a>+1]=<span class="stringliteral">&quot;&quot;</span>;
  <a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> meshdim;
  <a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> spacedim;
  <a class="code" href="a00321_a5b97067a30629cd60470d074691d6798.html#a5b97067a30629cd60470d074691d6798">med_sorting_type</a> sortingtype;
  <a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> nstep;
  <a class="code" href="a00321_a821a4dd94c5c6b095318432bdec8d8a1.html#a821a4dd94c5c6b095318432bdec8d8a1">med_mesh_type</a> meshtype;
  <a class="code" href="a00321_a57867e4bed1d104c865cfc9d23c9204d.html#a57867e4bed1d104c865cfc9d23c9204d">med_axis_type</a> axistype;
  <span class="keywordtype">char</span> axisname[2*<a class="code" href="a00321_a213ecd1a546eb96092b980a870bc386b.html#a213ecd1a546eb96092b980a870bc386b">MED_SNAME_SIZE</a>+1]=<span class="stringliteral">&quot;&quot;</span>;
  <span class="keywordtype">char</span> unitname[2*<a class="code" href="a00321_a213ecd1a546eb96092b980a870bc386b.html#a213ecd1a546eb96092b980a870bc386b">MED_SNAME_SIZE</a>+1]=<span class="stringliteral">&quot;&quot;</span>;
  <span class="keywordtype">char</span> dtunit[<a class="code" href="a00321_a213ecd1a546eb96092b980a870bc386b.html#a213ecd1a546eb96092b980a870bc386b">MED_SNAME_SIZE</a>+1]=<span class="stringliteral">&quot;&quot;</span>;
  <a class="code" href="a00320_ab1eab99ca56ac95ce5b1c0e4ae0f095a.html#ab1eab99ca56ac95ce5b1c0e4ae0f095a">med_float</a> *coordinates = NULL;
  <a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> nnodes = 0;
  <a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> npoly = 0;
  <a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> indexsize;
  <a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> *index = NULL;
  <a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> *connectivity = NULL;
  <a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> connectivitysize;
  <a class="code" href="a00321_a23f7fa6d76886ed3c91dc33b59190dee.html#a23f7fa6d76886ed3c91dc33b59190dee">med_bool</a> coordinatechangement;
  <a class="code" href="a00321_a23f7fa6d76886ed3c91dc33b59190dee.html#a23f7fa6d76886ed3c91dc33b59190dee">med_bool</a> geotransformation;
  <span class="keywordtype">int</span> i;
  <span class="keywordtype">int</span> k,ind1,ind2;
  <span class="keywordtype">int</span> ret=-1;

  <span class="comment">/* open MED file with READ ONLY access mode */</span>
  fid = <a class="code" href="a01005_ga9376a1654b7bf099c3f8941074c5fdfb.html#ga9376a1654b7bf099c3f8941074c5fdfb" title="Ouverture d&amp;#39;un fichier MED.">MEDfileOpen</a>(<span class="stringliteral">&quot;UsesCase_MEDmesh_13.med&quot;</span>,<a class="code" href="a00321_adcd0322de9fec3b5e199ffeda3f44c85.html#adcd0322de9fec3b5e199ffeda3f44c85a616bf8345c622a34f0787f42eb400f25">MED_ACC_RDONLY</a>);
  <span class="keywordflow">if</span> (fid &lt; 0) {
    <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : open file in READ ONLY ACCESS mode ...&quot;</span>);
    <span class="keywordflow">goto</span> ERROR;
  }

  <span class="comment">/* </span>
<span class="comment">   * ... we know that the MED file has only one mesh, </span>
<span class="comment">   * a real code working would check ... </span>
<span class="comment">   */</span>

  <span class="comment">/* read mesh informations : mesh dimension, space dimension ... */</span>
  <span class="keywordflow">if</span> (<a class="code" href="a01011_gaf5e84a05155579ded1ba18a672385f97.html#gaf5e84a05155579ded1ba18a672385f97" title="Cette routine permet de lire les informations relatives à un maillage en précisant...">MEDmeshInfoByName</a>(fid, meshname, &amp;spacedim, &amp;meshdim, &amp;meshtype, meshdescription, 
                        dtunit, &amp;sortingtype, &amp;nstep, &amp;axistype, axisname, unitname) &lt; 0) {
    <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : mesh info ...&quot;</span>);
    <span class="keywordflow">goto</span> ERROR;
  }

  <span class="comment">/* read how many nodes in the mesh */</span>
  <span class="keywordflow">if</span> ((nnodes = <a class="code" href="a01011_ga45758103360dacf7b8a6c53ebfa4d7e5.html#ga45758103360dacf7b8a6c53ebfa4d7e5" title="Cette routine permet de lire le nombre d&amp;#39;entités dans un maillage pour une séquence...">MEDmeshnEntity</a>(fid, meshname, <a class="code" href="a00321_a8f72b6ceb3b6f5a67f9efd46cb90707a.html#a8f72b6ceb3b6f5a67f9efd46cb90707a">MED_NO_DT</a>, <a class="code" href="a00321_a95919207fd7a18ba26e6e03f04811e3f.html#a95919207fd7a18ba26e6e03f04811e3f">MED_NO_IT</a>, <a class="code" href="a00321_aab0e957294723517d5c3641bb71b0470.html#aab0e957294723517d5c3641bb71b0470a074507163b07b6d764823a78c5c07f0f">MED_NODE</a>, <a class="code" href="a00321_aae1e86a4a1fce025bdadecb5e3e4a705.html#aae1e86a4a1fce025bdadecb5e3e4a705">MED_POINT1</a>,
                               <a class="code" href="a00321_a25ee4b3675737fc23511b28b3245c61b.html#a25ee4b3675737fc23511b28b3245c61bad78949eab3c743083dfbf687c92bbdcb">MED_COORDINATE</a>, <a class="code" href="a00321_afcd26ca66a179b9aa82f5c90602c4ed8.html#afcd26ca66a179b9aa82f5c90602c4ed8a2b1e772016688b78b808e96a44d1ee02">MED_NO_CMODE</a>,&amp;coordinatechangement,
                               &amp;geotransformation)) &lt; 0) {
    <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : number of nodes ...&quot;</span>);
    <span class="keywordflow">goto</span> ERROR;
  }
  
  <span class="comment">/* </span>
<span class="comment">   * ... we know that we only have MED_POLYGON celles in the mesh, </span>
<span class="comment">   * a real code working would check all MED geometry cell types ... </span>
<span class="comment">   */</span>

  <span class="comment">/* How many polygon in the mesh in nodal connectivity mode */</span>
  <span class="comment">/* For the polygons, we get the size of array index */</span>
  <span class="keywordflow">if</span> ((indexsize = <a class="code" href="a01011_ga45758103360dacf7b8a6c53ebfa4d7e5.html#ga45758103360dacf7b8a6c53ebfa4d7e5" title="Cette routine permet de lire le nombre d&amp;#39;entités dans un maillage pour une séquence...">MEDmeshnEntity</a>(fid,meshname,<a class="code" href="a00321_a8f72b6ceb3b6f5a67f9efd46cb90707a.html#a8f72b6ceb3b6f5a67f9efd46cb90707a">MED_NO_DT</a>,<a class="code" href="a00321_a95919207fd7a18ba26e6e03f04811e3f.html#a95919207fd7a18ba26e6e03f04811e3f">MED_NO_IT</a>,
                                  <a class="code" href="a00321_aab0e957294723517d5c3641bb71b0470.html#aab0e957294723517d5c3641bb71b0470a227d14957ec5f221685cb1d6ec3b6c67">MED_CELL</a>,<a class="code" href="a00321_a85eec62d6ac09df04ee4e0ca89586273.html#a85eec62d6ac09df04ee4e0ca89586273">MED_POLYGON</a>,<a class="code" href="a00321_a25ee4b3675737fc23511b28b3245c61b.html#a25ee4b3675737fc23511b28b3245c61baeeb4405ba174bcfebed019cf268ca8f2">MED_INDEX_NODE</a>,<a class="code" href="a00321_afcd26ca66a179b9aa82f5c90602c4ed8.html#afcd26ca66a179b9aa82f5c90602c4ed8a4ae92e7de0898383577cbba640006baa">MED_NODAL</a>,
                                  &amp;coordinatechangement,
                                  &amp;geotransformation)) &lt; 0) {
    <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : read number of polygon ...&quot;</span>);
    <span class="keywordflow">goto</span> ERROR;
  }
  npoly = indexsize-1;

  <span class="comment">/* how many nodes for the polygon connectivity ? */</span>
  <span class="keywordflow">if</span> ((connectivitysize = <a class="code" href="a01011_ga45758103360dacf7b8a6c53ebfa4d7e5.html#ga45758103360dacf7b8a6c53ebfa4d7e5" title="Cette routine permet de lire le nombre d&amp;#39;entités dans un maillage pour une séquence...">MEDmeshnEntity</a>(fid,meshname,<a class="code" href="a00321_a8f72b6ceb3b6f5a67f9efd46cb90707a.html#a8f72b6ceb3b6f5a67f9efd46cb90707a">MED_NO_DT</a>,<a class="code" href="a00321_a95919207fd7a18ba26e6e03f04811e3f.html#a95919207fd7a18ba26e6e03f04811e3f">MED_NO_IT</a>,
                                         <a class="code" href="a00321_aab0e957294723517d5c3641bb71b0470.html#aab0e957294723517d5c3641bb71b0470a227d14957ec5f221685cb1d6ec3b6c67">MED_CELL</a>,<a class="code" href="a00321_a85eec62d6ac09df04ee4e0ca89586273.html#a85eec62d6ac09df04ee4e0ca89586273">MED_POLYGON</a>,<a class="code" href="a00321_a25ee4b3675737fc23511b28b3245c61b.html#a25ee4b3675737fc23511b28b3245c61bac845229e0179819897411d7cb9186824">MED_CONNECTIVITY</a>,<a class="code" href="a00321_afcd26ca66a179b9aa82f5c90602c4ed8.html#afcd26ca66a179b9aa82f5c90602c4ed8a4ae92e7de0898383577cbba640006baa">MED_NODAL</a>,
                                         &amp;coordinatechangement,
                                         &amp;geotransformation)) &lt; 0) {
    <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : read connevity size ...&quot;</span>);
    <span class="keywordflow">goto</span> ERROR;
    }

  <span class="comment">/* read mesh nodes coordinates */</span>
  <span class="keywordflow">if</span> ((coordinates = (<a class="code" href="a00320_ab1eab99ca56ac95ce5b1c0e4ae0f095a.html#ab1eab99ca56ac95ce5b1c0e4ae0f095a">med_float</a>*) malloc(<span class="keyword">sizeof</span>(<a class="code" href="a00320_ab1eab99ca56ac95ce5b1c0e4ae0f095a.html#ab1eab99ca56ac95ce5b1c0e4ae0f095a">med_float</a>)*nnodes*spacedim)) == NULL) {
    <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : memory allocation ...&quot;</span>);
    <span class="keywordflow">goto</span> ERROR;
  }

  <span class="keywordflow">if</span> (<a class="code" href="a01011_ga392a4bd4e6d340020755de7353f8a528.html#ga392a4bd4e6d340020755de7353f8a528" title="Cette routine permet de lire dans un maillage le tableau des coordonnées des noeuds...">MEDmeshNodeCoordinateRd</a>(fid, meshname, <a class="code" href="a00321_a8f72b6ceb3b6f5a67f9efd46cb90707a.html#a8f72b6ceb3b6f5a67f9efd46cb90707a">MED_NO_DT</a>, <a class="code" href="a00321_a95919207fd7a18ba26e6e03f04811e3f.html#a95919207fd7a18ba26e6e03f04811e3f">MED_NO_IT</a>, <a class="code" href="a00320_a0ac861d71fe5e0be056a86f9212f1c6a.html#a0ac861d71fe5e0be056a86f9212f1c6aa9a1509b3f93e5915a24f555890c73ee1">MED_FULL_INTERLACE</a>,
                              coordinates) &lt; 0) {
    <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : nodes coordinates ...&quot;</span>);
    free(coordinates);
    <span class="keywordflow">goto</span> ERROR;
  }
  free(coordinates);

  <span class="comment">/* read polygons connectivity */</span>
  index = (<a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> *) malloc(<span class="keyword">sizeof</span>(<a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a>)*indexsize);
  connectivity = (<a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> *) malloc(<span class="keyword">sizeof</span>(<a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a>)*connectivitysize);

  <span class="keywordflow">if</span> (<a class="code" href="a01011_ga46e9af0a7a67660e728665c4b8e65f61.html#ga46e9af0a7a67660e728665c4b8e65f61" title="Cette routine permet la lecture des connectivités de polygones.">MEDmeshPolygonRd</a>(fid,meshname,<a class="code" href="a00321_a8f72b6ceb3b6f5a67f9efd46cb90707a.html#a8f72b6ceb3b6f5a67f9efd46cb90707a">MED_NO_DT</a>,<a class="code" href="a00321_a95919207fd7a18ba26e6e03f04811e3f.html#a95919207fd7a18ba26e6e03f04811e3f">MED_NO_IT</a>,<a class="code" href="a00321_aab0e957294723517d5c3641bb71b0470.html#aab0e957294723517d5c3641bb71b0470a227d14957ec5f221685cb1d6ec3b6c67">MED_CELL</a>,<a class="code" href="a00321_afcd26ca66a179b9aa82f5c90602c4ed8.html#afcd26ca66a179b9aa82f5c90602c4ed8a4ae92e7de0898383577cbba640006baa">MED_NODAL</a>,
                       index,connectivity) &lt; 0) {
    <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : read polygon connectivity ...&quot;</span>);
    free(index);
    free(connectivity);
    <span class="keywordflow">goto</span> ERROR;
  }
  free(index);
  free(connectivity);
  
  <span class="comment">/* </span>
<span class="comment">   * ... we know that the family number of nodes and elements is 0, a real working would check ...</span>
<span class="comment">   */</span>

  ret=0;
 ERROR:

  <span class="comment">/* close MED file */</span>
  <span class="keywordflow">if</span> (<a class="code" href="a01005_ga12a0e901c376be997a41a073ce426283.html#ga12a0e901c376be997a41a073ce426283" title="Fermeture d&amp;#39;un fichier MED.">MEDfileClose</a>(fid) &lt; 0) {
    <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : close file&quot;</span>);             
    ret=-1; 
  } 

  <span class="keywordflow">return</span> ret;
}

</pre></div> <p>Pour d&eacute;crire la g&eacute;om&eacute;trie et la connectivit&eacute; des mailles poly&egrave;dres quelconques, il s'agit d'adopter la convention suivante. Pour la connectivit&eacute; nodale, on acc&egrave;de &agrave; la connectivit&eacute; via un syst&egrave;me de double indexation : un premier tableau d'indexation "indexp" renvoie &agrave; la liste des faces de chaque poly&egrave;dre ; un second tableau "indexf" renvoie pour chaque face &agrave; la liste des noeuds la composant. Voici un exemple d'illustration pour d&eacute;finir la connectivit&eacute; de "n" poly&egrave;dres en mode nodal :  </p>
<div align="center">
<img src="../png/exemple_connectivite_nodale_polyedres.png" alt="exemple_connectivite_nodale_polyedres.png"/>
</div>
  <p>A noter que les faces communes sont d&eacute;crites 2 fois (m&ecirc;mes listes de noeuds mais orientations diff&eacute;rentes) et la normale des faces doit &ecirc;tre ext&eacute;rieure. </p>
<p><br/>
  </p>
<p>Pour la connectivit&eacute; descendante, un seul niveau d'indexation suffit (indexp). Le tableau des connectivit&eacute;s contient les num&eacute;ros des faces. Le tableau "indexf" contient alors le type g&eacute;om&eacute;trique de chaque face (exemple : MED_TRIA3). A noter que dans ce cas, "nf = consiz".  </p>
<p>Voici un exemple d'illustration : </p>
<div align="center">
<img src="../png/exemple_connectivite_descendante_polyedres.png" alt="exemple_connectivite_descendante_polyedres.png"/>
</div>
  <p><br/>
<br/>
  </p>
<p>L'&eacute;criture de la connectivit&eacute; des poly&egrave;dres d'un maillage s'appuie sur une routine d&eacute;di&eacute;e <a class="el" href="a01011_ga2b52e519ae9c3dc18c55a82c2dffbd27.html#ga2b52e519ae9c3dc18c55a82c2dffbd27">MEDmeshPolyhedronWr</a> / <a class="el" href="a01026_gaf49aab1a09801eb533e24300b0391377.html#gaf49aab1a09801eb533e24300b0391377">mmhphw</a> qui prend en param&egrave;tres les tableaux d'indexation et de connectivit&eacute;. A noter que le seul mode de stockage possible du tableau de connectivit&eacute; est le mode non entrelac&eacute;.  </p>
<p>L'exemple suivant propose l'&eacute;criture de la connectivit&eacute; de mailles poly&egrave;dres selon les deux modes de connectivit&eacute; possibles. A noter qu'au m&ecirc;me titre que les autres entit&eacute;s d'un maillage, les poly&egrave;dres (tout comme les polygones) portent un num&eacute;ro de famille (0 par d&eacute;faut) et peuvent porter un nom ou un num&eacute;ro optionnel. </p>
<div class="fragment"><pre class="fragment"><span class="comment">/*  This file is part of MED.</span>
<span class="comment"> *</span>
<span class="comment"> *  COPYRIGHT (C) 1999 - 2012  EDF R&amp;D, CEA/DEN</span>
<span class="comment"> *  MED is free software: you can redistribute it and/or modify</span>
<span class="comment"> *  it under the terms of the GNU Lesser General Public License as published by</span>
<span class="comment"> *  the Free Software Foundation, either version 3 of the License, or</span>
<span class="comment"> *  (at your option) any later version.</span>
<span class="comment"> *</span>
<span class="comment"> *  MED is distributed in the hope that it will be useful,</span>
<span class="comment"> *  but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="comment"> *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<span class="comment"> *  GNU Lesser General Public License for more details.</span>
<span class="comment"> *</span>
<span class="comment"> *  You should have received a copy of the GNU Lesser General Public License</span>
<span class="comment"> *  along with MED.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span>
<span class="comment"> */</span>


<span class="comment">/******************************************************************************</span>
<span class="comment"> * - Nom du fichier : test25.c</span>
<span class="comment"> *</span>
<span class="comment"> * - Description : ecriture de mailles de type MED_POLYEDRE</span>
<span class="comment"> *                 dans un maillage MED</span>
<span class="comment"> *</span>
<span class="comment"> *****************************************************************************/</span>

<span class="preprocessor">#include &lt;med.h&gt;</span>
<span class="preprocessor">#define MESGERR 1</span>
<span class="preprocessor"></span><span class="preprocessor">#include &lt;med_utils.h&gt;</span>

<span class="preprocessor">#ifdef DEF_LECT_ECR</span>
<span class="preprocessor"></span><span class="preprocessor">#define MODE_ACCES MED_ACC_RDWR</span>
<span class="preprocessor"></span><span class="preprocessor">#elif DEF_LECT_AJOUT</span>
<span class="preprocessor"></span><span class="preprocessor">#define MODE_ACCES MED_ACC_RDEXT</span>
<span class="preprocessor"></span><span class="preprocessor">#else</span>
<span class="preprocessor"></span><span class="preprocessor">#define MODE_ACCES MED_ACC_CREAT</span>
<span class="preprocessor"></span><span class="preprocessor">#endif</span>
<span class="preprocessor"></span>
<span class="keywordtype">int</span> <a class="code" href="a00750_a3c04138a5bfe5d72780bb7e82a18e627.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a> (<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> **argv)


{
  <a class="code" href="a00320_afa4ec8284026c8c5545e5333475fb65a.html#afa4ec8284026c8c5545e5333475fb65a">med_idt</a> fid;
  <span class="keywordtype">char</span> maa[<a class="code" href="a00321_a0ae989cbbfeecbb5296b3ceba8dab886.html#a0ae989cbbfeecbb5296b3ceba8dab886">MED_NAME_SIZE</a>+1] = <span class="stringliteral">&quot;maa1&quot;</span>;
  <a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> mdim = 3;
  <a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> n=2;
  <span class="comment">/* connectivite nodale */</span>
  <a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> indexf[3] = {1,5,9};
  <a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> nf = 3;
  <a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> indexn[9] = {1,4,7,10,13,16,19,22,25};
  <a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> nn = 9;
  <a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> conn[24] = {1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,
                      20,21,22,23,24};
  <span class="comment">/* connectivite descendante */</span>
  <a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> indexf2[3] = {1,5,9};
  <a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> nf2 = 3;
  <a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> conn2[8] = {1,2,3,4,5,6,7,8};
  <a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> indexn2[8] = {<a class="code" href="a00321_a4a1eb7ba296742a6f5eb8b5b23b39670.html#a4a1eb7ba296742a6f5eb8b5b23b39670">MED_TRIA3</a>,<a class="code" href="a00321_a4a1eb7ba296742a6f5eb8b5b23b39670.html#a4a1eb7ba296742a6f5eb8b5b23b39670">MED_TRIA3</a>,MED_TRIA3,MED_TRIA3,
                        MED_TRIA3,MED_TRIA3,MED_TRIA3,MED_TRIA3};
  <a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> nn2=8;
  <span class="comment">/*                             12345678901234561234567890123456*/</span>
  <span class="keywordtype">char</span> nom[<a class="code" href="a00321_a213ecd1a546eb96092b980a870bc386b.html#a213ecd1a546eb96092b980a870bc386b">MED_SNAME_SIZE</a>*2+1]=<span class="stringliteral">&quot;polyedre1       polyedre2       &quot;</span>;
  <a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> num[2] = {1,2};
  <a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> fam[2] = {0,-1};
  <span class="keywordtype">char</span> nomcoo[3*<a class="code" href="a00321_a213ecd1a546eb96092b980a870bc386b.html#a213ecd1a546eb96092b980a870bc386b">MED_SNAME_SIZE</a>+1] = <span class="stringliteral">&quot;x               y               z               &quot;</span>;
  <span class="keywordtype">char</span> unicoo[3*<a class="code" href="a00321_a213ecd1a546eb96092b980a870bc386b.html#a213ecd1a546eb96092b980a870bc386b">MED_SNAME_SIZE</a>+1] = <span class="stringliteral">&quot;cm              cm              cm              &quot;</span>;

  <span class="comment">/* Creation du fichier test25.med */</span>
  <span class="keywordflow">if</span> ((fid = <a class="code" href="a01005_ga9376a1654b7bf099c3f8941074c5fdfb.html#ga9376a1654b7bf099c3f8941074c5fdfb" title="Ouverture d&amp;#39;un fichier MED.">MEDfileOpen</a>(<span class="stringliteral">&quot;test25.med&quot;</span>,<a class="code" href="a00750_a29a43500a889d39744e184ece0d749be.html#a29a43500a889d39744e184ece0d749be">MODE_ACCES</a>)) &lt; 0) {
    <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;Erreur a la creation du fichier test25.med&quot;</span>);
    <span class="keywordflow">return</span> -1;
  }
  printf(<span class="stringliteral">&quot;Creation du fichier test25.med \n&quot;</span>);

  <span class="comment">/* Creation du maillage */</span>
 <span class="keywordflow">if</span> (<a class="code" href="a01011_ga6007c3f1a62732e7a46c5eca232be78a.html#ga6007c3f1a62732e7a46c5eca232be78a" title="Cette routine permet de créer un maillage dans un fichier.">MEDmeshCr</a>( fid, maa, mdim, mdim, <a class="code" href="a00321_a821a4dd94c5c6b095318432bdec8d8a1.html#a821a4dd94c5c6b095318432bdec8d8a1a3719e53a4838d222f0a58148292fda41">MED_UNSTRUCTURED_MESH</a>,
                 <span class="stringliteral">&quot;un maillage pour test25&quot;</span>,<span class="stringliteral">&quot;s&quot;</span>, <a class="code" href="a00321_a5b97067a30629cd60470d074691d6798.html#a5b97067a30629cd60470d074691d6798ae896b6adfbde9870b4e875e5167eddd0">MED_SORT_DTIT</a>,
                 <a class="code" href="a00321_a57867e4bed1d104c865cfc9d23c9204d.html#a57867e4bed1d104c865cfc9d23c9204da682ef7f1042079519664eae87f90297e">MED_CARTESIAN</a>, nomcoo, unicoo) &lt; 0) {
    <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;Erreur a la creation du maillage&quot;</span>);
    <span class="keywordflow">return</span> -1;
   }
  printf(<span class="stringliteral">&quot;Creation du maillage \n&quot;</span>);

  <span class="comment">/* Ecriture de la connectivite des mailles polyedres en mode nodal */</span>
  <span class="keywordflow">if</span> (<a class="code" href="a01011_ga2b52e519ae9c3dc18c55a82c2dffbd27.html#ga2b52e519ae9c3dc18c55a82c2dffbd27" title="Cette routine permet l&amp;#39;écriture dans un maillage des connectivités de polyèdres...">MEDmeshPolyhedronWr</a>(fid,maa,<a class="code" href="a00321_a8f72b6ceb3b6f5a67f9efd46cb90707a.html#a8f72b6ceb3b6f5a67f9efd46cb90707a">MED_NO_DT</a>,<a class="code" href="a00321_a95919207fd7a18ba26e6e03f04811e3f.html#a95919207fd7a18ba26e6e03f04811e3f">MED_NO_IT</a>,<a class="code" href="a00321_a609885580ce660eb5b7c80074d64f93f.html#a609885580ce660eb5b7c80074d64f93f">MED_UNDEF_DT</a>,<a class="code" href="a00321_aab0e957294723517d5c3641bb71b0470.html#aab0e957294723517d5c3641bb71b0470a227d14957ec5f221685cb1d6ec3b6c67">MED_CELL</a>,<a class="code" href="a00321_afcd26ca66a179b9aa82f5c90602c4ed8.html#afcd26ca66a179b9aa82f5c90602c4ed8a4ae92e7de0898383577cbba640006baa">MED_NODAL</a>,
                          nf,indexf,nn,indexn,conn) &lt; 0) {
    <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;Erreur a l&apos;ecriture de la connectivite des mailles MED_POLYGONE&quot;</span>);
    <span class="keywordflow">return</span> -1;
  }
  printf(<span class="stringliteral">&quot;Ecriture des connectivites de mailles de type MED_POLYEDRE en mode nodal \n&quot;</span>);

  <span class="comment">/* Ecriture des connectivites des mailles polyedres en mode descendant */</span>
  <span class="keywordflow">if</span> (<a class="code" href="a01011_ga2b52e519ae9c3dc18c55a82c2dffbd27.html#ga2b52e519ae9c3dc18c55a82c2dffbd27" title="Cette routine permet l&amp;#39;écriture dans un maillage des connectivités de polyèdres...">MEDmeshPolyhedronWr</a>(fid,maa,<a class="code" href="a00321_a8f72b6ceb3b6f5a67f9efd46cb90707a.html#a8f72b6ceb3b6f5a67f9efd46cb90707a">MED_NO_DT</a>,<a class="code" href="a00321_a95919207fd7a18ba26e6e03f04811e3f.html#a95919207fd7a18ba26e6e03f04811e3f">MED_NO_IT</a>,<a class="code" href="a00321_a609885580ce660eb5b7c80074d64f93f.html#a609885580ce660eb5b7c80074d64f93f">MED_UNDEF_DT</a>,<a class="code" href="a00321_aab0e957294723517d5c3641bb71b0470.html#aab0e957294723517d5c3641bb71b0470a227d14957ec5f221685cb1d6ec3b6c67">MED_CELL</a>,<a class="code" href="a00321_afcd26ca66a179b9aa82f5c90602c4ed8.html#afcd26ca66a179b9aa82f5c90602c4ed8a4eb55627c1d0cb8d008396813de45f2a">MED_DESCENDING</a>,
                          nf2,indexf2,nn2,indexn2,conn2) &lt; 0) {
    <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;Erreur a l&apos;ecriture des connectivites des mailles MED_POLYEDRE en mode descendant&quot;</span>);
    <span class="keywordflow">return</span> -1;
  }
  printf(<span class="stringliteral">&quot;Ecriture des connectivites de mailles de type MED_POLYEDRE en mode descendant \n&quot;</span>); 


  <span class="comment">/* Ecriture des noms des polyedres */</span>
  <span class="comment">/* ecriture (optionnelle) des noms des polyedres */</span>
  <span class="keywordflow">if</span> (<a class="code" href="a01011_ga3be091e7873665850c5adc47f8a69ed1.html#ga3be091e7873665850c5adc47f8a69ed1" title="Cette routine permet d&amp;#39;écrire les noms d&amp;#39;un type d&amp;#39;entité d&amp;#39;un...">MEDmeshEntityNameWr</a>(fid,maa,<a class="code" href="a00321_a8f72b6ceb3b6f5a67f9efd46cb90707a.html#a8f72b6ceb3b6f5a67f9efd46cb90707a">MED_NO_DT</a>,<a class="code" href="a00321_a95919207fd7a18ba26e6e03f04811e3f.html#a95919207fd7a18ba26e6e03f04811e3f">MED_NO_IT</a>,
                          <a class="code" href="a00321_aab0e957294723517d5c3641bb71b0470.html#aab0e957294723517d5c3641bb71b0470a227d14957ec5f221685cb1d6ec3b6c67">MED_CELL</a>,<a class="code" href="a00321_ae08587b134662b257542c6b64e6a998a.html#ae08587b134662b257542c6b64e6a998a">MED_POLYHEDRON</a>,n,nom) &lt; 0) {
    <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;Erreur a l&apos;ecriture des noms des polyedres&quot;</span>);
    <span class="keywordflow">return</span> -1;
  }
  printf(<span class="stringliteral">&quot;Ecriture des noms des polyedres \n&quot;</span>);

  <span class="comment">/* ecriture (optionnelle) des numeros des polyedres */</span>
  <span class="keywordflow">if</span> (<a class="code" href="a01011_ga792ce0b4bff70ca6ca593b7a271e47eb.html#ga792ce0b4bff70ca6ca593b7a271e47eb" title="Cette routine permet d&amp;#39;écrire les numéros d&amp;#39;un type d&amp;#39;entité d&amp;#39;un...">MEDmeshEntityNumberWr</a>(fid,maa,<a class="code" href="a00321_a8f72b6ceb3b6f5a67f9efd46cb90707a.html#a8f72b6ceb3b6f5a67f9efd46cb90707a">MED_NO_DT</a>,<a class="code" href="a00321_a95919207fd7a18ba26e6e03f04811e3f.html#a95919207fd7a18ba26e6e03f04811e3f">MED_NO_IT</a>,
                            <a class="code" href="a00321_aab0e957294723517d5c3641bb71b0470.html#aab0e957294723517d5c3641bb71b0470a227d14957ec5f221685cb1d6ec3b6c67">MED_CELL</a>,<a class="code" href="a00321_ae08587b134662b257542c6b64e6a998a.html#ae08587b134662b257542c6b64e6a998a">MED_POLYHEDRON</a>,n,num) &lt; 0) {
    <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;Erreur a l&apos;ecriture des numeros des polyedres&quot;</span>);
    <span class="keywordflow">return</span> -1;
  }
  printf(<span class="stringliteral">&quot;Ecriture des numeros des polyedres \n&quot;</span>);

  <span class="comment">/* ecriture des numeros des familles des polyedres */</span>
  <span class="keywordflow">if</span> (<a class="code" href="a01011_gab5dbe1721785e8565d5897349b526c43.html#gab5dbe1721785e8565d5897349b526c43" title="Cette routine permet l&amp;#39;écriture des numéros de famille d&amp;#39;un type d&amp;#39;entité...">MEDmeshEntityFamilyNumberWr</a>(fid,maa,<a class="code" href="a00321_a8f72b6ceb3b6f5a67f9efd46cb90707a.html#a8f72b6ceb3b6f5a67f9efd46cb90707a">MED_NO_DT</a>,<a class="code" href="a00321_a95919207fd7a18ba26e6e03f04811e3f.html#a95919207fd7a18ba26e6e03f04811e3f">MED_NO_IT</a>,
                                  <a class="code" href="a00321_aab0e957294723517d5c3641bb71b0470.html#aab0e957294723517d5c3641bb71b0470a227d14957ec5f221685cb1d6ec3b6c67">MED_CELL</a>,<a class="code" href="a00321_ae08587b134662b257542c6b64e6a998a.html#ae08587b134662b257542c6b64e6a998a">MED_POLYHEDRON</a>,n,fam) &lt; 0) {
    <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;Erreur a l&apos;ecriture des numeros de familles des polyedres&quot;</span>);
    <span class="keywordflow">return</span> -1;
  }
  printf(<span class="stringliteral">&quot;Ecriture des numeros des familles des polyedres \n&quot;</span>);

  <span class="comment">/* Fermeture du fichier */</span>
  <span class="keywordflow">if</span> (<a class="code" href="a01005_ga12a0e901c376be997a41a073ce426283.html#ga12a0e901c376be997a41a073ce426283" title="Fermeture d&amp;#39;un fichier MED.">MEDfileClose</a>(fid) &lt; 0) {
    <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;Erreur a la fermeture du fichier&quot;</span>);
    <span class="keywordflow">return</span> -1;
  }
  printf(<span class="stringliteral">&quot;Fermeture du fichier test25.med \n&quot;</span>);

  <span class="keywordflow">return</span> 0; 
}
</pre></div> <p>La lecture de la connectivit&eacute; des poly&egrave;dres d'un maillage demande une approche sp&eacute;cifique. Il est d'abord n&eacute;cessaire d'appeler plusieurs fois la routine <a class="el" href="a01011_ga45758103360dacf7b8a6c53ebfa4d7e5.html#ga45758103360dacf7b8a6c53ebfa4d7e5">MEDmeshnEntity</a> / <a class="el" href="a01026_gad8041d49270c560eb727621625424759.html#gad8041d49270c560eb727621625424759">mmhnme</a> afin de r&eacute;cup&eacute;rer la taille des tableaux d'indexation. Enfin la routine <a class="el" href="a01011_ga3a19e5f300f10f5e9b52c9622d94c6f9.html#ga3a19e5f300f10f5e9b52c9622d94c6f9">MEDmeshPolyhedronRd</a> / <a class="el" href="a01026_ga387172c14a1b0c50c82cfb3abd2749a0.html#ga387172c14a1b0c50c82cfb3abd2749a0">mmhphr</a> va lire les tableaux d'indexation et de connectivit&eacute;, comme l'illustre le cas d'utilisation suivant. </p>
<div class="fragment"><pre class="fragment"><span class="comment">/*  This file is part of MED.</span>
<span class="comment"> *</span>
<span class="comment"> *  COPYRIGHT (C) 1999 - 2012  EDF R&amp;D, CEA/DEN</span>
<span class="comment"> *  MED is free software: you can redistribute it and/or modify</span>
<span class="comment"> *  it under the terms of the GNU Lesser General Public License as published by</span>
<span class="comment"> *  the Free Software Foundation, either version 3 of the License, or</span>
<span class="comment"> *  (at your option) any later version.</span>
<span class="comment"> *</span>
<span class="comment"> *  MED is distributed in the hope that it will be useful,</span>
<span class="comment"> *  but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="comment"> *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<span class="comment"> *  GNU Lesser General Public License for more details.</span>
<span class="comment"> *</span>
<span class="comment"> *  You should have received a copy of the GNU Lesser General Public License</span>
<span class="comment"> *  along with MED.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span>
<span class="comment"> */</span>


<span class="comment">/******************************************************************************</span>
<span class="comment"> * - Nom du fichier : test26.c</span>
<span class="comment"> *</span>
<span class="comment"> * - Description : lecture de mailles de type MED_POLYEDRE</span>
<span class="comment"> *                 dans le maillage MED du fichier test25.med</span>
<span class="comment"> *</span>
<span class="comment"> *****************************************************************************/</span>

<span class="preprocessor">#include &lt;med.h&gt;</span>
<span class="preprocessor">#define MESGERR 1</span>
<span class="preprocessor"></span><span class="preprocessor">#include &quot;med_utils.h&quot;</span>
<span class="preprocessor">#include &lt;string.h&gt;</span>

<span class="preprocessor">#ifdef DEF_LECT_ECR</span>
<span class="preprocessor"></span><span class="preprocessor">#define MODE_ACCES MED_ACC_RDWR</span>
<span class="preprocessor"></span><span class="preprocessor">#elif DEF_LECT_AJOUT</span>
<span class="preprocessor"></span><span class="preprocessor">#define MODE_ACCES MED_ACC_RDEXT</span>
<span class="preprocessor"></span><span class="preprocessor">#else</span>
<span class="preprocessor"></span><span class="preprocessor">#define MODE_ACCES MED_ACC_CREAT</span>
<span class="preprocessor"></span><span class="preprocessor">#endif</span>
<span class="preprocessor"></span>
<span class="preprocessor">#define MAXDIM 3</span>
<span class="preprocessor"></span>
<span class="keywordtype">int</span> <a class="code" href="a00750_a3c04138a5bfe5d72780bb7e82a18e627.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a> (<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> **argv)


{
  <a class="code" href="a00320_abd29d7c6abaef5da2a5ed1b73464f0ba.html#abd29d7c6abaef5da2a5ed1b73464f0ba">med_err</a> ret = 0;
  <a class="code" href="a00320_afa4ec8284026c8c5545e5333475fb65a.html#afa4ec8284026c8c5545e5333475fb65a">med_idt</a> fid;
  <span class="keywordtype">char</span> maa[<a class="code" href="a00321_a0ae989cbbfeecbb5296b3ceba8dab886.html#a0ae989cbbfeecbb5296b3ceba8dab886">MED_NAME_SIZE</a>+1];
  <a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> nmaa,i,j,mdim;
  <span class="keywordtype">char</span> desc[<a class="code" href="a00321_ab69710ecf9f5257080a943579852d0f0.html#ab69710ecf9f5257080a943579852d0f0">MED_COMMENT_SIZE</a>+1];
  <a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> taille,nindf,nindn,npoly;
  <a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> taille2,nindf2,nindn2;
  <a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> *conn, *conn2, *indexn, *indexn2, *num, *fam;
  <a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> *indexf, *indexf2;
  <span class="keywordtype">char</span> *nom;
  <span class="keywordtype">char</span> tmp[<a class="code" href="a00321_a213ecd1a546eb96092b980a870bc386b.html#a213ecd1a546eb96092b980a870bc386b">MED_SNAME_SIZE</a>+1];
  <span class="keywordtype">int</span> ind1, ind2,k,nfaces,nnoeuds,l;
  <span class="keywordtype">char</span> dtunit[<a class="code" href="a00321_a213ecd1a546eb96092b980a870bc386b.html#a213ecd1a546eb96092b980a870bc386b">MED_SNAME_SIZE</a>+1]=<span class="stringliteral">&quot;&quot;</span>;
  <span class="keywordtype">char</span> nomcoo[<a class="code" href="a00821_a674c1a85fb1c09ec56b0b8f6319e7b97.html#a674c1a85fb1c09ec56b0b8f6319e7b97">MAXDIM</a>*<a class="code" href="a00321_a213ecd1a546eb96092b980a870bc386b.html#a213ecd1a546eb96092b980a870bc386b">MED_SNAME_SIZE</a>+1];
  <span class="keywordtype">char</span> unicoo[<a class="code" href="a00821_a674c1a85fb1c09ec56b0b8f6319e7b97.html#a674c1a85fb1c09ec56b0b8f6319e7b97">MAXDIM</a>*<a class="code" href="a00321_a213ecd1a546eb96092b980a870bc386b.html#a213ecd1a546eb96092b980a870bc386b">MED_SNAME_SIZE</a>+1];
  <a class="code" href="a00321_a821a4dd94c5c6b095318432bdec8d8a1.html#a821a4dd94c5c6b095318432bdec8d8a1">med_mesh_type</a> type;
  <a class="code" href="a00321_a5b97067a30629cd60470d074691d6798.html#a5b97067a30629cd60470d074691d6798">med_sorting_type</a> sort;
  <a class="code" href="a00321_a57867e4bed1d104c865cfc9d23c9204d.html#a57867e4bed1d104c865cfc9d23c9204d">med_axis_type</a> rep;
  <a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> nstep=0,sdim=0;
  <a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> inoele=0,inuele=0,ifaele=0;
  <a class="code" href="a00321_a23f7fa6d76886ed3c91dc33b59190dee.html#a23f7fa6d76886ed3c91dc33b59190dee">med_bool</a> chgt=<a class="code" href="a00321_a23f7fa6d76886ed3c91dc33b59190dee.html#a23f7fa6d76886ed3c91dc33b59190deea30b70cc2a253ed4141db9a78ba696046">MED_FALSE</a>,trsf=<a class="code" href="a00321_a23f7fa6d76886ed3c91dc33b59190dee.html#a23f7fa6d76886ed3c91dc33b59190deea30b70cc2a253ed4141db9a78ba696046">MED_FALSE</a>;;

  <span class="comment">/* Ouverture du fichier test25.med en lecture seule */</span>
  fid = <a class="code" href="a01005_ga9376a1654b7bf099c3f8941074c5fdfb.html#ga9376a1654b7bf099c3f8941074c5fdfb" title="Ouverture d&amp;#39;un fichier MED.">MEDfileOpen</a>(<span class="stringliteral">&quot;test25.med&quot;</span>,<a class="code" href="a00321_adcd0322de9fec3b5e199ffeda3f44c85.html#adcd0322de9fec3b5e199ffeda3f44c85a616bf8345c622a34f0787f42eb400f25">MED_ACC_RDONLY</a>);
  <span class="keywordflow">if</span> (fid &lt; 0) {
    <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;Erreur a l&apos;ouverture du fichier test25.med&quot;</span>);
    <span class="keywordflow">return</span> -1;
  }
  printf(<span class="stringliteral">&quot;Ouverture du fichier test25.med \n&quot;</span>);

  <span class="comment">/* Lecture du nombre de maillages */</span>
  nmaa = <a class="code" href="a01011_ga28ebd8a34278e9f6c526bc0ebad83399.html#ga28ebd8a34278e9f6c526bc0ebad83399" title="Cette routine permet de lire le nombre de maillages dans un fichier.">MEDnMesh</a>(fid);
  <span class="keywordflow">if</span> (nmaa &lt; 0) {
    <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;Erreur a lecture du nombre de maillage&quot;</span>);
    <span class="keywordflow">return</span> -1;
  }
  printf(<span class="stringliteral">&quot;Nombre de maillages = &quot;</span>IFORMAT<span class="stringliteral">&quot;\n&quot;</span>,nmaa);

  <span class="keywordflow">for</span> (i=0;i&lt;nmaa;i++) {

    <span class="comment">/* Lecture des infos sur le maillage */</span>
    <span class="keywordflow">if</span> ( <a class="code" href="a01011_ga71e0d79fbb40abdc9c20bc5be01441ac.html#ga71e0d79fbb40abdc9c20bc5be01441ac" title="Cette routine permet de lire les informations relatives à un maillage dans un fichier...">MEDmeshInfo</a>( fid, i+1,  maa, &amp;sdim, &amp;mdim, &amp;type, desc, dtunit, &amp;sort,
                      &amp;nstep,  &amp;rep, nomcoo, unicoo) &lt; 0 ) {
      <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;Erreur a lecture des infos sur le maillage&quot;</span>);
      <span class="keywordflow">return</span> -1;
    } <span class="keywordflow">else</span> {
      printf(<span class="stringliteral">&quot;maillage &quot;</span>IFORMAT<span class="stringliteral">&quot; de nom [%s] et de dimension : &quot;</span>IFORMAT<span class="stringliteral">&quot; , et de type %d\n&quot;</span>,i+1,maa,mdim,type);
      printf(<span class="stringliteral">&quot;\t -Dimension de l&apos;espace : &quot;</span>IFORMAT<span class="stringliteral">&quot;\n&quot;</span>,sdim);
      printf(<span class="stringliteral">&quot;\t -Description du maillage : |%s|\n&quot;</span>,desc);
      printf(<span class="stringliteral">&quot;\t -Noms des axes : |%s|\n&quot;</span>,nomcoo);
      printf(<span class="stringliteral">&quot;\t -Unités des axes : |%s|\n&quot;</span>,unicoo);
      printf(<span class="stringliteral">&quot;\t -Type de repère : %d\n&quot;</span>,rep);
      printf(<span class="stringliteral">&quot;\t -Nombre d&apos;étapes de calcul : &quot;</span>IFORMAT<span class="stringliteral">&quot;\n&quot;</span>,nstep);
      printf(<span class="stringliteral">&quot;\t -Unité des dates : |%s|\n&quot;</span>,dtunit);
    }

    printf(<span class="stringliteral">&quot;maillage &quot;</span>IFORMAT<span class="stringliteral">&quot; de nom [%s] et de dimension : &quot;</span>IFORMAT<span class="stringliteral">&quot; \n&quot;</span>,i+1,maa,mdim);

    <span class="comment">/* Taille du tableau d&apos;index des faces constituant chacun des polyedres */</span>
    <span class="keywordflow">if</span> ((nindf = <a class="code" href="a01011_ga45758103360dacf7b8a6c53ebfa4d7e5.html#ga45758103360dacf7b8a6c53ebfa4d7e5" title="Cette routine permet de lire le nombre d&amp;#39;entités dans un maillage pour une séquence...">MEDmeshnEntity</a>(fid,maa,<a class="code" href="a00321_a8f72b6ceb3b6f5a67f9efd46cb90707a.html#a8f72b6ceb3b6f5a67f9efd46cb90707a">MED_NO_DT</a>,<a class="code" href="a00321_a95919207fd7a18ba26e6e03f04811e3f.html#a95919207fd7a18ba26e6e03f04811e3f">MED_NO_IT</a>,
                                <a class="code" href="a00321_aab0e957294723517d5c3641bb71b0470.html#aab0e957294723517d5c3641bb71b0470a227d14957ec5f221685cb1d6ec3b6c67">MED_CELL</a>,<a class="code" href="a00321_ae08587b134662b257542c6b64e6a998a.html#ae08587b134662b257542c6b64e6a998a">MED_POLYHEDRON</a>,<a class="code" href="a00321_a25ee4b3675737fc23511b28b3245c61b.html#a25ee4b3675737fc23511b28b3245c61ba41dcc4a6a135f286da422482e3fd2021">MED_INDEX_FACE</a>,<a class="code" href="a00321_afcd26ca66a179b9aa82f5c90602c4ed8.html#afcd26ca66a179b9aa82f5c90602c4ed8a4ae92e7de0898383577cbba640006baa">MED_NODAL</a>,
                                &amp;chgt,&amp;trsf)) &lt; 0) {
      <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;Erreur a lecture du nombre de maille MED_POLYEDRE en mode nodal&quot;</span>);
      <span class="keywordflow">return</span> -1;
    }
    npoly = nindf-1;
    printf(<span class="stringliteral">&quot;Nombre de mailles polyedres : &quot;</span>IFORMAT<span class="stringliteral">&quot; \n&quot;</span>,npoly);

    <span class="comment">/* Taille du tableau d&apos;index des noeuds constituant chacune des faces en mode nodal */</span>
    <span class="keywordflow">if</span> ((nindn = <a class="code" href="a01011_ga45758103360dacf7b8a6c53ebfa4d7e5.html#ga45758103360dacf7b8a6c53ebfa4d7e5" title="Cette routine permet de lire le nombre d&amp;#39;entités dans un maillage pour une séquence...">MEDmeshnEntity</a>(fid,maa,<a class="code" href="a00321_a8f72b6ceb3b6f5a67f9efd46cb90707a.html#a8f72b6ceb3b6f5a67f9efd46cb90707a">MED_NO_DT</a>,<a class="code" href="a00321_a95919207fd7a18ba26e6e03f04811e3f.html#a95919207fd7a18ba26e6e03f04811e3f">MED_NO_IT</a>,
                                <a class="code" href="a00321_aab0e957294723517d5c3641bb71b0470.html#aab0e957294723517d5c3641bb71b0470a227d14957ec5f221685cb1d6ec3b6c67">MED_CELL</a>,<a class="code" href="a00321_ae08587b134662b257542c6b64e6a998a.html#ae08587b134662b257542c6b64e6a998a">MED_POLYHEDRON</a>,<a class="code" href="a00321_a25ee4b3675737fc23511b28b3245c61b.html#a25ee4b3675737fc23511b28b3245c61baeeb4405ba174bcfebed019cf268ca8f2">MED_INDEX_NODE</a>,<a class="code" href="a00321_afcd26ca66a179b9aa82f5c90602c4ed8.html#afcd26ca66a179b9aa82f5c90602c4ed8a4ae92e7de0898383577cbba640006baa">MED_NODAL</a>,
                                &amp;chgt,&amp;trsf)) &lt; 0) {
      <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;Erreur a lecture des infos sur les polyedres&quot;</span>);
      <span class="keywordflow">return</span> -1;
    }
    printf(<span class="stringliteral">&quot;Taille a allouer pour le tableau des faces (d&apos;indexation des noeuds),(nodal) : &quot;</span>IFORMAT<span class="stringliteral">&quot; \n&quot;</span>,nindn);

    <span class="comment">/* Taille du tableau d&apos;index des type constituant chacune des faces en mode descendant */</span>
    <span class="keywordflow">if</span> ((nindn2 = <a class="code" href="a01011_ga45758103360dacf7b8a6c53ebfa4d7e5.html#ga45758103360dacf7b8a6c53ebfa4d7e5" title="Cette routine permet de lire le nombre d&amp;#39;entités dans un maillage pour une séquence...">MEDmeshnEntity</a>(fid,maa,<a class="code" href="a00321_a8f72b6ceb3b6f5a67f9efd46cb90707a.html#a8f72b6ceb3b6f5a67f9efd46cb90707a">MED_NO_DT</a>,<a class="code" href="a00321_a95919207fd7a18ba26e6e03f04811e3f.html#a95919207fd7a18ba26e6e03f04811e3f">MED_NO_IT</a>,
                                 <a class="code" href="a00321_aab0e957294723517d5c3641bb71b0470.html#aab0e957294723517d5c3641bb71b0470a227d14957ec5f221685cb1d6ec3b6c67">MED_CELL</a>,<a class="code" href="a00321_ae08587b134662b257542c6b64e6a998a.html#ae08587b134662b257542c6b64e6a998a">MED_POLYHEDRON</a>,<a class="code" href="a00321_a25ee4b3675737fc23511b28b3245c61b.html#a25ee4b3675737fc23511b28b3245c61baeeb4405ba174bcfebed019cf268ca8f2">MED_INDEX_NODE</a>,<a class="code" href="a00321_afcd26ca66a179b9aa82f5c90602c4ed8.html#afcd26ca66a179b9aa82f5c90602c4ed8a4eb55627c1d0cb8d008396813de45f2a">MED_DESCENDING</a>,
                                 &amp;chgt,&amp;trsf)) &lt; 0) {
      <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;Erreur a lecture des infos sur les polyedres&quot;</span>);
      <span class="keywordflow">return</span> -1;
    }
    printf(<span class="stringliteral">&quot;Taille a allouer pour le tableau des types de faces (descendant) : &quot;</span>IFORMAT<span class="stringliteral">&quot; \n&quot;</span>,nindn2);

    <span class="comment">/* Taille du tableau de connectivité en mode MED_NODAL */</span>
    <span class="keywordflow">if</span> ((taille = <a class="code" href="a01011_ga45758103360dacf7b8a6c53ebfa4d7e5.html#ga45758103360dacf7b8a6c53ebfa4d7e5" title="Cette routine permet de lire le nombre d&amp;#39;entités dans un maillage pour une séquence...">MEDmeshnEntity</a>(fid,maa,<a class="code" href="a00321_a8f72b6ceb3b6f5a67f9efd46cb90707a.html#a8f72b6ceb3b6f5a67f9efd46cb90707a">MED_NO_DT</a>,<a class="code" href="a00321_a95919207fd7a18ba26e6e03f04811e3f.html#a95919207fd7a18ba26e6e03f04811e3f">MED_NO_IT</a>,
                                 <a class="code" href="a00321_aab0e957294723517d5c3641bb71b0470.html#aab0e957294723517d5c3641bb71b0470a227d14957ec5f221685cb1d6ec3b6c67">MED_CELL</a>,<a class="code" href="a00321_ae08587b134662b257542c6b64e6a998a.html#ae08587b134662b257542c6b64e6a998a">MED_POLYHEDRON</a>,<a class="code" href="a00321_a25ee4b3675737fc23511b28b3245c61b.html#a25ee4b3675737fc23511b28b3245c61bac845229e0179819897411d7cb9186824">MED_CONNECTIVITY</a>,<a class="code" href="a00321_afcd26ca66a179b9aa82f5c90602c4ed8.html#afcd26ca66a179b9aa82f5c90602c4ed8a4ae92e7de0898383577cbba640006baa">MED_NODAL</a>,
                                 &amp;chgt,&amp;trsf)) &lt; 0) {
      <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;Erreur a la lecture des infos sur les polyedres&quot;</span>);
      <span class="keywordflow">return</span> -1;
    }
    printf(<span class="stringliteral">&quot;Taille a allouer pour le tableau des noeuds des polyedres (connectivite),(nodal) : &quot;</span>IFORMAT<span class="stringliteral">&quot; \n&quot;</span>,taille);

    <span class="comment">/* Taille du tableau de connectivité en mode MED_DESCENDING */</span>
    <span class="keywordflow">if</span> ((taille2 = <a class="code" href="a01011_ga45758103360dacf7b8a6c53ebfa4d7e5.html#ga45758103360dacf7b8a6c53ebfa4d7e5" title="Cette routine permet de lire le nombre d&amp;#39;entités dans un maillage pour une séquence...">MEDmeshnEntity</a>(fid,maa,<a class="code" href="a00321_a8f72b6ceb3b6f5a67f9efd46cb90707a.html#a8f72b6ceb3b6f5a67f9efd46cb90707a">MED_NO_DT</a>,<a class="code" href="a00321_a95919207fd7a18ba26e6e03f04811e3f.html#a95919207fd7a18ba26e6e03f04811e3f">MED_NO_IT</a>,
                                  <a class="code" href="a00321_aab0e957294723517d5c3641bb71b0470.html#aab0e957294723517d5c3641bb71b0470a227d14957ec5f221685cb1d6ec3b6c67">MED_CELL</a>,<a class="code" href="a00321_ae08587b134662b257542c6b64e6a998a.html#ae08587b134662b257542c6b64e6a998a">MED_POLYHEDRON</a>,<a class="code" href="a00321_a25ee4b3675737fc23511b28b3245c61b.html#a25ee4b3675737fc23511b28b3245c61bac845229e0179819897411d7cb9186824">MED_CONNECTIVITY</a>,<a class="code" href="a00321_afcd26ca66a179b9aa82f5c90602c4ed8.html#afcd26ca66a179b9aa82f5c90602c4ed8a4eb55627c1d0cb8d008396813de45f2a">MED_DESCENDING</a>,
                                  &amp;chgt,&amp;trsf)) &lt; 0) {
      <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;Erreur a la lecture des infos sur les polyedres&quot;</span>);
      <span class="keywordflow">return</span> -1;
    }
    printf(<span class="stringliteral">&quot;Taille a allouer pour le tableau des noeuds des polyedres (connectivite),(descendant) : &quot;</span>IFORMAT<span class="stringliteral">&quot; \n&quot;</span>,taille2);


    <span class="comment">/* Allocation memoire :</span>
<span class="comment">     *  - tableau indexf et indexf2 : nindf</span>
<span class="comment">     *  - tableau indexn et indexn2 : nindn et nindn2</span>
<span class="comment">     *  - tableau des connectivites : consize</span>
<span class="comment">     *  - tableaux numeros et numeros de familles : npoly</span>
<span class="comment">     *  - tableau des noms : MED_SNAME_SIZE*npoly + 1</span>
<span class="comment">     */</span>
    indexf   = (<a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> *) malloc(<span class="keyword">sizeof</span>(<a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a>)*nindf);
    indexf2  = (<a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> *) malloc(<span class="keyword">sizeof</span>(<a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a>)*nindf);
    indexn   = (<a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> *) malloc(<span class="keyword">sizeof</span>(<a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a>)*nindn);
    indexn2  = (<a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> *) malloc(<span class="keyword">sizeof</span>(<a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a>)*nindn2);
    conn    = (<a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> *) malloc(<span class="keyword">sizeof</span>(<a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a>)*taille);
    conn2   = (<a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> *) malloc(<span class="keyword">sizeof</span>(<a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a>)*taille2);
    num     = (<a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> *) malloc(<span class="keyword">sizeof</span>(<a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a>)*npoly);
    fam     = (<a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> *) calloc(<span class="keyword">sizeof</span>(<a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a>),npoly);
    nom     = (<span class="keywordtype">char</span> *)    malloc(<span class="keyword">sizeof</span>(<span class="keywordtype">char</span>)*<a class="code" href="a00321_a213ecd1a546eb96092b980a870bc386b.html#a213ecd1a546eb96092b980a870bc386b">MED_SNAME_SIZE</a>*npoly+1);

    <span class="comment">/* Lecture de la connectivite des mailles polyedres en mode nodal */</span>
    <span class="keywordflow">if</span> (<a class="code" href="a01011_ga3a19e5f300f10f5e9b52c9622d94c6f9.html#ga3a19e5f300f10f5e9b52c9622d94c6f9" title="Cette routine permet la lecture dans un maillage des connectivités de polyèdres...">MEDmeshPolyhedronRd</a>(fid,maa,<a class="code" href="a00321_a8f72b6ceb3b6f5a67f9efd46cb90707a.html#a8f72b6ceb3b6f5a67f9efd46cb90707a">MED_NO_DT</a>,<a class="code" href="a00321_a95919207fd7a18ba26e6e03f04811e3f.html#a95919207fd7a18ba26e6e03f04811e3f">MED_NO_IT</a>,<a class="code" href="a00321_aab0e957294723517d5c3641bb71b0470.html#aab0e957294723517d5c3641bb71b0470a227d14957ec5f221685cb1d6ec3b6c67">MED_CELL</a>,<a class="code" href="a00321_afcd26ca66a179b9aa82f5c90602c4ed8.html#afcd26ca66a179b9aa82f5c90602c4ed8a4ae92e7de0898383577cbba640006baa">MED_NODAL</a>,
                            indexf,indexn,conn) &lt; 0) {
      <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;Erreur a lecture de la connectivite nodale des polyedres&quot;</span>);
      <span class="keywordflow">return</span> -1;
    }

    printf(<span class="stringliteral">&quot;Lecture de la connectivite des mailles MED_POLYEDRE en mode nodal \n&quot;</span>);

    <span class="comment">/* Lecture de la connectivite des mailles polyedres en mode descendant */</span>
    <span class="keywordflow">if</span> (<a class="code" href="a01011_ga3a19e5f300f10f5e9b52c9622d94c6f9.html#ga3a19e5f300f10f5e9b52c9622d94c6f9" title="Cette routine permet la lecture dans un maillage des connectivités de polyèdres...">MEDmeshPolyhedronRd</a>(fid,maa,<a class="code" href="a00321_a8f72b6ceb3b6f5a67f9efd46cb90707a.html#a8f72b6ceb3b6f5a67f9efd46cb90707a">MED_NO_DT</a>,<a class="code" href="a00321_a95919207fd7a18ba26e6e03f04811e3f.html#a95919207fd7a18ba26e6e03f04811e3f">MED_NO_IT</a>,<a class="code" href="a00321_aab0e957294723517d5c3641bb71b0470.html#aab0e957294723517d5c3641bb71b0470a227d14957ec5f221685cb1d6ec3b6c67">MED_CELL</a>,<a class="code" href="a00321_afcd26ca66a179b9aa82f5c90602c4ed8.html#afcd26ca66a179b9aa82f5c90602c4ed8a4eb55627c1d0cb8d008396813de45f2a">MED_DESCENDING</a>,
                            indexf2,indexn2,conn2) &lt; 0) {
      <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;Erreur a lecture de la connectivite descendante des polyedres&quot;</span>);
      <span class="keywordflow">return</span> -1;
    }
    printf(<span class="stringliteral">&quot;Lecture de la connectivite des mailles MED_POLYEDRE en mode descendant \n&quot;</span>);

    <span class="comment">/* Lecture noms */</span>
    <span class="keywordflow">if</span> ( (inoele = <a class="code" href="a01011_ga45758103360dacf7b8a6c53ebfa4d7e5.html#ga45758103360dacf7b8a6c53ebfa4d7e5" title="Cette routine permet de lire le nombre d&amp;#39;entités dans un maillage pour une séquence...">MEDmeshnEntity</a>(fid,maa,<a class="code" href="a00321_a8f72b6ceb3b6f5a67f9efd46cb90707a.html#a8f72b6ceb3b6f5a67f9efd46cb90707a">MED_NO_DT</a>,<a class="code" href="a00321_a95919207fd7a18ba26e6e03f04811e3f.html#a95919207fd7a18ba26e6e03f04811e3f">MED_NO_IT</a>,
                                 <a class="code" href="a00321_aab0e957294723517d5c3641bb71b0470.html#aab0e957294723517d5c3641bb71b0470a227d14957ec5f221685cb1d6ec3b6c67">MED_CELL</a>,<a class="code" href="a00321_ae08587b134662b257542c6b64e6a998a.html#ae08587b134662b257542c6b64e6a998a">MED_POLYHEDRON</a>,<a class="code" href="a00321_a25ee4b3675737fc23511b28b3245c61b.html#a25ee4b3675737fc23511b28b3245c61bad088c8424e59b6952ce81f4462d1e884">MED_NAME</a>,<a class="code" href="a00321_afcd26ca66a179b9aa82f5c90602c4ed8.html#afcd26ca66a179b9aa82f5c90602c4ed8a4eb55627c1d0cb8d008396813de45f2a">MED_DESCENDING</a>,
                                 &amp;chgt,&amp;trsf)) &lt; 0) {
      <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;Erreur de detection de la présence de noms optionnels des polyedres&quot;</span>);
      <span class="keywordflow">return</span> -1;
    }
    <span class="keywordflow">if</span> ( inoele ) {
      <span class="keywordflow">if</span> (<a class="code" href="a01011_ga54413edd055b4c606938c15f06f7cd64.html#ga54413edd055b4c606938c15f06f7cd64" title="Cette routine permet de lire les noms d&amp;#39;un type d&amp;#39;entité d&amp;#39;un maillage...">MEDmeshEntityNameRd</a>(fid,maa,<a class="code" href="a00321_a8f72b6ceb3b6f5a67f9efd46cb90707a.html#a8f72b6ceb3b6f5a67f9efd46cb90707a">MED_NO_DT</a>,<a class="code" href="a00321_a95919207fd7a18ba26e6e03f04811e3f.html#a95919207fd7a18ba26e6e03f04811e3f">MED_NO_IT</a>,
                              <a class="code" href="a00321_aab0e957294723517d5c3641bb71b0470.html#aab0e957294723517d5c3641bb71b0470a227d14957ec5f221685cb1d6ec3b6c67">MED_CELL</a>,<a class="code" href="a00321_ae08587b134662b257542c6b64e6a998a.html#ae08587b134662b257542c6b64e6a998a">MED_POLYHEDRON</a>,nom) &lt; 0) {
        <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;Erreur à la lecture des noms optionnels des polyedres&quot;</span>);
      } <span class="keywordflow">else</span> {
        printf(<span class="stringliteral">&quot;Lecture des noms des mailles MED_POLYEDRE \n&quot;</span>);
      }
    }

    <span class="comment">/* Lecture des numeros */</span>
    <span class="keywordflow">if</span> ( (inuele = <a class="code" href="a01011_ga45758103360dacf7b8a6c53ebfa4d7e5.html#ga45758103360dacf7b8a6c53ebfa4d7e5" title="Cette routine permet de lire le nombre d&amp;#39;entités dans un maillage pour une séquence...">MEDmeshnEntity</a>(fid,maa,<a class="code" href="a00321_a8f72b6ceb3b6f5a67f9efd46cb90707a.html#a8f72b6ceb3b6f5a67f9efd46cb90707a">MED_NO_DT</a>,<a class="code" href="a00321_a95919207fd7a18ba26e6e03f04811e3f.html#a95919207fd7a18ba26e6e03f04811e3f">MED_NO_IT</a>,
                                  <a class="code" href="a00321_aab0e957294723517d5c3641bb71b0470.html#aab0e957294723517d5c3641bb71b0470a227d14957ec5f221685cb1d6ec3b6c67">MED_CELL</a>,<a class="code" href="a00321_ae08587b134662b257542c6b64e6a998a.html#ae08587b134662b257542c6b64e6a998a">MED_POLYHEDRON</a>,<a class="code" href="a00321_a25ee4b3675737fc23511b28b3245c61b.html#a25ee4b3675737fc23511b28b3245c61ba119d5a650cde559719bcbd91f1c69b67">MED_NUMBER</a>,<a class="code" href="a00321_afcd26ca66a179b9aa82f5c90602c4ed8.html#afcd26ca66a179b9aa82f5c90602c4ed8a4eb55627c1d0cb8d008396813de45f2a">MED_DESCENDING</a>,
                                  &amp;chgt,&amp;trsf)) &lt; 0) {
      <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;Erreur de detection de la présence de noms optionnels des polyedres&quot;</span>);
      <span class="keywordflow">return</span> -1;
    }
    <span class="keywordflow">if</span> ( inuele) {
      <span class="keywordflow">if</span> (<a class="code" href="a01011_ga8d9061e87a0f45ef3544647787ac253c.html#ga8d9061e87a0f45ef3544647787ac253c" title="Cette routine permet de lire les numéros d&amp;#39;un type d&amp;#39;entité d&amp;#39;un maillage...">MEDmeshEntityNumberRd</a>(fid,maa,<a class="code" href="a00321_a8f72b6ceb3b6f5a67f9efd46cb90707a.html#a8f72b6ceb3b6f5a67f9efd46cb90707a">MED_NO_DT</a>,<a class="code" href="a00321_a95919207fd7a18ba26e6e03f04811e3f.html#a95919207fd7a18ba26e6e03f04811e3f">MED_NO_IT</a>,
                                <a class="code" href="a00321_aab0e957294723517d5c3641bb71b0470.html#aab0e957294723517d5c3641bb71b0470a227d14957ec5f221685cb1d6ec3b6c67">MED_CELL</a>,<a class="code" href="a00321_ae08587b134662b257542c6b64e6a998a.html#ae08587b134662b257542c6b64e6a998a">MED_POLYHEDRON</a>,num) &lt; 0) {
        <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;Erreur à la lecture des numeros optionnels des polyedres&quot;</span>);
      } <span class="keywordflow">else</span> {
        printf(<span class="stringliteral">&quot;Lecture des numeros des mailles MED_POLYEDRE \n&quot;</span>);
      }
    }

    <span class="comment">/* Lecture des numeros de familles */</span>
    <span class="keywordflow">if</span> ( (ifaele = <a class="code" href="a01011_ga45758103360dacf7b8a6c53ebfa4d7e5.html#ga45758103360dacf7b8a6c53ebfa4d7e5" title="Cette routine permet de lire le nombre d&amp;#39;entités dans un maillage pour une séquence...">MEDmeshnEntity</a>(fid,maa,<a class="code" href="a00321_a8f72b6ceb3b6f5a67f9efd46cb90707a.html#a8f72b6ceb3b6f5a67f9efd46cb90707a">MED_NO_DT</a>,<a class="code" href="a00321_a95919207fd7a18ba26e6e03f04811e3f.html#a95919207fd7a18ba26e6e03f04811e3f">MED_NO_IT</a>,
                                  <a class="code" href="a00321_aab0e957294723517d5c3641bb71b0470.html#aab0e957294723517d5c3641bb71b0470a227d14957ec5f221685cb1d6ec3b6c67">MED_CELL</a>,<a class="code" href="a00321_ae08587b134662b257542c6b64e6a998a.html#ae08587b134662b257542c6b64e6a998a">MED_POLYHEDRON</a>,<a class="code" href="a00321_a25ee4b3675737fc23511b28b3245c61b.html#a25ee4b3675737fc23511b28b3245c61baf1c3a12ec0e54fa0b5a9fe5f7ea7ab9f">MED_FAMILY_NUMBER</a>,<a class="code" href="a00321_afcd26ca66a179b9aa82f5c90602c4ed8.html#afcd26ca66a179b9aa82f5c90602c4ed8a4eb55627c1d0cb8d008396813de45f2a">MED_DESCENDING</a>,
                                  &amp;chgt,&amp;trsf)) &lt; 0) {
      <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;Erreur de detection de la présence des numéros de familles des polyedres&quot;</span>);
      <span class="keywordflow">return</span> -1;
    }
    <span class="keywordflow">if</span> ( ifaele )
      <span class="keywordflow">if</span> (<a class="code" href="a01011_ga80350686841974f69c25ba9d7c1ed9d6.html#ga80350686841974f69c25ba9d7c1ed9d6" title="Cette routine permet la lecture des numéros de famille d&amp;#39;un type d&amp;#39;entité...">MEDmeshEntityFamilyNumberRd</a>(fid,maa,<a class="code" href="a00321_a8f72b6ceb3b6f5a67f9efd46cb90707a.html#a8f72b6ceb3b6f5a67f9efd46cb90707a">MED_NO_DT</a>,<a class="code" href="a00321_a95919207fd7a18ba26e6e03f04811e3f.html#a95919207fd7a18ba26e6e03f04811e3f">MED_NO_IT</a>,
                                      <a class="code" href="a00321_aab0e957294723517d5c3641bb71b0470.html#aab0e957294723517d5c3641bb71b0470a227d14957ec5f221685cb1d6ec3b6c67">MED_CELL</a>,<a class="code" href="a00321_ae08587b134662b257542c6b64e6a998a.html#ae08587b134662b257542c6b64e6a998a">MED_POLYHEDRON</a>,fam) &lt; 0) {
        <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;Erreur a lecture des numeros de famille des polyedres&quot;</span>);
        <span class="comment">/*TODO : Considérer famille 0 */</span>
        <span class="keywordflow">return</span> -1;
      }
    printf(<span class="stringliteral">&quot;Lecture des numeros de familles des mailles MED_POLYEDRE \n&quot;</span>);

    printf(<span class="stringliteral">&quot;Affichage des resultats \n&quot;</span>);
    <span class="keywordflow">for</span> (j=0;j&lt;npoly;j++) {

      printf(<span class="stringliteral">&quot;&gt;&gt; Maille MED_POLYEDRE &quot;</span>IFORMAT<span class="stringliteral">&quot; : \n&quot;</span>,j+1);
      printf(<span class="stringliteral">&quot;---- Connectivite nodale      ----- : \n&quot;</span>);
      nfaces  = *(indexf+j+1) - *(indexf+j);
      <a class="code" href="a00348_ae7ba0433e91c450cd44c3808c2acb497.html#ae7ba0433e91c450cd44c3808c2acb497">ISCRUTE_int</a>(nfaces);
      <span class="comment">/* ind1 = indice dans &quot;faces&quot; pour acceder aux numeros des faces */</span>
      ind1 = *(indexf+j) - 1;
      <span class="keywordflow">for</span> (k=0;k&lt;nfaces;k++) {
        <span class="comment">/* ind2 = indice dans &quot;conn&quot; pour acceder au premier noeud de la face */</span>
        ind2 = *(indexn+ind1+k) - 1;
        nnoeuds = *(indexn+ind1+k+1) - *(indexn+ind1+k);
        printf(<span class="stringliteral">&quot;   - Face %d : [ &quot;</span>, k+1);
        <span class="keywordflow">for</span> (l=0;l&lt;nnoeuds;l++)
          printf(<span class="stringliteral">&quot; &quot;</span>IFORMAT<span class="stringliteral">&quot; &quot;</span>,*(conn+ind2+l));
        printf(<span class="stringliteral">&quot; ] \n&quot;</span>);
      }
      printf(<span class="stringliteral">&quot;---- Connectivite descendante ----- : \n&quot;</span>);
      nfaces  = *(indexf2+j+1) - *(indexf2+j);
      <span class="comment">/* ind1 = indice dans &quot;conn2&quot; pour acceder aux numeros des faces */</span>
      ind1 = *(indexf2+j) - 1;
      <span class="keywordflow">for</span> (k=0;k&lt;nfaces;k++)
        printf(<span class="stringliteral">&quot;   - Face %d de numero : &quot;</span>IFORMAT<span class="stringliteral">&quot; et de type &quot;</span>IFORMAT<span class="stringliteral">&quot; \n&quot;</span>, k+1,*(conn2+ind1+k),*(indexn2+ind1+k));
      strncpy(tmp,nom+j*<a class="code" href="a00321_a213ecd1a546eb96092b980a870bc386b.html#a213ecd1a546eb96092b980a870bc386b">MED_SNAME_SIZE</a>,MED_SNAME_SIZE);
      tmp[<a class="code" href="a00321_a213ecd1a546eb96092b980a870bc386b.html#a213ecd1a546eb96092b980a870bc386b">MED_SNAME_SIZE</a>] = <span class="charliteral">&apos;\0&apos;</span>;
      <span class="keywordflow">if</span> (inoele) printf(<span class="stringliteral">&quot;---- Nom                      ----- : %s \n&quot;</span>,tmp);
      <span class="keywordflow">if</span> (inuele) printf(<span class="stringliteral">&quot;---- Numero                   ----- : &quot;</span>IFORMAT<span class="stringliteral">&quot; \n&quot;</span>,*(num+j));
      printf(<span class="stringliteral">&quot;---- Numero de famille        ----- : &quot;</span>IFORMAT<span class="stringliteral">&quot; \n&quot;</span>,*(fam+j));
    }


    <span class="comment">/* liberation de la memoire */</span>
    free(indexf);
    free(indexf2);
    free(indexn);
    free(indexn2);
    free(conn);
    free(conn2);
    free(num);
    free(fam);
    free(nom);
  }

  <span class="comment">/* Fermeture du fichier */</span>
  <span class="keywordflow">if</span> (<a class="code" href="a01005_ga12a0e901c376be997a41a073ce426283.html#ga12a0e901c376be997a41a073ce426283" title="Fermeture d&amp;#39;un fichier MED.">MEDfileClose</a>(fid) &lt; 0) {
    <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;Erreur a fermeture du fichier&quot;</span>);
    <span class="keywordflow">return</span> -1;
  }
    printf(<span class="stringliteral">&quot;Fermeture du fichier \n&quot;</span>);

    <span class="keywordflow">return</span> ret;
}
</pre></div> <h3><a class="anchor" id="2."></a>Cr&eacute;er et lire un maillage avec gestion des profils sur les entit&eacute;s</h3>
<p>Un profil sur les entit&eacute;s d'un maillage permet l'&eacute;criture ou la lecture sur un sous-ensemble de ces entit&eacute;s. Un profil est un objet stock&eacute; dans un fichier MED. Un profil est un tableau de num&eacute;ros d'entit&eacute;s (num&eacute;rotation MED relative &agrave; un type g&eacute;om&eacute;trique d'&eacute;l&eacute;ment commen&ccedil;ant &agrave; 1) associ&eacute;s aux valeurs &agrave; traiter. La d&eacute;finition d'un profil se fait selon les conventions suivantes : les num&eacute;ros d'entit&eacute; utilis&eacute;s pour d&eacute;finir un profil sont ceux de la num&eacute;rotation implicite (ordre d'apparition des entit&eacute;s par ordre croissant). Un profil est une liste compacte : on ne met que les num&eacute;ros repr&eacute;sentatifs. Exemple : sur un maillage de 30 noeuds, si on a un champ portant sur les noeuds de num&eacute;ros de r&eacute;f&eacute;rence 4, 5 et 12, le profil correspondant sera la liste (4,5,12). </p>
<p>La routine <a class="el" href="a01013_gaf7ec6ed01898dcfe98556f399ed044d1.html#gaf7ec6ed01898dcfe98556f399ed044d1">MEDprofileWr</a> / <a class="el" href="a01028_ga946e7c43a115f9a0357571ceaceda78a.html#ga946e7c43a115f9a0357571ceaceda78a">mpfprw</a> permet d'&eacute;crire un profil dans un fichier MED. Un profil est identifi&eacute; par son nom (cha&icirc;ne de taille <a class="el" href="a00321_a0ae989cbbfeecbb5296b3ceba8dab886.html#a0ae989cbbfeecbb5296b3ceba8dab886">MED_NAME_SIZE</a> caract&egrave;res).  </p>
<p>A la lecture, la routine <a class="el" href="a01013_ga984674c8806c7374a95cd451219f8e81.html#ga984674c8806c7374a95cd451219f8e81">MEDnProfile</a> / <a class="el" href="a01028_ga4bf5d21abc7cf050d0d1cba12ebb385f.html#ga4bf5d21abc7cf050d0d1cba12ebb385f">mpfnpf</a> va lire le nombre de profil dans un fichier. Il s'agit ensuite d'it&eacute;rer sur chaque profil afin de r&eacute;cup&eacute;rer pour chacun d'eux : le nom et la taille du tableau du profil avec la routine <a class="el" href="a01013_ga58f36a5e3b4fb4a2e510b421c6608102.html#ga58f36a5e3b4fb4a2e510b421c6608102">MEDprofileInfo</a> / <a class="el" href="a01028_gac4caf2428491261b2eee80bf56db70c7.html#gac4caf2428491261b2eee80bf56db70c7">mpfpfi</a>, le tableau des num&eacute;ros d'entit&eacute;s avec <a class="el" href="a01013_ga93bec578fad63ceaaae0d7ea511d7a3e.html#ga93bec578fad63ceaaae0d7ea511d7a3e">MEDprofileRd</a> / <a class="el" href="a01028_ga3c0b90345398a5d111b92e010144a87f.html#ga3c0b90345398a5d111b92e010144a87f">mpfprr</a>.  </p>
<p>Lorsqu'on conna&icirc;t le nom du profil, la routine permet <a class="el" href="a01013_ga2871de707744621f6a29a29633cc2e7b.html#ga2871de707744621f6a29a29633cc2e7b">MEDprofileSizeByName</a> / <a class="el" href="a01028_ga8337e08bd4acc8530a18b4de1407cff5.html#ga8337e08bd4acc8530a18b4de1407cff5">mpfpsn</a> de lire la taille du tableau. </p>
<p>Au niveau de l'API sur les maillages, l'utilisation des profils est possible en &eacute;criture ou en lecture des coordon&eacute;es des noeuds et de la connectivit&eacute; des &eacute;l&eacute;ments d'un maillage non structur&eacute; avec les routines : <a class="el" href="a01011_ga9dee3d76d357b2aa31e562406d151f70.html#ga9dee3d76d357b2aa31e562406d151f70">MEDmeshNodeCoordinateWithProfileWr</a> / <a class="el" href="a01026_gadb3dbf89cb22d5e80a4ded7d6a35adf8.html#gadb3dbf89cb22d5e80a4ded7d6a35adf8">mmhcow</a> pour l'&eacute;criture des coordonn&eacute;es, <a class="el" href="a01011_ga069faade0b33a1d245a20160e7f33ce5.html#ga069faade0b33a1d245a20160e7f33ce5">MEDmeshNodeCoordinateWithProfileRd</a> / <a class="el" href="a01026_ga31b179e69893200d6625b4c81729e0bc.html#ga31b179e69893200d6625b4c81729e0bc">mmhcor</a> pour la lecture des coordonn&eacute;es, <a class="el" href="a01011_gade9c04c83f2909bfa25094f94ec0f6d2.html#gade9c04c83f2909bfa25094f94ec0f6d2">MEDmeshElementConnectivityWithProfileWr</a> / <a class="el" href="a01026_gaf391b9b5a4c3565b63ffb5d7a1f36bb5.html#gaf391b9b5a4c3565b63ffb5d7a1f36bb5">mmhypw</a> pour l'&eacute;criture des connectivit&eacute;s, <a class="el" href="a01011_ga3ec94d39504eccf0aa92af6e8f406718.html#ga3ec94d39504eccf0aa92af6e8f406718">MEDmeshElementConnectivityWithProfileRd</a> / <a class="el" href="a01026_ga1442ae230e88dbd3a9a7b6b8c88d61e3.html#ga1442ae230e88dbd3a9a7b6b8c88d61e3">mmhypr</a> pour la lecture des connectivit&eacute;s. A noter &eacute;galement la routine <a class="el" href="a01011_ga2b875dddcf5922d6143c72cb1e0924cf.html#ga2b875dddcf5922d6143c72cb1e0924cf">MEDmeshnEntityWithProfile</a> / <a class="el" href="a01026_gad8572227573582320220320a354fb2cd.html#gad8572227573582320220320a354fb2cd">mmhnep</a> qui peut r&eacute;cup&eacute;rer le nombre d'entit&eacute; &agrave; lire selon un profil donn&eacute;.  </p>
<p><a class="anchor" id="a3f7b3a3c5ddcaba3fa1741a367503c8da285ff6474ec39fcb4c49b66a9376ec92"></a> Pour toutes ces routines, il est possible de sp&eacute;cifier le mode de stockage des tableaux de coordonn&eacute;es ou de connectivit&eacute; en m&eacute;moire. Deux modes sont possibles : le mode <a class="el" href="a00321_a3f7b3a3c5ddcaba3fa1741a367503c8d.html#a3f7b3a3c5ddcaba3fa1741a367503c8da56cfcdcbbab7ddfc577de288697cd291">MED_GLOBAL_PFLMODE</a> indique que le stockage utilis&eacute; contient en m&eacute;moire toutes les valeurs relatives &agrave; toutes les entit&eacute;s d'un m&ecirc;me type ; le mode <a class="el" href="a00321_a3f7b3a3c5ddcaba3fa1741a367503c8d.html#a3f7b3a3c5ddcaba3fa1741a367503c8da285ff6474ec39fcb4c49b66a9376ec92">MED_COMPACT_PFLMODE</a> indique que le stockage utilis&eacute; est compact et ne contient en m&eacute;moire que le sous-ensemble de valeurs relatives au profil. </p>
<h3><a class="anchor" id="3."></a>Cr&eacute;er et lire un maillage &eacute;volutif</h3>
<p>Dans MED, un maillage peut &eacute;voluer par &eacute;tape, chaque &eacute;tape &eacute;tant estampill&eacute;e par un couple &lt;pas de temps, num&eacute;ro d'ordre&gt; &agrave; l'instar des &eacute;tapes de calcul d'un champ de r&eacute;sultat.  </p>
<p>Une &eacute;volution peut porter un maillage d&eacute;formable &agrave; topologie constante (les coordonn&eacute;es des noeuds ou d'un sous-ensemble des noeuds sont modifi&eacute;es &agrave; chaque &eacute;tape), un maillage &agrave; d&eacute;formation solide (selon une matrice de transformation pour chaque &eacute;tape applicable aux coordonn&eacute;es des noeuds), un maillage red&eacute;finissable (les connectivit&eacute;s des mailles changent au cours des &eacute;tapes). </p>
<p>A la cr&eacute;ation d'une &eacute;tape de calcul, les informations de l'&eacute;tape pr&eacute;c&eacute;dente inchang&eacute;es sont automatiquement report&eacute;es : coordonn&eacute;es, connectivit&eacute;s, num&eacute;ros optionnels, noms optionnels, num&eacute;ros de famille. Il est donc possible de cr&eacute;er une &eacute;tape d'&eacute;volution sans avoir &agrave; y reporter toutes ces donn&eacute;es. L'utilisateur a la responsabilit&eacute; de maintenir la coh&eacute;rence des informations covariantes au cours des diff&eacute;rentes &eacute;tapes. </p>
<p>A noter qu'un champ de r&eacute;sultat repose d&eacute;sormais sur une &eacute;tape d'&eacute;volution existante d'un maillage (par d&eacute;faut l'&eacute;tape initiale &lt;MED_NO_DT, MED_NO_IT&gt;). Il est n&eacute;cessaire de stocker le maillage initial &lt;MED_NO_DT, MED_NO_IT&gt; avant toute &eacute;volution.  </p>
<p>Au cours des &eacute;volutions d'un maillage, les types g&eacute;om&eacute;triques d'&eacute;l&eacute;ments doivent rester identiques. Si de nouveaux types g&eacute;om&eacute;triques apparaissent, il faut cr&eacute;er un nouveau maillage. </p>
<p>Pour ce qui concerne l'&eacute;criture des maillages d&eacute;formables &agrave; topologie constante, il faut utiliser la routine <a class="el" href="a01011_ga9dee3d76d357b2aa31e562406d151f70.html#ga9dee3d76d357b2aa31e562406d151f70">MEDmeshNodeCoordinateWithProfileWr</a> / <a class="el" href="a01026_gadb3dbf89cb22d5e80a4ded7d6a35adf8.html#gadb3dbf89cb22d5e80a4ded7d6a35adf8">mmhcow</a> en passant en param&egrave;tre le pas de temps et ou le num&eacute;ro d'ordre correspondant &agrave; l'&eacute;tape, le profil s&eacute;lectionnant les noeuds dont les coordonn&eacute;es sont modifi&eacute;es, le tableau des nouvelles coordonn&eacute;es. </p>
<p>Le cas d'utilisation suivant apr&egrave;s cr&eacute;ation du maillage initial, cr&eacute;&eacute;e 2 &eacute;volutions successives de sous-ensembles des coordonn&eacute;es des noeuds du maillage.  </p>
<div class="fragment"><pre class="fragment"><span class="comment">/*  This file is part of MED.</span>
<span class="comment"> *</span>
<span class="comment"> *  COPYRIGHT (C) 1999 - 2012  EDF R&amp;D, CEA/DEN</span>
<span class="comment"> *  MED is free software: you can redistribute it and/or modify</span>
<span class="comment"> *  it under the terms of the GNU Lesser General Public License as published by</span>
<span class="comment"> *  the Free Software Foundation, either version 3 of the License, or</span>
<span class="comment"> *  (at your option) any later version.</span>
<span class="comment"> *</span>
<span class="comment"> *  MED is distributed in the hope that it will be useful,</span>
<span class="comment"> *  but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="comment"> *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<span class="comment"> *  GNU Lesser General Public License for more details.</span>
<span class="comment"> *</span>
<span class="comment"> *  You should have received a copy of the GNU Lesser General Public License</span>
<span class="comment"> *  along with MED.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span>
<span class="comment"> */</span>

<span class="comment">/*</span>
<span class="comment"> *  How to create an unstructured mesh </span>
<span class="comment"> *</span>
<span class="comment"> *  Use case 6 : a 2D unstructured mesh with the following features </span>
<span class="comment"> *  computin steps, profiles and nodes coordinates evolution.</span>
<span class="comment"> */</span>

<span class="preprocessor">#include &lt;med.h&gt;</span>
<span class="preprocessor">#define MESGERR 1</span>
<span class="preprocessor"></span><span class="preprocessor">#include &lt;med_utils.h&gt;</span>

<span class="preprocessor">#include &lt;string.h&gt;</span>

<span class="keywordtype">int</span> <a class="code" href="a00750_a3c04138a5bfe5d72780bb7e82a18e627.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a> (<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> **argv) {
  <a class="code" href="a00320_afa4ec8284026c8c5545e5333475fb65a.html#afa4ec8284026c8c5545e5333475fb65a">med_idt</a> fid;
  <span class="keyword">const</span> <span class="keywordtype">char</span> meshname[<a class="code" href="a00321_a0ae989cbbfeecbb5296b3ceba8dab886.html#a0ae989cbbfeecbb5296b3ceba8dab886">MED_NAME_SIZE</a>+1] = <span class="stringliteral">&quot;2D unstructured mesh&quot;</span>;
  <span class="keyword">const</span> <a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> spacedim = 2;
  <span class="keyword">const</span> <a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> meshdim = 2;
  <span class="keyword">const</span> <span class="keywordtype">char</span> axisname[2*<a class="code" href="a00321_a213ecd1a546eb96092b980a870bc386b.html#a213ecd1a546eb96092b980a870bc386b">MED_SNAME_SIZE</a>+1] = <span class="stringliteral">&quot;x               y               &quot;</span>;
  <span class="keyword">const</span> <span class="keywordtype">char</span> unitname[2*<a class="code" href="a00321_a213ecd1a546eb96092b980a870bc386b.html#a213ecd1a546eb96092b980a870bc386b">MED_SNAME_SIZE</a>+1] = <span class="stringliteral">&quot;cm              cm              &quot;</span>;
  <span class="keyword">const</span> <a class="code" href="a00320_ab1eab99ca56ac95ce5b1c0e4ae0f095a.html#ab1eab99ca56ac95ce5b1c0e4ae0f095a">med_float</a> initial_coordinates[30] = { 2.,1.,  7.,1.,  12.,1.,  17.,1.,  22.,1.,
                                              2.,6.,  7.,6.,  12.,6.,  17.,6.,  22.,6.,
                                              2.,11., 7.,11., 12.,11., 17.,11., 22.,11.};
  <span class="keyword">const</span> <a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> nnodes = 15;
  <span class="keyword">const</span> <a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> triaconnectivity[24] = { 1,7,6,   2,7,1,  3,7,2,   8,7,3,   
                                         13,7,8, 12,7,13, 11,7,12, 6,7,11 };
  <span class="keyword">const</span> <a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> ntria3 = 8;
  <span class="keyword">const</span> <a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> quadconnectivity[16] = {3,4,9,8,    4,5,10,9, 
                                        15,14,9,10, 13,8,9,14};
  <span class="keyword">const</span> <a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> nquad4 = 4;
  <span class="comment">/* new coordinates (step 1) for nodes 13, 14 and 15 */</span>
  <span class="keyword">const</span> <a class="code" href="a00320_ab1eab99ca56ac95ce5b1c0e4ae0f095a.html#ab1eab99ca56ac95ce5b1c0e4ae0f095a">med_float</a> new_coordinates_step1 [6] = { 12.,15., 17.,15., 22.,15.};
  <span class="keyword">const</span> <span class="keywordtype">char</span> profile1name[<a class="code" href="a00321_a0ae989cbbfeecbb5296b3ceba8dab886.html#a0ae989cbbfeecbb5296b3ceba8dab886">MED_NAME_SIZE</a>+1] = <span class="stringliteral">&quot;UPPER_QUAD4_PROFILE&quot;</span>;
  <span class="keyword">const</span> <a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> profile1[3] = {13, 14, 15}; 
  <span class="keyword">const</span> <a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> profile1size = 3;
  <span class="comment">/* new coordinates (step 2) for nodes 8, 9 and 10 */</span>
  <span class="keyword">const</span> <a class="code" href="a00320_ab1eab99ca56ac95ce5b1c0e4ae0f095a.html#ab1eab99ca56ac95ce5b1c0e4ae0f095a">med_float</a> new_coordinates_step2 [6] = { 12.,10., 17.,10., 22.,10.};
  <span class="keyword">const</span> <span class="keywordtype">char</span> profile2name[<a class="code" href="a00321_a0ae989cbbfeecbb5296b3ceba8dab886.html#a0ae989cbbfeecbb5296b3ceba8dab886">MED_NAME_SIZE</a>+1] = <span class="stringliteral">&quot;MIDDLE_QUAD4_PROFILE&quot;</span>;
  <span class="keyword">const</span> <a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> profile2[3] = {8, 9, 10}; 
  <span class="keyword">const</span> <a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> profile2size = 3;
  <span class="keywordtype">int</span> ret=-1;
  
  
  <span class="comment">/* open MED file */</span>
  fid = <a class="code" href="a01005_ga9376a1654b7bf099c3f8941074c5fdfb.html#ga9376a1654b7bf099c3f8941074c5fdfb" title="Ouverture d&amp;#39;un fichier MED.">MEDfileOpen</a>(<span class="stringliteral">&quot;UsesCase_MEDmesh_6.med&quot;</span>,<a class="code" href="a00321_adcd0322de9fec3b5e199ffeda3f44c85.html#adcd0322de9fec3b5e199ffeda3f44c85aa23dd1c18b596924d5f50c8402b84c8e">MED_ACC_CREAT</a>);
  <span class="keywordflow">if</span> (fid &lt; 0) {
    <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : file creation ...&quot;</span>);
    <span class="keywordflow">goto</span> ERROR;
  }

  <span class="comment">/* write a comment in the file */</span>
  <span class="keywordflow">if</span> (<a class="code" href="a01005_ga08d625f5403fefb9deb7d47f9a915c41.html#ga08d625f5403fefb9deb7d47f9a915c41" title="Ecriture d&amp;#39;un descripteur dans un fichier MED.">MEDfileCommentWr</a>(fid,<span class="stringliteral">&quot;A 2D unstructured mesh : 15 nodes, 12 cells&quot;</span>) &lt; 0) {
    <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : write file description ...&quot;</span>);
    <span class="keywordflow">goto</span> ERROR;
  }

  <span class="comment">/* create the profiles in the file */</span>
  <span class="keywordflow">if</span> (<a class="code" href="a01013_gaf7ec6ed01898dcfe98556f399ed044d1.html#gaf7ec6ed01898dcfe98556f399ed044d1" title="Cette routine permet d&amp;#39;écrire un profil dans un fichier MED.">MEDprofileWr</a>(fid, profile1name, profile1size, profile1 ) &lt; 0) {
    <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : create profile ...&quot;</span>);
    <span class="keywordflow">goto</span> ERROR; 
  }

  <span class="keywordflow">if</span> (<a class="code" href="a01013_gaf7ec6ed01898dcfe98556f399ed044d1.html#gaf7ec6ed01898dcfe98556f399ed044d1" title="Cette routine permet d&amp;#39;écrire un profil dans un fichier MED.">MEDprofileWr</a>(fid, profile2name, profile2size, profile2 ) &lt; 0) {
    <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : create profile ...&quot;</span>);
    <span class="keywordflow">goto</span> ERROR; 
  }
  
  <span class="comment">/* mesh creation : a 2D unstructured mesh */</span>
  <span class="keywordflow">if</span> (<a class="code" href="a01011_ga6007c3f1a62732e7a46c5eca232be78a.html#ga6007c3f1a62732e7a46c5eca232be78a" title="Cette routine permet de créer un maillage dans un fichier.">MEDmeshCr</a>(fid, meshname, spacedim, meshdim, <a class="code" href="a00321_a821a4dd94c5c6b095318432bdec8d8a1.html#a821a4dd94c5c6b095318432bdec8d8a1a3719e53a4838d222f0a58148292fda41">MED_UNSTRUCTURED_MESH</a>, 
                <span class="stringliteral">&quot;A 2D structured mesh&quot;</span>,<span class="stringliteral">&quot;&quot;</span>,<a class="code" href="a00321_a5b97067a30629cd60470d074691d6798.html#a5b97067a30629cd60470d074691d6798ae896b6adfbde9870b4e875e5167eddd0">MED_SORT_DTIT</a>,<a class="code" href="a00321_a57867e4bed1d104c865cfc9d23c9204d.html#a57867e4bed1d104c865cfc9d23c9204da682ef7f1042079519664eae87f90297e">MED_CARTESIAN</a>, axisname, unitname) &lt; 0) {
    <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : mesh creation ...&quot;</span>);
    <span class="keywordflow">goto</span> ERROR;
  }

  <span class="comment">/* initial nodes coordinates in a cartesian axis in full interlace mode </span>
<span class="comment">     (X1,Y1, X2,Y2, X3,Y3, ...) </span>
<span class="comment">  */</span>
  <span class="keywordflow">if</span> (<a class="code" href="a01011_ga9dee3d76d357b2aa31e562406d151f70.html#ga9dee3d76d357b2aa31e562406d151f70" title="Cette routine permet d&amp;#39;écrire dans un maillage le tableau des coordonnées des...">MEDmeshNodeCoordinateWithProfileWr</a>(fid, meshname, <a class="code" href="a00321_a8f72b6ceb3b6f5a67f9efd46cb90707a.html#a8f72b6ceb3b6f5a67f9efd46cb90707a">MED_NO_DT</a>, <a class="code" href="a00321_a95919207fd7a18ba26e6e03f04811e3f.html#a95919207fd7a18ba26e6e03f04811e3f">MED_NO_IT</a>, 0.0,
                                         <a class="code" href="a00321_a3f7b3a3c5ddcaba3fa1741a367503c8d.html#a3f7b3a3c5ddcaba3fa1741a367503c8da285ff6474ec39fcb4c49b66a9376ec92">MED_COMPACT_PFLMODE</a>, <a class="code" href="a00321_aaa89a5e5e6d32de69614b70cf74e29cc.html#aaa89a5e5e6d32de69614b70cf74e29cc">MED_NO_PROFILE</a>,
                                         <a class="code" href="a00320_a0ac861d71fe5e0be056a86f9212f1c6a.html#a0ac861d71fe5e0be056a86f9212f1c6aa9a1509b3f93e5915a24f555890c73ee1">MED_FULL_INTERLACE</a>, <a class="code" href="a00321_a65a18ab6db672a2d21312d1813a3bb19.html#a65a18ab6db672a2d21312d1813a3bb19">MED_ALL_CONSTITUENT</a>,
                                         nnodes, initial_coordinates) &lt; 0) {
    <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : nodes coordinates ...&quot;</span>);
    <span class="keywordflow">goto</span> ERROR;
  }

  <span class="comment">/* cells connectiviy is defined in nodal mode */</span>
  <span class="keywordflow">if</span> (<a class="code" href="a01011_gade9c04c83f2909bfa25094f94ec0f6d2.html#gade9c04c83f2909bfa25094f94ec0f6d2" title="Cette routine permet d&amp;#39;écrire dans un maillage le tableau des connectivités...">MEDmeshElementConnectivityWithProfileWr</a>(fid, meshname, <a class="code" href="a00321_a8f72b6ceb3b6f5a67f9efd46cb90707a.html#a8f72b6ceb3b6f5a67f9efd46cb90707a">MED_NO_DT</a>, <a class="code" href="a00321_a95919207fd7a18ba26e6e03f04811e3f.html#a95919207fd7a18ba26e6e03f04811e3f">MED_NO_IT</a>, 0.0,
                                              <a class="code" href="a00321_aab0e957294723517d5c3641bb71b0470.html#aab0e957294723517d5c3641bb71b0470a227d14957ec5f221685cb1d6ec3b6c67">MED_CELL</a>, <a class="code" href="a00321_a4a1eb7ba296742a6f5eb8b5b23b39670.html#a4a1eb7ba296742a6f5eb8b5b23b39670">MED_TRIA3</a>, <a class="code" href="a00321_afcd26ca66a179b9aa82f5c90602c4ed8.html#afcd26ca66a179b9aa82f5c90602c4ed8a4ae92e7de0898383577cbba640006baa">MED_NODAL</a>, 
                                              <a class="code" href="a00321_a3f7b3a3c5ddcaba3fa1741a367503c8d.html#a3f7b3a3c5ddcaba3fa1741a367503c8da285ff6474ec39fcb4c49b66a9376ec92">MED_COMPACT_PFLMODE</a>, <a class="code" href="a00321_aaa89a5e5e6d32de69614b70cf74e29cc.html#aaa89a5e5e6d32de69614b70cf74e29cc">MED_NO_PROFILE</a>,
                                              <a class="code" href="a00320_a0ac861d71fe5e0be056a86f9212f1c6a.html#a0ac861d71fe5e0be056a86f9212f1c6aa9a1509b3f93e5915a24f555890c73ee1">MED_FULL_INTERLACE</a>, <a class="code" href="a00321_a65a18ab6db672a2d21312d1813a3bb19.html#a65a18ab6db672a2d21312d1813a3bb19">MED_ALL_CONSTITUENT</a>, 
                                              ntria3, triaconnectivity) &lt; 0) {
    <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : triangular cells connectivity ...&quot;</span>);
    <span class="keywordflow">goto</span> ERROR;
  }

  <span class="keywordflow">if</span> (<a class="code" href="a01011_gade9c04c83f2909bfa25094f94ec0f6d2.html#gade9c04c83f2909bfa25094f94ec0f6d2" title="Cette routine permet d&amp;#39;écrire dans un maillage le tableau des connectivités...">MEDmeshElementConnectivityWithProfileWr</a>(fid, meshname, <a class="code" href="a00321_a8f72b6ceb3b6f5a67f9efd46cb90707a.html#a8f72b6ceb3b6f5a67f9efd46cb90707a">MED_NO_DT</a>, <a class="code" href="a00321_a95919207fd7a18ba26e6e03f04811e3f.html#a95919207fd7a18ba26e6e03f04811e3f">MED_NO_IT</a>, 0.0,
                                              <a class="code" href="a00321_aab0e957294723517d5c3641bb71b0470.html#aab0e957294723517d5c3641bb71b0470a227d14957ec5f221685cb1d6ec3b6c67">MED_CELL</a>, <a class="code" href="a00321_a24ea9c52f5bde41d9a072925249ec06c.html#a24ea9c52f5bde41d9a072925249ec06c">MED_QUAD4</a>, <a class="code" href="a00321_afcd26ca66a179b9aa82f5c90602c4ed8.html#afcd26ca66a179b9aa82f5c90602c4ed8a4ae92e7de0898383577cbba640006baa">MED_NODAL</a>, 
                                              <a class="code" href="a00321_a3f7b3a3c5ddcaba3fa1741a367503c8d.html#a3f7b3a3c5ddcaba3fa1741a367503c8da285ff6474ec39fcb4c49b66a9376ec92">MED_COMPACT_PFLMODE</a>, <a class="code" href="a00321_aaa89a5e5e6d32de69614b70cf74e29cc.html#aaa89a5e5e6d32de69614b70cf74e29cc">MED_NO_PROFILE</a>,
                                              <a class="code" href="a00320_a0ac861d71fe5e0be056a86f9212f1c6a.html#a0ac861d71fe5e0be056a86f9212f1c6aa9a1509b3f93e5915a24f555890c73ee1">MED_FULL_INTERLACE</a>, <a class="code" href="a00321_a65a18ab6db672a2d21312d1813a3bb19.html#a65a18ab6db672a2d21312d1813a3bb19">MED_ALL_CONSTITUENT</a>,  
                                              nquad4, quadconnectivity) &lt; 0) {
    <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : quadrangular cells connectivity ...&quot;</span>); 
    <span class="keywordflow">goto</span> ERROR;
  }

  <span class="comment">/* </span>
<span class="comment">   * Mesh deformation (nodes coordinates) in 2 steps </span>
<span class="comment">   * The nodes modified are identified by a profile </span>
<span class="comment">   */</span> 
  <span class="comment">/* STEP 1 : dt1 = 5.5, it = 1*/</span>
  <span class="keywordflow">if</span> (<a class="code" href="a01011_ga9dee3d76d357b2aa31e562406d151f70.html#ga9dee3d76d357b2aa31e562406d151f70" title="Cette routine permet d&amp;#39;écrire dans un maillage le tableau des coordonnées des...">MEDmeshNodeCoordinateWithProfileWr</a>(fid, meshname, 1, 1, 5.5,
                                         <a class="code" href="a00321_a3f7b3a3c5ddcaba3fa1741a367503c8d.html#a3f7b3a3c5ddcaba3fa1741a367503c8da285ff6474ec39fcb4c49b66a9376ec92">MED_COMPACT_PFLMODE</a>, profile1name,
                                         <a class="code" href="a00320_a0ac861d71fe5e0be056a86f9212f1c6a.html#a0ac861d71fe5e0be056a86f9212f1c6aa9a1509b3f93e5915a24f555890c73ee1">MED_FULL_INTERLACE</a>, <a class="code" href="a00321_a65a18ab6db672a2d21312d1813a3bb19.html#a65a18ab6db672a2d21312d1813a3bb19">MED_ALL_CONSTITUENT</a>,
                                         nnodes, new_coordinates_step1 ) &lt; 0) {
    <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : nodes coordinates ...&quot;</span>);
    <span class="keywordflow">goto</span> ERROR;
  }
  <span class="comment">/* STEP 2 : dt2 = 8.9, it = 1*/</span>
  <span class="keywordflow">if</span> (<a class="code" href="a01011_ga9dee3d76d357b2aa31e562406d151f70.html#ga9dee3d76d357b2aa31e562406d151f70" title="Cette routine permet d&amp;#39;écrire dans un maillage le tableau des coordonnées des...">MEDmeshNodeCoordinateWithProfileWr</a>(fid, meshname, 2, 1, 8.9,
                                         <a class="code" href="a00321_a3f7b3a3c5ddcaba3fa1741a367503c8d.html#a3f7b3a3c5ddcaba3fa1741a367503c8da285ff6474ec39fcb4c49b66a9376ec92">MED_COMPACT_PFLMODE</a>, profile2name,
                                         <a class="code" href="a00320_a0ac861d71fe5e0be056a86f9212f1c6a.html#a0ac861d71fe5e0be056a86f9212f1c6aa9a1509b3f93e5915a24f555890c73ee1">MED_FULL_INTERLACE</a>, <a class="code" href="a00321_a65a18ab6db672a2d21312d1813a3bb19.html#a65a18ab6db672a2d21312d1813a3bb19">MED_ALL_CONSTITUENT</a>,
                                         nnodes, new_coordinates_step2 ) &lt; 0) {
    <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : nodes coordinates ...&quot;</span>);
    <span class="keywordflow">goto</span> ERROR;
  }

  <span class="comment">/* create family 0 : by default, all mesh entities family number is 0 */</span>
  <span class="keywordflow">if</span> (<a class="code" href="a01003_ga0873b54d0dc1472eee12c42aaf4fbca3.html#ga0873b54d0dc1472eee12c42aaf4fbca3" title="Cette routine permet la création d&amp;#39;une famille portant sur les entités d&amp;#39;un...">MEDfamilyCr</a>(fid, meshname,<a class="code" href="a00321_afd1f2684a3484575283e2a46f2d809da.html#afd1f2684a3484575283e2a46f2d809da">MED_NO_NAME</a>, 0, 0, <a class="code" href="a00321_a41b68e0bf49e21cf091f12ee6d9ab66c.html#a41b68e0bf49e21cf091f12ee6d9ab66c">MED_NO_GROUP</a>) &lt; 0) {
    <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : quadrangular cells connectivity ...&quot;</span>);
    <span class="keywordflow">goto</span> ERROR;
  }
  
  ret=0;
 ERROR:
  
  <span class="comment">/* close MED file */</span>
  <span class="keywordflow">if</span> (<a class="code" href="a01005_ga12a0e901c376be997a41a073ce426283.html#ga12a0e901c376be997a41a073ce426283" title="Fermeture d&amp;#39;un fichier MED.">MEDfileClose</a>(fid)  &lt; 0) {
    <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : close file ...&quot;</span>);
    ret=-1;
  }

  <span class="keywordflow">return</span> ret;
}
</pre></div> <p>A la lecture des maillages d&eacute;formables &agrave; topologie constante, une fois la lecture du maillage initiale effectu&eacute;e, il faut it&eacute;rer sur les diff&eacute;rentes &eacute;tapes d'&eacute;volution pr&eacute;sentes dans le maillage (le nombre d'&eacute;tape est lue par les routines <a class="el" href="a01011_gaf5e84a05155579ded1ba18a672385f97.html#gaf5e84a05155579ded1ba18a672385f97">MEDmeshInfoByName</a> / <a class="el" href="a01026_ga5b94892a2077826f2e2712c4ec3ae369.html#ga5b94892a2077826f2e2712c4ec3ae369">mmhmin</a> ou <a class="el" href="a01011_ga71e0d79fbb40abdc9c20bc5be01441ac.html#ga71e0d79fbb40abdc9c20bc5be01441ac">MEDmeshInfo</a> / <a class="el" href="a01026_gaf119a6264944d32e884b6d148bf17bcf.html#gaf119a6264944d32e884b6d148bf17bcf">mmhmii</a>) et &agrave; chaque &eacute;tape : r&eacute;cup&eacute;rer les valeurs du pas de temps et du num&eacute;ro d'it&eacute;ration avec la routine <a class="el" href="a01011_ga3faa1e7f284f59b74778ad5db9c00c95.html#ga3faa1e7f284f59b74778ad5db9c00c95">MEDmeshComputationStepInfo</a> / <a class="el" href="a01026_gaaf283cac4dc51471665ee1b713f5c961.html#gaaf283cac4dc51471665ee1b713f5c961">mmhcsi</a> ; d&eacute;terminer la nature du changement parmi les cas possibles pr&eacute;-cit&eacute;s avec la routine <a class="el" href="a01011_ga2b875dddcf5922d6143c72cb1e0924cf.html#ga2b875dddcf5922d6143c72cb1e0924cf">MEDmeshnEntityWithProfile</a> / <a class="el" href="a01026_gad8572227573582320220320a354fb2cd.html#gad8572227573582320220320a354fb2cd">mmhnep</a> et &eacute;galement r&eacute;cup&eacute;rer le nombre de noeuds &agrave; lire selon le mode de stockage m&eacute;moire pass&eacute; en param&egrave;tre ; lire les nouvelles coordonn&eacute;es des noeuds avec la routine <a class="el" href="a01011_ga069faade0b33a1d245a20160e7f33ce5.html#ga069faade0b33a1d245a20160e7f33ce5">MEDmeshNodeCoordinateWithProfileRd</a> / <a class="el" href="a01026_ga31b179e69893200d6625b4c81729e0bc.html#ga31b179e69893200d6625b4c81729e0bc">mmhcor</a>. </p>
<p>C'est ce que fait le cas d'utilisation suivant. </p>
<div class="fragment"><pre class="fragment"><span class="comment">/*  This file is part of MED.</span>
<span class="comment"> *</span>
<span class="comment"> *  COPYRIGHT (C) 1999 - 2012  EDF R&amp;D, CEA/DEN</span>
<span class="comment"> *  MED is free software: you can redistribute it and/or modify</span>
<span class="comment"> *  it under the terms of the GNU Lesser General Public License as published by</span>
<span class="comment"> *  the Free Software Foundation, either version 3 of the License, or</span>
<span class="comment"> *  (at your option) any later version.</span>
<span class="comment"> *</span>
<span class="comment"> *  MED is distributed in the hope that it will be useful,</span>
<span class="comment"> *  but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="comment"> *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<span class="comment"> *  GNU Lesser General Public License for more details.</span>
<span class="comment"> *</span>
<span class="comment"> *  You should have received a copy of the GNU Lesser General Public License</span>
<span class="comment"> *  along with MED.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span>
<span class="comment"> */</span>

<span class="comment">/*</span>
<span class="comment"> *  Use case 7 : read a 2D unstructured mesh with nodes coordinates modifications</span>
<span class="comment"> */</span>

<span class="preprocessor">#include &lt;med.h&gt;</span>
<span class="preprocessor">#define MESGERR 1</span>
<span class="preprocessor"></span><span class="preprocessor">#include &lt;med_utils.h&gt;</span>

<span class="preprocessor">#include &lt;string.h&gt;</span>

<span class="keywordtype">int</span> <a class="code" href="a00750_a3c04138a5bfe5d72780bb7e82a18e627.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a> (<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> **argv) {
  <a class="code" href="a00320_afa4ec8284026c8c5545e5333475fb65a.html#afa4ec8284026c8c5545e5333475fb65a">med_idt</a> fid;
  <span class="keyword">const</span> <span class="keywordtype">char</span> meshname[<a class="code" href="a00321_a0ae989cbbfeecbb5296b3ceba8dab886.html#a0ae989cbbfeecbb5296b3ceba8dab886">MED_NAME_SIZE</a>+1] = <span class="stringliteral">&quot;2D unstructured mesh&quot;</span>;
  <span class="keywordtype">char</span> meshdescription[<a class="code" href="a00321_ab69710ecf9f5257080a943579852d0f0.html#ab69710ecf9f5257080a943579852d0f0">MED_COMMENT_SIZE</a>+1]=<span class="stringliteral">&quot;&quot;</span>;
  <a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> meshdim;
  <a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> spacedim;
  <a class="code" href="a00321_a5b97067a30629cd60470d074691d6798.html#a5b97067a30629cd60470d074691d6798">med_sorting_type</a> sortingtype;
  <a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> nstep;
  <a class="code" href="a00321_a821a4dd94c5c6b095318432bdec8d8a1.html#a821a4dd94c5c6b095318432bdec8d8a1">med_mesh_type</a> meshtype;
  <a class="code" href="a00321_a57867e4bed1d104c865cfc9d23c9204d.html#a57867e4bed1d104c865cfc9d23c9204d">med_axis_type</a> axistype;
  <span class="keywordtype">char</span> axisname[2*<a class="code" href="a00321_a213ecd1a546eb96092b980a870bc386b.html#a213ecd1a546eb96092b980a870bc386b">MED_SNAME_SIZE</a>+1]=<span class="stringliteral">&quot;&quot;</span>;
  <span class="keywordtype">char</span> unitname[2*<a class="code" href="a00321_a213ecd1a546eb96092b980a870bc386b.html#a213ecd1a546eb96092b980a870bc386b">MED_SNAME_SIZE</a>+1]=<span class="stringliteral">&quot;&quot;</span>;
  <span class="keywordtype">char</span> dtunit[<a class="code" href="a00321_a213ecd1a546eb96092b980a870bc386b.html#a213ecd1a546eb96092b980a870bc386b">MED_SNAME_SIZE</a>+1]=<span class="stringliteral">&quot;&quot;</span>;
  <a class="code" href="a00320_ab1eab99ca56ac95ce5b1c0e4ae0f095a.html#ab1eab99ca56ac95ce5b1c0e4ae0f095a">med_float</a> *coordinates = NULL;
  <a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> nnodes = 0;
  <a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> *triaconnectivity = NULL;
  <a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> ntria3 = 0;
  <a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> *quadconnectivity = NULL;
  <a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> nquad4 = 0;
  <a class="code" href="a00321_a23f7fa6d76886ed3c91dc33b59190dee.html#a23f7fa6d76886ed3c91dc33b59190dee">med_bool</a> coordinatechangement;
  <a class="code" href="a00321_a23f7fa6d76886ed3c91dc33b59190dee.html#a23f7fa6d76886ed3c91dc33b59190dee">med_bool</a> geotransformation;
  <span class="keywordtype">int</span> i, it;
  <a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> profilesize;
  <span class="keywordtype">char</span> profilename[<a class="code" href="a00321_a0ae989cbbfeecbb5296b3ceba8dab886.html#a0ae989cbbfeecbb5296b3ceba8dab886">MED_NAME_SIZE</a>+1]=<span class="stringliteral">&quot;&quot;</span>;
  <a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> numdt, numit;
  <a class="code" href="a00320_ab1eab99ca56ac95ce5b1c0e4ae0f095a.html#ab1eab99ca56ac95ce5b1c0e4ae0f095a">med_float</a> dt;
  <span class="keywordtype">int</span> ret=-1;

  <span class="comment">/* open MED file with READ ONLY access mode */</span>
  fid = <a class="code" href="a01005_ga9376a1654b7bf099c3f8941074c5fdfb.html#ga9376a1654b7bf099c3f8941074c5fdfb" title="Ouverture d&amp;#39;un fichier MED.">MEDfileOpen</a>(<span class="stringliteral">&quot;UsesCase_MEDmesh_6.med&quot;</span>,<a class="code" href="a00321_adcd0322de9fec3b5e199ffeda3f44c85.html#adcd0322de9fec3b5e199ffeda3f44c85a616bf8345c622a34f0787f42eb400f25">MED_ACC_RDONLY</a>);
  <span class="keywordflow">if</span> (fid &lt; 0) {
    <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : open file in READ ONLY ACCESS mode ...&quot;</span>);
    <span class="keywordflow">goto</span> ERROR;
  }

  <span class="comment">/* </span>
<span class="comment">   * ... we know that the MED file has only one mesh, </span>
<span class="comment">   * a real code working would check ... </span>
<span class="comment">   */</span>

  <span class="comment">/* read mesh informations : mesh dimension, space dimension ... */</span>
  <span class="keywordflow">if</span> (<a class="code" href="a01011_gaf5e84a05155579ded1ba18a672385f97.html#gaf5e84a05155579ded1ba18a672385f97" title="Cette routine permet de lire les informations relatives à un maillage en précisant...">MEDmeshInfoByName</a>(fid, meshname, &amp;spacedim, &amp;meshdim, &amp;meshtype, meshdescription, 
                        dtunit, &amp;sortingtype, &amp;nstep, &amp;axistype, axisname, unitname) &lt; 0) {
    <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : mesh info ...&quot;</span>);
    <span class="keywordflow">goto</span> ERROR;
  }

  <span class="comment">/* read how many nodes in the mesh */</span>
  <span class="keywordflow">if</span> ((nnodes = <a class="code" href="a01011_ga45758103360dacf7b8a6c53ebfa4d7e5.html#ga45758103360dacf7b8a6c53ebfa4d7e5" title="Cette routine permet de lire le nombre d&amp;#39;entités dans un maillage pour une séquence...">MEDmeshnEntity</a>(fid, meshname, <a class="code" href="a00321_a8f72b6ceb3b6f5a67f9efd46cb90707a.html#a8f72b6ceb3b6f5a67f9efd46cb90707a">MED_NO_DT</a>, <a class="code" href="a00321_a95919207fd7a18ba26e6e03f04811e3f.html#a95919207fd7a18ba26e6e03f04811e3f">MED_NO_IT</a>, <a class="code" href="a00321_aab0e957294723517d5c3641bb71b0470.html#aab0e957294723517d5c3641bb71b0470a074507163b07b6d764823a78c5c07f0f">MED_NODE</a>,  <a class="code" href="a00321_a865361460bec98f2ec3f5bb3237b9264.html#a865361460bec98f2ec3f5bb3237b9264">MED_NO_GEOTYPE</a>,
                               <a class="code" href="a00321_a25ee4b3675737fc23511b28b3245c61b.html#a25ee4b3675737fc23511b28b3245c61bad78949eab3c743083dfbf687c92bbdcb">MED_COORDINATE</a>, <a class="code" href="a00321_afcd26ca66a179b9aa82f5c90602c4ed8.html#afcd26ca66a179b9aa82f5c90602c4ed8a2b1e772016688b78b808e96a44d1ee02">MED_NO_CMODE</a>,&amp;coordinatechangement,
                               &amp;geotransformation)) &lt; 0) {
    <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : number of nodes ...&quot;</span>);
    <span class="keywordflow">goto</span> ERROR;
  }
  
  <span class="comment">/* </span>
<span class="comment">   * ... we know that we only have MED_TRIA3 and MED_QUAD4 in the mesh, </span>
<span class="comment">   * a real code working would check all MED geometry cell types ... </span>
<span class="comment">   */</span>

  <span class="comment">/* read how many triangular cells in the mesh */</span>
  <span class="keywordflow">if</span> ((ntria3 = <a class="code" href="a01011_ga45758103360dacf7b8a6c53ebfa4d7e5.html#ga45758103360dacf7b8a6c53ebfa4d7e5" title="Cette routine permet de lire le nombre d&amp;#39;entités dans un maillage pour une séquence...">MEDmeshnEntity</a>(fid, meshname, <a class="code" href="a00321_a8f72b6ceb3b6f5a67f9efd46cb90707a.html#a8f72b6ceb3b6f5a67f9efd46cb90707a">MED_NO_DT</a>, <a class="code" href="a00321_a95919207fd7a18ba26e6e03f04811e3f.html#a95919207fd7a18ba26e6e03f04811e3f">MED_NO_IT</a>, <a class="code" href="a00321_aab0e957294723517d5c3641bb71b0470.html#aab0e957294723517d5c3641bb71b0470a227d14957ec5f221685cb1d6ec3b6c67">MED_CELL</a>,<a class="code" href="a00321_a4a1eb7ba296742a6f5eb8b5b23b39670.html#a4a1eb7ba296742a6f5eb8b5b23b39670">MED_TRIA3</a>,
                               <a class="code" href="a00321_a25ee4b3675737fc23511b28b3245c61b.html#a25ee4b3675737fc23511b28b3245c61bac845229e0179819897411d7cb9186824">MED_CONNECTIVITY</a>, <a class="code" href="a00321_afcd26ca66a179b9aa82f5c90602c4ed8.html#afcd26ca66a179b9aa82f5c90602c4ed8a4ae92e7de0898383577cbba640006baa">MED_NODAL</a>,&amp;coordinatechangement,
                               &amp;geotransformation)) &lt; 0) {
    <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : number of MED_TRIA3 ...&quot;</span>);
    <span class="keywordflow">goto</span> ERROR;
  }

  <span class="comment">/* read how many quadrangular cells in the mesh */</span>
  <span class="keywordflow">if</span> ((nquad4 = <a class="code" href="a01011_ga45758103360dacf7b8a6c53ebfa4d7e5.html#ga45758103360dacf7b8a6c53ebfa4d7e5" title="Cette routine permet de lire le nombre d&amp;#39;entités dans un maillage pour une séquence...">MEDmeshnEntity</a>(fid, meshname, <a class="code" href="a00321_a8f72b6ceb3b6f5a67f9efd46cb90707a.html#a8f72b6ceb3b6f5a67f9efd46cb90707a">MED_NO_DT</a>, <a class="code" href="a00321_a95919207fd7a18ba26e6e03f04811e3f.html#a95919207fd7a18ba26e6e03f04811e3f">MED_NO_IT</a>, <a class="code" href="a00321_aab0e957294723517d5c3641bb71b0470.html#aab0e957294723517d5c3641bb71b0470a227d14957ec5f221685cb1d6ec3b6c67">MED_CELL</a>,<a class="code" href="a00321_a24ea9c52f5bde41d9a072925249ec06c.html#a24ea9c52f5bde41d9a072925249ec06c">MED_QUAD4</a>,
                               <a class="code" href="a00321_a25ee4b3675737fc23511b28b3245c61b.html#a25ee4b3675737fc23511b28b3245c61bac845229e0179819897411d7cb9186824">MED_CONNECTIVITY</a>, <a class="code" href="a00321_afcd26ca66a179b9aa82f5c90602c4ed8.html#afcd26ca66a179b9aa82f5c90602c4ed8a4ae92e7de0898383577cbba640006baa">MED_NODAL</a>, &amp;coordinatechangement,
                               &amp;geotransformation)) &lt; 0) {
    <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : number of MED_QUAD4 ...&quot;</span>);
    <span class="keywordflow">goto</span> ERROR;
  }

  <span class="comment">/* read mesh nodes coordinates in the initial mesh */</span>
  <span class="keywordflow">if</span> ((coordinates = (<a class="code" href="a00320_ab1eab99ca56ac95ce5b1c0e4ae0f095a.html#ab1eab99ca56ac95ce5b1c0e4ae0f095a">med_float</a>*) malloc(<span class="keyword">sizeof</span>(<a class="code" href="a00320_ab1eab99ca56ac95ce5b1c0e4ae0f095a.html#ab1eab99ca56ac95ce5b1c0e4ae0f095a">med_float</a>)*nnodes*spacedim)) == NULL) {
    <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : memory allocation ...&quot;</span>);
    <span class="keywordflow">goto</span> ERROR;
  }

  <span class="keywordflow">if</span> (<a class="code" href="a01011_ga392a4bd4e6d340020755de7353f8a528.html#ga392a4bd4e6d340020755de7353f8a528" title="Cette routine permet de lire dans un maillage le tableau des coordonnées des noeuds...">MEDmeshNodeCoordinateRd</a>(fid, meshname, <a class="code" href="a00321_a8f72b6ceb3b6f5a67f9efd46cb90707a.html#a8f72b6ceb3b6f5a67f9efd46cb90707a">MED_NO_DT</a>, <a class="code" href="a00321_a95919207fd7a18ba26e6e03f04811e3f.html#a95919207fd7a18ba26e6e03f04811e3f">MED_NO_IT</a>, <a class="code" href="a00320_a0ac861d71fe5e0be056a86f9212f1c6a.html#a0ac861d71fe5e0be056a86f9212f1c6aa9a1509b3f93e5915a24f555890c73ee1">MED_FULL_INTERLACE</a>,
                              coordinates) &lt; 0) {
    <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : nodes coordinates ...&quot;</span>);
    free(coordinates);
    <span class="keywordflow">goto</span> ERROR;
  }

  <span class="comment">/* read cells connectivity in the initial mesh */</span>
  <span class="keywordflow">if</span> ((triaconnectivity = (<a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> *) malloc(<span class="keyword">sizeof</span>(<a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a>)*ntria3*3)) == NULL) {
    <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : memory allocation ...&quot;</span>);
    <span class="keywordflow">goto</span> ERROR;
  }
  <span class="keywordflow">if</span> (<a class="code" href="a01011_ga014f716ad13c72466b4aa94237876bf5.html#ga014f716ad13c72466b4aa94237876bf5" title="Cette routine permet de lire dans un maillage le tableau des connectivités pour...">MEDmeshElementConnectivityRd</a>(fid, meshname, <a class="code" href="a00321_a8f72b6ceb3b6f5a67f9efd46cb90707a.html#a8f72b6ceb3b6f5a67f9efd46cb90707a">MED_NO_DT</a>, <a class="code" href="a00321_a95919207fd7a18ba26e6e03f04811e3f.html#a95919207fd7a18ba26e6e03f04811e3f">MED_NO_IT</a>, <a class="code" href="a00321_aab0e957294723517d5c3641bb71b0470.html#aab0e957294723517d5c3641bb71b0470a227d14957ec5f221685cb1d6ec3b6c67">MED_CELL</a>,
                                   <a class="code" href="a00321_a4a1eb7ba296742a6f5eb8b5b23b39670.html#a4a1eb7ba296742a6f5eb8b5b23b39670">MED_TRIA3</a>, <a class="code" href="a00321_afcd26ca66a179b9aa82f5c90602c4ed8.html#afcd26ca66a179b9aa82f5c90602c4ed8a4ae92e7de0898383577cbba640006baa">MED_NODAL</a>, <a class="code" href="a00320_a0ac861d71fe5e0be056a86f9212f1c6a.html#a0ac861d71fe5e0be056a86f9212f1c6aa9a1509b3f93e5915a24f555890c73ee1">MED_FULL_INTERLACE</a>, triaconnectivity) &lt; 0) {
    <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : MED_TRIA3 connectivity ...&quot;</span>);
    free(triaconnectivity);
    <span class="keywordflow">goto</span> ERROR;
  }
  free(triaconnectivity);

  <span class="keywordflow">if</span> ((quadconnectivity = (<a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> *) malloc(<span class="keyword">sizeof</span>(<a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a>)*nquad4*4)) == NULL) {
    <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : memory allocation ...&quot;</span>);
    <span class="keywordflow">goto</span> ERROR;
  }
  <span class="keywordflow">if</span> (<a class="code" href="a01011_ga014f716ad13c72466b4aa94237876bf5.html#ga014f716ad13c72466b4aa94237876bf5" title="Cette routine permet de lire dans un maillage le tableau des connectivités pour...">MEDmeshElementConnectivityRd</a>(fid, meshname, <a class="code" href="a00321_a8f72b6ceb3b6f5a67f9efd46cb90707a.html#a8f72b6ceb3b6f5a67f9efd46cb90707a">MED_NO_DT</a>, <a class="code" href="a00321_a95919207fd7a18ba26e6e03f04811e3f.html#a95919207fd7a18ba26e6e03f04811e3f">MED_NO_IT</a>, <a class="code" href="a00321_aab0e957294723517d5c3641bb71b0470.html#aab0e957294723517d5c3641bb71b0470a227d14957ec5f221685cb1d6ec3b6c67">MED_CELL</a>,
                                   <a class="code" href="a00321_a24ea9c52f5bde41d9a072925249ec06c.html#a24ea9c52f5bde41d9a072925249ec06c">MED_QUAD4</a>, <a class="code" href="a00321_afcd26ca66a179b9aa82f5c90602c4ed8.html#afcd26ca66a179b9aa82f5c90602c4ed8a4ae92e7de0898383577cbba640006baa">MED_NODAL</a>, <a class="code" href="a00320_a0ac861d71fe5e0be056a86f9212f1c6a.html#a0ac861d71fe5e0be056a86f9212f1c6aa9a1509b3f93e5915a24f555890c73ee1">MED_FULL_INTERLACE</a>, quadconnectivity) &lt; 0) {
    <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : MED_TRIA3 connectivity ...&quot;</span>);
    free(quadconnectivity);
    <span class="keywordflow">goto</span> ERROR;
  }
  free(quadconnectivity);

  <span class="comment">/* </span>
<span class="comment">   * ... we know that the family number of nodes and elements is 0, a real working would check ...</span>
<span class="comment">   */</span>

  <span class="comment">/* read nodes coordinates changements step by step */</span>
  <span class="keywordflow">for</span> (it=1;it&lt;nstep;it++) {

    <span class="keywordflow">if</span> (<a class="code" href="a01011_ga3faa1e7f284f59b74778ad5db9c00c95.html#ga3faa1e7f284f59b74778ad5db9c00c95" title="Cette routine permet de lire les informations relatives à une séquence de calcul...">MEDmeshComputationStepInfo</a>(fid, meshname, it+1, 
                                   &amp;numdt, &amp;numit, &amp;dt) &lt; 0) {
      <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : Computing step info ...&quot;</span>);
      <a class="code" href="a00348_a257959db0a78623caa051d11ceb2f8cb.html#a257959db0a78623caa051d11ceb2f8cb">SSCRUTE</a>(meshname);
      <span class="keywordflow">goto</span> ERROR;
    }
  
    <span class="comment">/* test changement : for nodes coordinates */</span>
    <span class="keywordflow">if</span> ((nnodes = <a class="code" href="a01011_ga2b875dddcf5922d6143c72cb1e0924cf.html#ga2b875dddcf5922d6143c72cb1e0924cf" title="Cette routine permet de lire le nombre d&amp;#39;entités dans un maillage pour une séquence...">MEDmeshnEntityWithProfile</a>(fid, meshname, numdt, numit, 
                                            <a class="code" href="a00321_aab0e957294723517d5c3641bb71b0470.html#aab0e957294723517d5c3641bb71b0470a074507163b07b6d764823a78c5c07f0f">MED_NODE</a>,  <a class="code" href="a00321_a865361460bec98f2ec3f5bb3237b9264.html#a865361460bec98f2ec3f5bb3237b9264">MED_NO_GEOTYPE</a>,
                                            <a class="code" href="a00321_a25ee4b3675737fc23511b28b3245c61b.html#a25ee4b3675737fc23511b28b3245c61bad78949eab3c743083dfbf687c92bbdcb">MED_COORDINATE</a>, <a class="code" href="a00321_afcd26ca66a179b9aa82f5c90602c4ed8.html#afcd26ca66a179b9aa82f5c90602c4ed8a2b1e772016688b78b808e96a44d1ee02">MED_NO_CMODE</a>,
                                            <a class="code" href="a00321_a3f7b3a3c5ddcaba3fa1741a367503c8d.html#a3f7b3a3c5ddcaba3fa1741a367503c8da56cfcdcbbab7ddfc577de288697cd291">MED_GLOBAL_PFLMODE</a>, profilename, &amp;profilesize,
                                            &amp;coordinatechangement, &amp;geotransformation)) &lt; 0) {
      <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : number of nodes ...&quot;</span>);
      <span class="keywordflow">goto</span> ERROR;
    }

    <span class="comment">/* if coordinates have changed, then read the new coordinates */</span>
    <span class="keywordflow">if</span> (coordinatechangement) {
      <span class="keywordflow">if</span> (<a class="code" href="a01011_ga069faade0b33a1d245a20160e7f33ce5.html#ga069faade0b33a1d245a20160e7f33ce5" title="Cette routine permet de lire dans un maillage le tableau des coordonnées des noeuds...">MEDmeshNodeCoordinateWithProfileRd</a>(fid, meshname, numdt, numit, 
                                             <a class="code" href="a00321_a3f7b3a3c5ddcaba3fa1741a367503c8d.html#a3f7b3a3c5ddcaba3fa1741a367503c8da56cfcdcbbab7ddfc577de288697cd291">MED_GLOBAL_PFLMODE</a>,profilename,
                                             <a class="code" href="a00320_a0ac861d71fe5e0be056a86f9212f1c6a.html#a0ac861d71fe5e0be056a86f9212f1c6aa9a1509b3f93e5915a24f555890c73ee1">MED_FULL_INTERLACE</a>,<a class="code" href="a00321_a65a18ab6db672a2d21312d1813a3bb19.html#a65a18ab6db672a2d21312d1813a3bb19">MED_ALL_CONSTITUENT</a>,
                                             coordinates) &lt; 0) {
        <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : nodes coordinates ...&quot;</span>);
        free(coordinates);
        <span class="keywordflow">goto</span> ERROR;
      }
    }
      
  }

  free(coordinates);
  
  ret=0;
 ERROR:

  <span class="comment">/* close MED file */</span>
  <span class="keywordflow">if</span> (<a class="code" href="a01005_ga12a0e901c376be997a41a073ce426283.html#ga12a0e901c376be997a41a073ce426283" title="Fermeture d&amp;#39;un fichier MED.">MEDfileClose</a>(fid) &lt; 0) {
    <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : close file&quot;</span>);             
    ret=-1; 
  } 


  <span class="keywordflow">return</span> ret;
}

</pre></div> <p>Le cas d'utilisation suivant propose une approche plus g&eacute;n&eacute;rique dans la lecture des maillages d&eacute;formables &agrave; topologie constante. </p>
<div class="fragment"><pre class="fragment"><span class="comment">/*  This file is part of MED.</span>
<span class="comment"> *</span>
<span class="comment"> *  COPYRIGHT (C) 1999 - 2012  EDF R&amp;D, CEA/DEN</span>
<span class="comment"> *  MED is free software: you can redistribute it and/or modify</span>
<span class="comment"> *  it under the terms of the GNU Lesser General Public License as published by</span>
<span class="comment"> *  the Free Software Foundation, either version 3 of the License, or</span>
<span class="comment"> *  (at your option) any later version.</span>
<span class="comment"> *</span>
<span class="comment"> *  MED is distributed in the hope that it will be useful,</span>
<span class="comment"> *  but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="comment"> *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<span class="comment"> *  GNU Lesser General Public License for more details.</span>
<span class="comment"> *</span>
<span class="comment"> *  You should have received a copy of the GNU Lesser General Public License</span>
<span class="comment"> *  along with MED.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span>
<span class="comment"> */</span>

<span class="comment">/*</span>
<span class="comment"> *  Use case 8 : read a 2D unstructured mesh with coordinates nodes </span>
<span class="comment"> *  modifications (generic approach)</span>
<span class="comment"> */</span>

<span class="preprocessor">#include &lt;med.h&gt;</span>
<span class="preprocessor">#define MESGERR 1</span>
<span class="preprocessor"></span><span class="preprocessor">#include &lt;med_utils.h&gt;</span>

<span class="preprocessor">#include &lt;string.h&gt;</span>

<span class="keywordtype">int</span> <a class="code" href="a00750_a3c04138a5bfe5d72780bb7e82a18e627.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a> (<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> **argv) {
  <a class="code" href="a00320_afa4ec8284026c8c5545e5333475fb65a.html#afa4ec8284026c8c5545e5333475fb65a">med_idt</a> fid;
  <a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> nmesh;
  <span class="keywordtype">char</span> meshname[<a class="code" href="a00321_a0ae989cbbfeecbb5296b3ceba8dab886.html#a0ae989cbbfeecbb5296b3ceba8dab886">MED_NAME_SIZE</a>+1]=<span class="stringliteral">&quot;&quot;</span>;
  <span class="keywordtype">char</span> meshdescription[<a class="code" href="a00321_ab69710ecf9f5257080a943579852d0f0.html#ab69710ecf9f5257080a943579852d0f0">MED_COMMENT_SIZE</a>+1]=<span class="stringliteral">&quot;&quot;</span>;
  <a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> meshdim;
  <a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> spacedim;
  <a class="code" href="a00321_a5b97067a30629cd60470d074691d6798.html#a5b97067a30629cd60470d074691d6798">med_sorting_type</a> sortingtype;
  <a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> nstep;
  <a class="code" href="a00321_a821a4dd94c5c6b095318432bdec8d8a1.html#a821a4dd94c5c6b095318432bdec8d8a1">med_mesh_type</a> meshtype;
  <a class="code" href="a00321_a57867e4bed1d104c865cfc9d23c9204d.html#a57867e4bed1d104c865cfc9d23c9204d">med_axis_type</a> axistype;
  <span class="keywordtype">char</span> *axisname;
  <span class="keywordtype">char</span> *unitname;
  <span class="keywordtype">char</span> dtunit[<a class="code" href="a00321_a213ecd1a546eb96092b980a870bc386b.html#a213ecd1a546eb96092b980a870bc386b">MED_SNAME_SIZE</a>+1]=<span class="stringliteral">&quot;&quot;</span>;
  <a class="code" href="a00320_ab1eab99ca56ac95ce5b1c0e4ae0f095a.html#ab1eab99ca56ac95ce5b1c0e4ae0f095a">med_float</a> *coordinates = NULL;
  <a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> ngeo = 0;
  <a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> nnodes = 0;
  <a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> *connectivity = NULL;
  <a class="code" href="a00321_a23f7fa6d76886ed3c91dc33b59190dee.html#a23f7fa6d76886ed3c91dc33b59190dee">med_bool</a> coordinatechangement;
  <a class="code" href="a00321_a23f7fa6d76886ed3c91dc33b59190dee.html#a23f7fa6d76886ed3c91dc33b59190dee">med_bool</a> geotransformation;
  <span class="keywordtype">int</span> i, it, j;
  <a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> profilesize;
  <span class="keywordtype">char</span> profilename[<a class="code" href="a00321_a0ae989cbbfeecbb5296b3ceba8dab886.html#a0ae989cbbfeecbb5296b3ceba8dab886">MED_NAME_SIZE</a>+1]=<span class="stringliteral">&quot;&quot;</span>;
  <a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> numdt, numit;
  <a class="code" href="a00320_ab1eab99ca56ac95ce5b1c0e4ae0f095a.html#ab1eab99ca56ac95ce5b1c0e4ae0f095a">med_float</a> dt;
  <a class="code" href="a00321_a1043613afc3cd2e24785dfc7c0452ab8.html#a1043613afc3cd2e24785dfc7c0452ab8">med_geometry_type</a> geotype;
  <a class="code" href="a00321_a1043613afc3cd2e24785dfc7c0452ab8.html#a1043613afc3cd2e24785dfc7c0452ab8">med_geometry_type</a> *geotypes = <a class="code" href="a00499_a54c2e34174a890046d0a204fa1a918a8.html#a54c2e34174a890046d0a204fa1a918a8">MED_GET_CELL_GEOMETRY_TYPE</a>;
  <span class="keywordtype">int</span> ret=-1;

  <span class="comment">/* open MED file with READ ONLY access mode */</span>
  fid = <a class="code" href="a01005_ga9376a1654b7bf099c3f8941074c5fdfb.html#ga9376a1654b7bf099c3f8941074c5fdfb" title="Ouverture d&amp;#39;un fichier MED.">MEDfileOpen</a>(<span class="stringliteral">&quot;UsesCase_MEDmesh_6.med&quot;</span>,<a class="code" href="a00321_adcd0322de9fec3b5e199ffeda3f44c85.html#adcd0322de9fec3b5e199ffeda3f44c85a616bf8345c622a34f0787f42eb400f25">MED_ACC_RDONLY</a>);
  <span class="keywordflow">if</span> (fid &lt; 0) {
    <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : open file in READ ONLY ACCESS mode ...&quot;</span>);
    <span class="keywordflow">goto</span> ERROR;
  }


  <span class="comment">/* read how many mesh in the file */</span>
  <span class="keywordflow">if</span> ((nmesh = <a class="code" href="a01011_ga28ebd8a34278e9f6c526bc0ebad83399.html#ga28ebd8a34278e9f6c526bc0ebad83399" title="Cette routine permet de lire le nombre de maillages dans un fichier.">MEDnMesh</a>(fid)) &lt; 0) {
    <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : read how many mesh ...&quot;</span>);
    <span class="keywordflow">goto</span> ERROR;
  }

  <span class="keywordflow">for</span> (i=0;i&lt;nmesh;i++) {

    <span class="comment">/* read computation space dimension */</span>
    <span class="keywordflow">if</span> ((spacedim = <a class="code" href="a01011_gad36ab4651405ed8542fb2a63e2fc44da.html#gad36ab4651405ed8542fb2a63e2fc44da" title="Cette routine permet de lire dans un maillage le nombre d&amp;#39;axes du repère des...">MEDmeshnAxis</a>(fid, i+1)) &lt; 0) {
      <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : read computation space dimension ...&quot;</span>);
      <span class="keywordflow">goto</span> ERROR;
    }
    
    <span class="comment">/* memory allocation */</span>
    <span class="keywordflow">if</span> ((axisname  = (<span class="keywordtype">char</span>*) malloc(<a class="code" href="a00321_a213ecd1a546eb96092b980a870bc386b.html#a213ecd1a546eb96092b980a870bc386b">MED_SNAME_SIZE</a>*spacedim+1)) == NULL) {
      <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : memory allocation ...&quot;</span>);
      <span class="keywordflow">goto</span> ERROR;
    }
    <span class="keywordflow">if</span> ((unitname  = (<span class="keywordtype">char</span>*) malloc(<a class="code" href="a00321_a213ecd1a546eb96092b980a870bc386b.html#a213ecd1a546eb96092b980a870bc386b">MED_SNAME_SIZE</a>*spacedim+1)) == NULL) {
      <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : memory allocation ...&quot;</span>);
      <span class="keywordflow">goto</span> ERROR;
    }

    <span class="comment">/* read mesh informations : meshname, mesh dimension, mesh type ... */</span>
    <span class="keywordflow">if</span> (<a class="code" href="a01011_ga71e0d79fbb40abdc9c20bc5be01441ac.html#ga71e0d79fbb40abdc9c20bc5be01441ac" title="Cette routine permet de lire les informations relatives à un maillage dans un fichier...">MEDmeshInfo</a>(fid, i+1, meshname, &amp;spacedim, &amp;meshdim, &amp;meshtype, meshdescription, 
                    dtunit, &amp;sortingtype, &amp;nstep,  
                    &amp;axistype, axisname, unitname) &lt; 0) {
      <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : mesh info ...&quot;</span>)
        free(axisname);
      free(unitname);
      goto ERROR;
    }
    free(axisname);
    free(unitname);


    <span class="comment">/* read how many nodes in the mesh */</span>
    if ((nnodes = <a class="code" href="a01011_ga45758103360dacf7b8a6c53ebfa4d7e5.html#ga45758103360dacf7b8a6c53ebfa4d7e5" title="Cette routine permet de lire le nombre d&amp;#39;entités dans un maillage pour une séquence...">MEDmeshnEntity</a>(fid, meshname, <a class="code" href="a00321_a8f72b6ceb3b6f5a67f9efd46cb90707a.html#a8f72b6ceb3b6f5a67f9efd46cb90707a">MED_NO_DT</a>, <a class="code" href="a00321_a95919207fd7a18ba26e6e03f04811e3f.html#a95919207fd7a18ba26e6e03f04811e3f">MED_NO_IT</a>, <a class="code" href="a00321_aab0e957294723517d5c3641bb71b0470.html#aab0e957294723517d5c3641bb71b0470a074507163b07b6d764823a78c5c07f0f">MED_NODE</a>, <a class="code" href="a00321_a9a2843c7d6eacffdd9377b5bfb8a6de3.html#a9a2843c7d6eacffdd9377b5bfb8a6de3">MED_NONE</a>,
                                 <a class="code" href="a00321_a25ee4b3675737fc23511b28b3245c61b.html#a25ee4b3675737fc23511b28b3245c61bad78949eab3c743083dfbf687c92bbdcb">MED_COORDINATE</a>, <a class="code" href="a00321_afcd26ca66a179b9aa82f5c90602c4ed8.html#afcd26ca66a179b9aa82f5c90602c4ed8a2b1e772016688b78b808e96a44d1ee02">MED_NO_CMODE</a>,&amp;coordinatechangement,
                                 &amp;geotransformation)) &lt; 0) {
      <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : number of nodes ...&quot;</span>);
      <span class="keywordflow">goto</span> ERROR;
    }
  
    <span class="comment">/* read mesh nodes coordinates */</span>
    <span class="keywordflow">if</span> ((coordinates = (<a class="code" href="a00320_ab1eab99ca56ac95ce5b1c0e4ae0f095a.html#ab1eab99ca56ac95ce5b1c0e4ae0f095a">med_float</a>*) malloc(<span class="keyword">sizeof</span>(<a class="code" href="a00320_ab1eab99ca56ac95ce5b1c0e4ae0f095a.html#ab1eab99ca56ac95ce5b1c0e4ae0f095a">med_float</a>)*nnodes*spacedim)) == NULL) {
      <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : memory allocation ...&quot;</span>);
      <span class="keywordflow">goto</span> ERROR;
    }
    
    <span class="keywordflow">if</span> (<a class="code" href="a01011_ga392a4bd4e6d340020755de7353f8a528.html#ga392a4bd4e6d340020755de7353f8a528" title="Cette routine permet de lire dans un maillage le tableau des coordonnées des noeuds...">MEDmeshNodeCoordinateRd</a>(fid, meshname, <a class="code" href="a00321_a8f72b6ceb3b6f5a67f9efd46cb90707a.html#a8f72b6ceb3b6f5a67f9efd46cb90707a">MED_NO_DT</a>, <a class="code" href="a00321_a95919207fd7a18ba26e6e03f04811e3f.html#a95919207fd7a18ba26e6e03f04811e3f">MED_NO_IT</a>, <a class="code" href="a00320_a0ac861d71fe5e0be056a86f9212f1c6a.html#a0ac861d71fe5e0be056a86f9212f1c6aa9a1509b3f93e5915a24f555890c73ee1">MED_FULL_INTERLACE</a>,
                                coordinates) &lt; 0) {
      <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : nodes coordinates ...&quot;</span>);
      free(coordinates);
      <span class="keywordflow">goto</span> ERROR;
    }
    

    <span class="comment">/* read all MED geometry cell types */</span>
    <span class="keywordflow">for</span> (it=1; it&lt;=<a class="code" href="a00321_abd42d91233c317ca8eb9b592e4502053.html#abd42d91233c317ca8eb9b592e4502053">MED_N_CELL_FIXED_GEO</a>; it++) {   

      geotype = geotypes[it];   

      <span class="keywordflow">if</span> ((ngeo = <a class="code" href="a01011_ga45758103360dacf7b8a6c53ebfa4d7e5.html#ga45758103360dacf7b8a6c53ebfa4d7e5" title="Cette routine permet de lire le nombre d&amp;#39;entités dans un maillage pour une séquence...">MEDmeshnEntity</a>(fid, meshname, <a class="code" href="a00321_a8f72b6ceb3b6f5a67f9efd46cb90707a.html#a8f72b6ceb3b6f5a67f9efd46cb90707a">MED_NO_DT</a>, <a class="code" href="a00321_a95919207fd7a18ba26e6e03f04811e3f.html#a95919207fd7a18ba26e6e03f04811e3f">MED_NO_IT</a>, <a class="code" href="a00321_aab0e957294723517d5c3641bb71b0470.html#aab0e957294723517d5c3641bb71b0470a227d14957ec5f221685cb1d6ec3b6c67">MED_CELL</a>,geotype,
                                 <a class="code" href="a00321_a25ee4b3675737fc23511b28b3245c61b.html#a25ee4b3675737fc23511b28b3245c61bac845229e0179819897411d7cb9186824">MED_CONNECTIVITY</a>, <a class="code" href="a00321_afcd26ca66a179b9aa82f5c90602c4ed8.html#afcd26ca66a179b9aa82f5c90602c4ed8a4ae92e7de0898383577cbba640006baa">MED_NODAL</a>, &amp;coordinatechangement,
                                 &amp;geotransformation)) &lt; 0) {
        <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : number of cell ...&quot;</span>);
        <a class="code" href="a00348_a818470a84d2ad18a3fbb48170296cd95.html#a818470a84d2ad18a3fbb48170296cd95">ISCRUTE</a>(geotype);
        <span class="keywordflow">goto</span> ERROR;
      }
    
      <span class="keywordflow">if</span> (ngeo) {
        <span class="comment">/* read cells connectivity in the mesh */</span>
        <span class="keywordflow">if</span> ((connectivity = (<a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> *) malloc(<span class="keyword">sizeof</span>(<a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a>)*ngeo*(geotype%100))) == NULL) {
          <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : memory allocation ...&quot;</span>);
          <span class="keywordflow">goto</span> ERROR;
        }
        
        <span class="keywordflow">if</span> (<a class="code" href="a01011_ga014f716ad13c72466b4aa94237876bf5.html#ga014f716ad13c72466b4aa94237876bf5" title="Cette routine permet de lire dans un maillage le tableau des connectivités pour...">MEDmeshElementConnectivityRd</a>(fid, meshname, <a class="code" href="a00321_a8f72b6ceb3b6f5a67f9efd46cb90707a.html#a8f72b6ceb3b6f5a67f9efd46cb90707a">MED_NO_DT</a>, <a class="code" href="a00321_a95919207fd7a18ba26e6e03f04811e3f.html#a95919207fd7a18ba26e6e03f04811e3f">MED_NO_IT</a>, <a class="code" href="a00321_aab0e957294723517d5c3641bb71b0470.html#aab0e957294723517d5c3641bb71b0470a227d14957ec5f221685cb1d6ec3b6c67">MED_CELL</a>,
                                         geotype, <a class="code" href="a00321_afcd26ca66a179b9aa82f5c90602c4ed8.html#afcd26ca66a179b9aa82f5c90602c4ed8a4ae92e7de0898383577cbba640006baa">MED_NODAL</a>, <a class="code" href="a00320_a0ac861d71fe5e0be056a86f9212f1c6a.html#a0ac861d71fe5e0be056a86f9212f1c6aa9a1509b3f93e5915a24f555890c73ee1">MED_FULL_INTERLACE</a>, connectivity) &lt; 0) {
          <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : cellconnectivity ...&quot;</span>);
          <a class="code" href="a00348_a818470a84d2ad18a3fbb48170296cd95.html#a818470a84d2ad18a3fbb48170296cd95">ISCRUTE</a>(geotype);
          free(connectivity);
          <span class="keywordflow">goto</span> ERROR;
        }

        <span class="comment">/* memory deallocation */</span>
        free(connectivity);
        connectivity = NULL;
      }
    }
    

    <span class="comment">/* read nodes coordinates changements step by step */</span>
    <span class="keywordflow">for</span> (it=1;it&lt;nstep;it++) {
      
      <span class="keywordflow">if</span> (<a class="code" href="a01011_ga3faa1e7f284f59b74778ad5db9c00c95.html#ga3faa1e7f284f59b74778ad5db9c00c95" title="Cette routine permet de lire les informations relatives à une séquence de calcul...">MEDmeshComputationStepInfo</a>(fid, meshname, it+1, 
                                     &amp;numdt, &amp;numit, &amp;dt) &lt; 0) {
        <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : Computing step info ...&quot;</span>);
        <a class="code" href="a00348_a257959db0a78623caa051d11ceb2f8cb.html#a257959db0a78623caa051d11ceb2f8cb">SSCRUTE</a>(meshname);
        <span class="keywordflow">goto</span> ERROR;
      }
      
      <span class="comment">/* test changement : for nodes coordinates */</span>
      <span class="keywordflow">if</span> ((nnodes = <a class="code" href="a01011_ga2b875dddcf5922d6143c72cb1e0924cf.html#ga2b875dddcf5922d6143c72cb1e0924cf" title="Cette routine permet de lire le nombre d&amp;#39;entités dans un maillage pour une séquence...">MEDmeshnEntityWithProfile</a>(fid, meshname, numdt, numit, 
                                              <a class="code" href="a00321_aab0e957294723517d5c3641bb71b0470.html#aab0e957294723517d5c3641bb71b0470a074507163b07b6d764823a78c5c07f0f">MED_NODE</a>, <a class="code" href="a00321_a9a2843c7d6eacffdd9377b5bfb8a6de3.html#a9a2843c7d6eacffdd9377b5bfb8a6de3">MED_NONE</a>,
                                              <a class="code" href="a00321_a25ee4b3675737fc23511b28b3245c61b.html#a25ee4b3675737fc23511b28b3245c61bad78949eab3c743083dfbf687c92bbdcb">MED_COORDINATE</a>, <a class="code" href="a00321_afcd26ca66a179b9aa82f5c90602c4ed8.html#afcd26ca66a179b9aa82f5c90602c4ed8a2b1e772016688b78b808e96a44d1ee02">MED_NO_CMODE</a>,
                                              <a class="code" href="a00321_a3f7b3a3c5ddcaba3fa1741a367503c8d.html#a3f7b3a3c5ddcaba3fa1741a367503c8da56cfcdcbbab7ddfc577de288697cd291">MED_GLOBAL_PFLMODE</a>, profilename, &amp;profilesize,
                                              &amp;coordinatechangement, &amp;geotransformation)) &lt; 0) {
        <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : number of nodes ...&quot;</span>); 
        <span class="keywordflow">goto</span> ERROR;
      }
      
      <span class="comment">/* if only coordinates have changed, then read the new coordinates */</span>
      <span class="comment">/* to verify if there is a matrix transformation =&gt; UsesCase_MEDmesh12. */</span>
      <span class="keywordflow">if</span> (coordinatechangement &amp;&amp; geotransformation) {
        <span class="keywordflow">if</span> (<a class="code" href="a01011_ga069faade0b33a1d245a20160e7f33ce5.html#ga069faade0b33a1d245a20160e7f33ce5" title="Cette routine permet de lire dans un maillage le tableau des coordonnées des noeuds...">MEDmeshNodeCoordinateWithProfileRd</a>(fid, meshname, numdt, numit, 
                                               <a class="code" href="a00321_a3f7b3a3c5ddcaba3fa1741a367503c8d.html#a3f7b3a3c5ddcaba3fa1741a367503c8da56cfcdcbbab7ddfc577de288697cd291">MED_GLOBAL_PFLMODE</a>,profilename,
                                               <a class="code" href="a00320_a0ac861d71fe5e0be056a86f9212f1c6a.html#a0ac861d71fe5e0be056a86f9212f1c6aa9a1509b3f93e5915a24f555890c73ee1">MED_FULL_INTERLACE</a>,<a class="code" href="a00321_a65a18ab6db672a2d21312d1813a3bb19.html#a65a18ab6db672a2d21312d1813a3bb19">MED_ALL_CONSTITUENT</a>,
                                               coordinates) &lt; 0) {
          <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : nodes coordinates ...&quot;</span>);
          free(coordinates);
          <span class="keywordflow">goto</span> ERROR;
        }
      }
      
    }
  }

  free(coordinates);

  ret=0;
 ERROR:

  <span class="comment">/* close MED file */</span>
  <span class="keywordflow">if</span> (<a class="code" href="a01005_ga12a0e901c376be997a41a073ce426283.html#ga12a0e901c376be997a41a073ce426283" title="Fermeture d&amp;#39;un fichier MED.">MEDfileClose</a>(fid) &lt; 0) {
    <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : close file&quot;</span>);             
    ret=-1; 
  } 

  
  <span class="keywordflow">return</span> ret;
}

</pre></div> <p>Pour ce qui concerne l'&eacute;criture des maillages avec d&eacute;formation solide, il faut utiliser la routine <a class="el" href="a01011_ga1a9b0f9b78488988128a784526d84f81.html#ga1a9b0f9b78488988128a784526d84f81">MEDmeshNodeCoordinateTrsfWr</a> / <a class="el" href="a01026_ga99eb0fcd8971255711df7f13034f9f16.html#ga99eb0fcd8971255711df7f13034f9f16">mmhtfw</a> en passant en param&egrave;tre le pas de temps et ou le num&eacute;ro d'ordre correspondant &agrave; l'&eacute;tape et la matrice de transformation. Cette matrice comporte 7 valeurs r&eacute;elles : les trois premi&egrave;res d&eacute;finissent la translation &agrave; appliquer selon l'ordre des axes d&eacute;finis pour le maillage et les quatres suivantes d&eacute;finissent une rotation phi par le quarternion (p4,p5-7) o&ugrave; p4 est le scalaire et p5-7 le vecteur d&eacute;crit suivant l'ordre des axes d&eacute;finis pour le maillage. S'il y a moins de trois axes d&eacute;finis, les param&egrave;tres inutiles &agrave; la transformation doivent &ecirc;tre &agrave; z&eacute;ro. </p>
<div class="fragment"><pre class="fragment"><span class="comment">/*  This file is part of MED.</span>
<span class="comment"> *</span>
<span class="comment"> *  COPYRIGHT (C) 1999 - 2012  EDF R&amp;D, CEA/DEN</span>
<span class="comment"> *  MED is free software: you can redistribute it and/or modify</span>
<span class="comment"> *  it under the terms of the GNU Lesser General Public License as published by</span>
<span class="comment"> *  the Free Software Foundation, either version 3 of the License, or</span>
<span class="comment"> *  (at your option) any later version.</span>
<span class="comment"> *</span>
<span class="comment"> *  MED is distributed in the hope that it will be useful,</span>
<span class="comment"> *  but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="comment"> *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<span class="comment"> *  GNU Lesser General Public License for more details.</span>
<span class="comment"> *</span>
<span class="comment"> *  You should have received a copy of the GNU Lesser General Public License</span>
<span class="comment"> *  along with MED.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span>
<span class="comment"> */</span>

<span class="comment">/*</span>
<span class="comment"> *  How to create an unstructured mesh </span>
<span class="comment"> *</span>
<span class="comment"> *  Use case 9 : a 2D unstructured mesh with moving grid</span>
<span class="comment"> *  transformation   </span>
<span class="comment"> */</span>

<span class="preprocessor">#include &lt;med.h&gt;</span>
<span class="preprocessor">#define MESGERR 1</span>
<span class="preprocessor"></span><span class="preprocessor">#include &lt;med_utils.h&gt;</span>

<span class="preprocessor">#include &lt;string.h&gt;</span>

<span class="keywordtype">int</span> <a class="code" href="a00750_a3c04138a5bfe5d72780bb7e82a18e627.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a> (<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> **argv) {
  <a class="code" href="a00320_afa4ec8284026c8c5545e5333475fb65a.html#afa4ec8284026c8c5545e5333475fb65a">med_idt</a> fid;
  <span class="keyword">const</span> <span class="keywordtype">char</span> meshname[<a class="code" href="a00321_a0ae989cbbfeecbb5296b3ceba8dab886.html#a0ae989cbbfeecbb5296b3ceba8dab886">MED_NAME_SIZE</a>+1] = <span class="stringliteral">&quot;2D unstructured mesh&quot;</span>;
  <span class="keyword">const</span> <a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> spacedim = 2;
  <span class="keyword">const</span> <a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> meshdim = 2;
  <span class="keyword">const</span> <span class="keywordtype">char</span> axisname[2*<a class="code" href="a00321_a213ecd1a546eb96092b980a870bc386b.html#a213ecd1a546eb96092b980a870bc386b">MED_SNAME_SIZE</a>+1] = <span class="stringliteral">&quot;x               y               &quot;</span>;
  <span class="keyword">const</span> <span class="keywordtype">char</span> unitname[2*<a class="code" href="a00321_a213ecd1a546eb96092b980a870bc386b.html#a213ecd1a546eb96092b980a870bc386b">MED_SNAME_SIZE</a>+1] = <span class="stringliteral">&quot;cm              cm              &quot;</span>;
  <span class="keyword">const</span> <a class="code" href="a00320_ab1eab99ca56ac95ce5b1c0e4ae0f095a.html#ab1eab99ca56ac95ce5b1c0e4ae0f095a">med_float</a> initial_coordinates[30] = { 2.,1.,  7.,1.,  12.,1.,  17.,1.,  22.,1.,
                                              2.,6.,  7.,6.,  12.,6.,  17.,6.,  22.,6.,
                                              2.,11., 7.,11., 12.,11., 17.,11., 22.,11.};
  <span class="keyword">const</span> <a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> nnodes = 15;
  <span class="keyword">const</span> <a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> triaconnectivity[24] = { 1,7,6,   2,7,1,  3,7,2,   8,7,3,   
                                   13,7,8, 12,7,13, 11,7,12, 6,7,11 };
  <span class="keyword">const</span> <a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> ntria3 = 8;
  <span class="keyword">const</span> <a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> quadconnectivity[16] = {3,4,9,8,    4,5,10,9, 
                                        15,14,9,10, 13,8,9,14};
  <span class="keyword">const</span> <a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> nquad4 = 4;
  <span class="comment">/* matrix transformation (step 1) : rotation about the Y-axis : 45 degrees */</span>
  <span class="keyword">const</span> <a class="code" href="a00320_ab1eab99ca56ac95ce5b1c0e4ae0f095a.html#ab1eab99ca56ac95ce5b1c0e4ae0f095a">med_float</a> tansfMatrix_step1 [7] = { 0.0, 0.0, 0.0, 0.92388, 0.0, 0.38268, 0.0 };
  <span class="comment">/* matrix transformation (step 2) : rotation about the Y-axis : 90 degrees */</span>
  <span class="keyword">const</span> <a class="code" href="a00320_ab1eab99ca56ac95ce5b1c0e4ae0f095a.html#ab1eab99ca56ac95ce5b1c0e4ae0f095a">med_float</a> tansfMatrix_step2 [7] = { 0.0, 0.0, 0.0, 0.707,   0.0, 0.707,   0.0 };
  <span class="keywordtype">int</span> ret=-1;
  
  <span class="comment">/* open MED file */</span>
  fid = <a class="code" href="a01005_ga9376a1654b7bf099c3f8941074c5fdfb.html#ga9376a1654b7bf099c3f8941074c5fdfb" title="Ouverture d&amp;#39;un fichier MED.">MEDfileOpen</a>(<span class="stringliteral">&quot;UsesCase_MEDmesh_9.med&quot;</span>,<a class="code" href="a00321_adcd0322de9fec3b5e199ffeda3f44c85.html#adcd0322de9fec3b5e199ffeda3f44c85aa23dd1c18b596924d5f50c8402b84c8e">MED_ACC_CREAT</a>);
  <span class="keywordflow">if</span> (fid &lt; 0) {
    <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : file creation ...&quot;</span>);
    <span class="keywordflow">goto</span> ERROR;
  }

  <span class="comment">/* write a comment in the file */</span>
  <span class="keywordflow">if</span> (<a class="code" href="a01005_ga08d625f5403fefb9deb7d47f9a915c41.html#ga08d625f5403fefb9deb7d47f9a915c41" title="Ecriture d&amp;#39;un descripteur dans un fichier MED.">MEDfileCommentWr</a>(fid,<span class="stringliteral">&quot;A 2D unstructured mesh : 15 nodes, 12 cells&quot;</span>) &lt; 0) {
    <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : write file description ...&quot;</span>);
    <span class="keywordflow">goto</span> ERROR;
  }

  <span class="comment">/* mesh creation : a 2D unstructured mesh */</span>
  <span class="keywordflow">if</span> (<a class="code" href="a01011_ga6007c3f1a62732e7a46c5eca232be78a.html#ga6007c3f1a62732e7a46c5eca232be78a" title="Cette routine permet de créer un maillage dans un fichier.">MEDmeshCr</a>(fid, meshname, spacedim, meshdim, <a class="code" href="a00321_a821a4dd94c5c6b095318432bdec8d8a1.html#a821a4dd94c5c6b095318432bdec8d8a1a3719e53a4838d222f0a58148292fda41">MED_UNSTRUCTURED_MESH</a>, 
                <span class="stringliteral">&quot;A 2D structured mesh&quot;</span>,<span class="stringliteral">&quot;&quot;</span>,<a class="code" href="a00321_a5b97067a30629cd60470d074691d6798.html#a5b97067a30629cd60470d074691d6798ae896b6adfbde9870b4e875e5167eddd0">MED_SORT_DTIT</a>,<a class="code" href="a00321_a57867e4bed1d104c865cfc9d23c9204d.html#a57867e4bed1d104c865cfc9d23c9204da682ef7f1042079519664eae87f90297e">MED_CARTESIAN</a>, axisname, unitname) &lt; 0) {
    <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : mesh creation ...&quot;</span>);
    <span class="keywordflow">goto</span> ERROR;
  }

  <span class="comment">/* nodes coordinates in a cartesian axis in full interlace mode </span>
<span class="comment">     (X1,Y1, X2,Y2, X3,Y3, ...) with no iteration and computation step </span>
<span class="comment">  */</span>
  <span class="keywordflow">if</span> (<a class="code" href="a01011_ga9dee3d76d357b2aa31e562406d151f70.html#ga9dee3d76d357b2aa31e562406d151f70" title="Cette routine permet d&amp;#39;écrire dans un maillage le tableau des coordonnées des...">MEDmeshNodeCoordinateWithProfileWr</a>(fid, meshname, <a class="code" href="a00321_a8f72b6ceb3b6f5a67f9efd46cb90707a.html#a8f72b6ceb3b6f5a67f9efd46cb90707a">MED_NO_DT</a>, <a class="code" href="a00321_a95919207fd7a18ba26e6e03f04811e3f.html#a95919207fd7a18ba26e6e03f04811e3f">MED_NO_IT</a>, 0.0,
                                         <a class="code" href="a00321_a3f7b3a3c5ddcaba3fa1741a367503c8d.html#a3f7b3a3c5ddcaba3fa1741a367503c8da285ff6474ec39fcb4c49b66a9376ec92">MED_COMPACT_PFLMODE</a>, <a class="code" href="a00321_aaa89a5e5e6d32de69614b70cf74e29cc.html#aaa89a5e5e6d32de69614b70cf74e29cc">MED_NO_PROFILE</a>,
                                         <a class="code" href="a00320_a0ac861d71fe5e0be056a86f9212f1c6a.html#a0ac861d71fe5e0be056a86f9212f1c6aa9a1509b3f93e5915a24f555890c73ee1">MED_FULL_INTERLACE</a>, <a class="code" href="a00321_a65a18ab6db672a2d21312d1813a3bb19.html#a65a18ab6db672a2d21312d1813a3bb19">MED_ALL_CONSTITUENT</a>,
                                         nnodes, initial_coordinates) &lt; 0) {
    <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : nodes coordinates ...&quot;</span>);
    <span class="keywordflow">goto</span> ERROR;
  }

  <span class="comment">/* cells connectiviy is defined in nodal mode */</span>
  <span class="keywordflow">if</span> (<a class="code" href="a01011_gade9c04c83f2909bfa25094f94ec0f6d2.html#gade9c04c83f2909bfa25094f94ec0f6d2" title="Cette routine permet d&amp;#39;écrire dans un maillage le tableau des connectivités...">MEDmeshElementConnectivityWithProfileWr</a>(fid, meshname, <a class="code" href="a00321_a8f72b6ceb3b6f5a67f9efd46cb90707a.html#a8f72b6ceb3b6f5a67f9efd46cb90707a">MED_NO_DT</a>, <a class="code" href="a00321_a95919207fd7a18ba26e6e03f04811e3f.html#a95919207fd7a18ba26e6e03f04811e3f">MED_NO_IT</a>, 0.0,
                                              <a class="code" href="a00321_aab0e957294723517d5c3641bb71b0470.html#aab0e957294723517d5c3641bb71b0470a227d14957ec5f221685cb1d6ec3b6c67">MED_CELL</a>, <a class="code" href="a00321_a4a1eb7ba296742a6f5eb8b5b23b39670.html#a4a1eb7ba296742a6f5eb8b5b23b39670">MED_TRIA3</a>, <a class="code" href="a00321_afcd26ca66a179b9aa82f5c90602c4ed8.html#afcd26ca66a179b9aa82f5c90602c4ed8a4ae92e7de0898383577cbba640006baa">MED_NODAL</a>, 
                                              <a class="code" href="a00321_a3f7b3a3c5ddcaba3fa1741a367503c8d.html#a3f7b3a3c5ddcaba3fa1741a367503c8da285ff6474ec39fcb4c49b66a9376ec92">MED_COMPACT_PFLMODE</a>, <a class="code" href="a00321_aaa89a5e5e6d32de69614b70cf74e29cc.html#aaa89a5e5e6d32de69614b70cf74e29cc">MED_NO_PROFILE</a>,
                                              <a class="code" href="a00320_a0ac861d71fe5e0be056a86f9212f1c6a.html#a0ac861d71fe5e0be056a86f9212f1c6aa9a1509b3f93e5915a24f555890c73ee1">MED_FULL_INTERLACE</a>, <a class="code" href="a00321_a65a18ab6db672a2d21312d1813a3bb19.html#a65a18ab6db672a2d21312d1813a3bb19">MED_ALL_CONSTITUENT</a>, 
                                              ntria3, triaconnectivity) &lt; 0) {
    <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : triangular cells connectivity ...&quot;</span>);
    <span class="keywordflow">goto</span> ERROR;
  }

  <span class="keywordflow">if</span> (<a class="code" href="a01011_gade9c04c83f2909bfa25094f94ec0f6d2.html#gade9c04c83f2909bfa25094f94ec0f6d2" title="Cette routine permet d&amp;#39;écrire dans un maillage le tableau des connectivités...">MEDmeshElementConnectivityWithProfileWr</a>(fid, meshname, <a class="code" href="a00321_a8f72b6ceb3b6f5a67f9efd46cb90707a.html#a8f72b6ceb3b6f5a67f9efd46cb90707a">MED_NO_DT</a>, <a class="code" href="a00321_a95919207fd7a18ba26e6e03f04811e3f.html#a95919207fd7a18ba26e6e03f04811e3f">MED_NO_IT</a>, 0.0,
                                              <a class="code" href="a00321_aab0e957294723517d5c3641bb71b0470.html#aab0e957294723517d5c3641bb71b0470a227d14957ec5f221685cb1d6ec3b6c67">MED_CELL</a>, <a class="code" href="a00321_a24ea9c52f5bde41d9a072925249ec06c.html#a24ea9c52f5bde41d9a072925249ec06c">MED_QUAD4</a>, <a class="code" href="a00321_afcd26ca66a179b9aa82f5c90602c4ed8.html#afcd26ca66a179b9aa82f5c90602c4ed8a4ae92e7de0898383577cbba640006baa">MED_NODAL</a>, 
                                              <a class="code" href="a00321_a3f7b3a3c5ddcaba3fa1741a367503c8d.html#a3f7b3a3c5ddcaba3fa1741a367503c8da285ff6474ec39fcb4c49b66a9376ec92">MED_COMPACT_PFLMODE</a>, <a class="code" href="a00321_aaa89a5e5e6d32de69614b70cf74e29cc.html#aaa89a5e5e6d32de69614b70cf74e29cc">MED_NO_PROFILE</a>,
                                              <a class="code" href="a00320_a0ac861d71fe5e0be056a86f9212f1c6a.html#a0ac861d71fe5e0be056a86f9212f1c6aa9a1509b3f93e5915a24f555890c73ee1">MED_FULL_INTERLACE</a>, <a class="code" href="a00321_a65a18ab6db672a2d21312d1813a3bb19.html#a65a18ab6db672a2d21312d1813a3bb19">MED_ALL_CONSTITUENT</a>,  
                                              nquad4, quadconnectivity) &lt; 0) {
    <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : quadrangular cells connectivity ...&quot;</span>); 
    <span class="keywordflow">goto</span> ERROR;
  }

  <span class="comment">/* </span>
<span class="comment">   * Mesh deformation (nodes coordinates) in 2 steps </span>
<span class="comment">   * A rotation by step for each node</span>
<span class="comment">   */</span> 
  <span class="comment">/* STEP 1 : dt1 = 5.5, it = 1*/</span>
  <span class="keywordflow">if</span> ( <a class="code" href="a01011_ga1a9b0f9b78488988128a784526d84f81.html#ga1a9b0f9b78488988128a784526d84f81" title="Cette routine définit les paramètres de translation rotation à appliquer aux noeuds...">MEDmeshNodeCoordinateTrsfWr</a>(fid, meshname, 1, 1, 5.5, tansfMatrix_step1) &lt; 0) {
    <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;Erreur a l&apos;ecriture de la transformation géométrique n°1&quot;</span>);
    <span class="keywordflow">goto</span> ERROR;
  }

  <span class="comment">/* STEP 2 : dt2 = 8.9, it = 1*/</span>
  <span class="keywordflow">if</span> ( <a class="code" href="a01011_ga1a9b0f9b78488988128a784526d84f81.html#ga1a9b0f9b78488988128a784526d84f81" title="Cette routine définit les paramètres de translation rotation à appliquer aux noeuds...">MEDmeshNodeCoordinateTrsfWr</a>(fid, meshname, 2, 2, 8.9, tansfMatrix_step2 ) &lt; 0) {
    <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;Erreur a l&apos;ecriture de la transformation géométrique n°1&quot;</span>);
    <span class="keywordflow">goto</span> ERROR;
  }

  <span class="comment">/* create family 0 : by default, all mesh entities family number is 0 */</span>
  <span class="keywordflow">if</span> (<a class="code" href="a01003_ga0873b54d0dc1472eee12c42aaf4fbca3.html#ga0873b54d0dc1472eee12c42aaf4fbca3" title="Cette routine permet la création d&amp;#39;une famille portant sur les entités d&amp;#39;un...">MEDfamilyCr</a>(fid, meshname,<a class="code" href="a00321_afd1f2684a3484575283e2a46f2d809da.html#afd1f2684a3484575283e2a46f2d809da">MED_NO_NAME</a>, 0, 0, <a class="code" href="a00321_a41b68e0bf49e21cf091f12ee6d9ab66c.html#a41b68e0bf49e21cf091f12ee6d9ab66c">MED_NO_GROUP</a>) &lt; 0) {
    <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : create family ...&quot;</span>);
    <span class="keywordflow">goto</span> ERROR;
  }
  
  ret=0;
 ERROR:

  <span class="comment">/* close MED file */</span>
  <span class="keywordflow">if</span> (<a class="code" href="a01005_ga12a0e901c376be997a41a073ce426283.html#ga12a0e901c376be997a41a073ce426283" title="Fermeture d&amp;#39;un fichier MED.">MEDfileClose</a>(fid)  &lt; 0) {
    <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : close file ...&quot;</span>);
    ret=-1;
  }

  <span class="keywordflow">return</span> ret;
}
</pre></div> <p>A la lecture des maillages avec d&eacute;formation solide, une fois la lecture du maillage initiale effectu&eacute;e, il faut it&eacute;rer sur les diff&eacute;rentes &eacute;tapes d'&eacute;volution pr&eacute;sentes dans le maillage (le nombre d'&eacute;tape est lue par les routines <a class="el" href="a01011_gaf5e84a05155579ded1ba18a672385f97.html#gaf5e84a05155579ded1ba18a672385f97">MEDmeshInfoByName</a> / <a class="el" href="a01026_ga5b94892a2077826f2e2712c4ec3ae369.html#ga5b94892a2077826f2e2712c4ec3ae369">mmhmin</a> ou <a class="el" href="a01011_ga71e0d79fbb40abdc9c20bc5be01441ac.html#ga71e0d79fbb40abdc9c20bc5be01441ac">MEDmeshInfo</a> / <a class="el" href="a01026_gaf119a6264944d32e884b6d148bf17bcf.html#gaf119a6264944d32e884b6d148bf17bcf">mmhmii</a>) et &agrave; chaque &eacute;tape : r&eacute;cup&eacute;rer les valeurs du pas de temps et du num&eacute;ro d'it&eacute;ration avec la routine <a class="el" href="a01011_ga3faa1e7f284f59b74778ad5db9c00c95.html#ga3faa1e7f284f59b74778ad5db9c00c95">MEDmeshComputationStepInfo</a> / <a class="el" href="a01026_gaaf283cac4dc51471665ee1b713f5c961.html#gaaf283cac4dc51471665ee1b713f5c961">mmhcsi</a> ; d&eacute;terminer la nature du changement parmi les cas possibles pr&eacute;-cit&eacute;s avec la routine <a class="el" href="a01011_ga2b875dddcf5922d6143c72cb1e0924cf.html#ga2b875dddcf5922d6143c72cb1e0924cf">MEDmeshnEntityWithProfile</a> / <a class="el" href="a01026_gad8572227573582320220320a354fb2cd.html#gad8572227573582320220320a354fb2cd">mmhnep</a> et &eacute;galement v&eacute;rifier la pr&eacute;sence de la matrice de transformation ; lire la matrice de transformation avec la routine <a class="el" href="a01011_ga7c511c6150325e5274781e1234ce043e.html#ga7c511c6150325e5274781e1234ce043e">MEDmeshNodeCoordinateTrsfRd</a> / <a class="el" href="a01026_gaddbf3fa07ecc131e3a9071aa6d7308f8.html#gaddbf3fa07ecc131e3a9071aa6d7308f8">mmhtfr</a>. </p>
<p>Le cas d'utilisation suivant permet de lire de mani&egrave;re g&eacute;n&eacute;rique un maillage &eacute;volutif, &agrave; la fois s'il s'agit d'un maillage d&eacute;formable &agrave; topologie constante ou d'un maillage avec d&eacute;formation solide. </p>
<div class="fragment"><pre class="fragment"><span class="comment">/*  This file is part of MED.</span>
<span class="comment"> *</span>
<span class="comment"> *  COPYRIGHT (C) 1999 - 2012  EDF R&amp;D, CEA/DEN</span>
<span class="comment"> *  MED is free software: you can redistribute it and/or modify</span>
<span class="comment"> *  it under the terms of the GNU Lesser General Public License as published by</span>
<span class="comment"> *  the Free Software Foundation, either version 3 of the License, or</span>
<span class="comment"> *  (at your option) any later version.</span>
<span class="comment"> *</span>
<span class="comment"> *  MED is distributed in the hope that it will be useful,</span>
<span class="comment"> *  but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="comment"> *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<span class="comment"> *  GNU Lesser General Public License for more details.</span>
<span class="comment"> *</span>
<span class="comment"> *  You should have received a copy of the GNU Lesser General Public License</span>
<span class="comment"> *  along with MED.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span>
<span class="comment"> */</span>

<span class="comment">/*</span>
<span class="comment"> *  Use case 12 : read a 2D unstructured mesh with moving grid (generic approach)</span>
<span class="comment"> */</span>

<span class="preprocessor">#include &lt;med.h&gt;</span>
<span class="preprocessor">#define MESGERR 1</span>
<span class="preprocessor"></span><span class="preprocessor">#include &lt;med_utils.h&gt;</span>

<span class="preprocessor">#include &lt;string.h&gt;</span>

<span class="keywordtype">int</span> <a class="code" href="a00750_a3c04138a5bfe5d72780bb7e82a18e627.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a> (<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> **argv) {
  <a class="code" href="a00320_afa4ec8284026c8c5545e5333475fb65a.html#afa4ec8284026c8c5545e5333475fb65a">med_idt</a> fid;
  <a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> nmesh;
  <span class="keywordtype">char</span> meshname[<a class="code" href="a00321_a0ae989cbbfeecbb5296b3ceba8dab886.html#a0ae989cbbfeecbb5296b3ceba8dab886">MED_NAME_SIZE</a>+1]=<span class="stringliteral">&quot;&quot;</span>;
  <span class="keywordtype">char</span> meshdescription[<a class="code" href="a00321_ab69710ecf9f5257080a943579852d0f0.html#ab69710ecf9f5257080a943579852d0f0">MED_COMMENT_SIZE</a>+1]=<span class="stringliteral">&quot;&quot;</span>;
  <a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> meshdim;
  <a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> spacedim;
  <a class="code" href="a00321_a5b97067a30629cd60470d074691d6798.html#a5b97067a30629cd60470d074691d6798">med_sorting_type</a> sortingtype;
  <a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> nstep;
  <a class="code" href="a00321_a821a4dd94c5c6b095318432bdec8d8a1.html#a821a4dd94c5c6b095318432bdec8d8a1">med_mesh_type</a> meshtype;
  <a class="code" href="a00321_a57867e4bed1d104c865cfc9d23c9204d.html#a57867e4bed1d104c865cfc9d23c9204d">med_axis_type</a> axistype;
  <span class="keywordtype">char</span> *axisname;
  <span class="keywordtype">char</span> *unitname;
  <span class="keywordtype">char</span> dtunit[<a class="code" href="a00321_a213ecd1a546eb96092b980a870bc386b.html#a213ecd1a546eb96092b980a870bc386b">MED_SNAME_SIZE</a>+1]=<span class="stringliteral">&quot;&quot;</span>;
  <a class="code" href="a00320_ab1eab99ca56ac95ce5b1c0e4ae0f095a.html#ab1eab99ca56ac95ce5b1c0e4ae0f095a">med_float</a> *coordinates = NULL;
  <a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> ngeo = 0;
  <a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> nnodes = 0;
  <a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> *connectivity = NULL;
  <a class="code" href="a00321_a23f7fa6d76886ed3c91dc33b59190dee.html#a23f7fa6d76886ed3c91dc33b59190dee">med_bool</a> coordinatechangement;
  <a class="code" href="a00321_a23f7fa6d76886ed3c91dc33b59190dee.html#a23f7fa6d76886ed3c91dc33b59190dee">med_bool</a> geotransformation;
  <a class="code" href="a00321_a23f7fa6d76886ed3c91dc33b59190dee.html#a23f7fa6d76886ed3c91dc33b59190dee">med_bool</a> matrixtransformation;
  <a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> matrixsize;
  <a class="code" href="a00320_ab1eab99ca56ac95ce5b1c0e4ae0f095a.html#ab1eab99ca56ac95ce5b1c0e4ae0f095a">med_float</a> matrix[7]={ 0, 0, 0, 0, 0, 0, 0};
  <span class="keywordtype">int</span> i, it, j;
  <a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> profilesize;
  <span class="keywordtype">char</span> profilename[<a class="code" href="a00321_a0ae989cbbfeecbb5296b3ceba8dab886.html#a0ae989cbbfeecbb5296b3ceba8dab886">MED_NAME_SIZE</a>+1]=<span class="stringliteral">&quot;&quot;</span>;
  <a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> numdt, numit;
  <a class="code" href="a00320_ab1eab99ca56ac95ce5b1c0e4ae0f095a.html#ab1eab99ca56ac95ce5b1c0e4ae0f095a">med_float</a> dt;
  <a class="code" href="a00321_a1043613afc3cd2e24785dfc7c0452ab8.html#a1043613afc3cd2e24785dfc7c0452ab8">med_geometry_type</a> geotype;
  <a class="code" href="a00321_a1043613afc3cd2e24785dfc7c0452ab8.html#a1043613afc3cd2e24785dfc7c0452ab8">med_geometry_type</a> *geotypes = <a class="code" href="a00499_a54c2e34174a890046d0a204fa1a918a8.html#a54c2e34174a890046d0a204fa1a918a8">MED_GET_CELL_GEOMETRY_TYPE</a>;
  <span class="keywordtype">int</span> ret=-1;

  <span class="comment">/* open MED file with READ ONLY access mode */</span>
  fid = <a class="code" href="a01005_ga9376a1654b7bf099c3f8941074c5fdfb.html#ga9376a1654b7bf099c3f8941074c5fdfb" title="Ouverture d&amp;#39;un fichier MED.">MEDfileOpen</a>(<span class="stringliteral">&quot;UsesCase_MEDmesh_9.med&quot;</span>,<a class="code" href="a00321_adcd0322de9fec3b5e199ffeda3f44c85.html#adcd0322de9fec3b5e199ffeda3f44c85a616bf8345c622a34f0787f42eb400f25">MED_ACC_RDONLY</a>);
  <span class="keywordflow">if</span> (fid &lt; 0) {
    <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : open file in READ ONLY ACCESS mode ...&quot;</span>);
    <span class="keywordflow">goto</span> ERROR;
  }


  <span class="comment">/* read how many mesh in the file */</span>
  <span class="keywordflow">if</span> ((nmesh = <a class="code" href="a01011_ga28ebd8a34278e9f6c526bc0ebad83399.html#ga28ebd8a34278e9f6c526bc0ebad83399" title="Cette routine permet de lire le nombre de maillages dans un fichier.">MEDnMesh</a>(fid)) &lt; 0) {
    <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : read how many mesh ...&quot;</span>);
    <span class="keywordflow">goto</span> ERROR;
  }

  <span class="keywordflow">for</span> (i=0;i&lt;nmesh;i++) {

    <span class="comment">/* read computation space dimension */</span>
    <span class="keywordflow">if</span> ((spacedim = <a class="code" href="a01011_gad36ab4651405ed8542fb2a63e2fc44da.html#gad36ab4651405ed8542fb2a63e2fc44da" title="Cette routine permet de lire dans un maillage le nombre d&amp;#39;axes du repère des...">MEDmeshnAxis</a>(fid, i+1)) &lt; 0) {
      <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : read computation space dimension ...&quot;</span>);
      <span class="keywordflow">goto</span> ERROR;
    }
    
    <span class="comment">/* memory allocation */</span>
    <span class="keywordflow">if</span> ((axisname  = (<span class="keywordtype">char</span>*) malloc(<a class="code" href="a00321_a213ecd1a546eb96092b980a870bc386b.html#a213ecd1a546eb96092b980a870bc386b">MED_SNAME_SIZE</a>*spacedim+1)) == NULL) {
      <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : memory allocation ...&quot;</span>);
      <span class="keywordflow">goto</span> ERROR;
    }
    <span class="keywordflow">if</span> ((unitname  = (<span class="keywordtype">char</span>*) malloc(<a class="code" href="a00321_a213ecd1a546eb96092b980a870bc386b.html#a213ecd1a546eb96092b980a870bc386b">MED_SNAME_SIZE</a>*spacedim+1)) == NULL) {
      <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : memory allocation ...&quot;</span>);
      <span class="keywordflow">goto</span> ERROR;
    }

    <span class="comment">/* read mesh informations : meshname, mesh dimension, mesh type ... */</span>
    <span class="keywordflow">if</span> (<a class="code" href="a01011_ga71e0d79fbb40abdc9c20bc5be01441ac.html#ga71e0d79fbb40abdc9c20bc5be01441ac" title="Cette routine permet de lire les informations relatives à un maillage dans un fichier...">MEDmeshInfo</a>(fid, i+1, meshname, &amp;spacedim, &amp;meshdim, &amp;meshtype, meshdescription, 
                    dtunit, &amp;sortingtype, &amp;nstep,  
                    &amp;axistype, axisname, unitname) &lt; 0) {
      <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : mesh info ...&quot;</span>);
      free(axisname);
      free(unitname);
      <span class="keywordflow">goto</span> ERROR;
    }
    free(axisname);
    free(unitname);


    <span class="comment">/* read how many nodes in the mesh */</span>
    <span class="keywordflow">if</span> ((nnodes = <a class="code" href="a01011_ga45758103360dacf7b8a6c53ebfa4d7e5.html#ga45758103360dacf7b8a6c53ebfa4d7e5" title="Cette routine permet de lire le nombre d&amp;#39;entités dans un maillage pour une séquence...">MEDmeshnEntity</a>(fid, meshname, <a class="code" href="a00321_a8f72b6ceb3b6f5a67f9efd46cb90707a.html#a8f72b6ceb3b6f5a67f9efd46cb90707a">MED_NO_DT</a>, <a class="code" href="a00321_a95919207fd7a18ba26e6e03f04811e3f.html#a95919207fd7a18ba26e6e03f04811e3f">MED_NO_IT</a>, <a class="code" href="a00321_aab0e957294723517d5c3641bb71b0470.html#aab0e957294723517d5c3641bb71b0470a074507163b07b6d764823a78c5c07f0f">MED_NODE</a>, <a class="code" href="a00321_a9a2843c7d6eacffdd9377b5bfb8a6de3.html#a9a2843c7d6eacffdd9377b5bfb8a6de3">MED_NONE</a>,
                                 <a class="code" href="a00321_a25ee4b3675737fc23511b28b3245c61b.html#a25ee4b3675737fc23511b28b3245c61bad78949eab3c743083dfbf687c92bbdcb">MED_COORDINATE</a>, <a class="code" href="a00321_afcd26ca66a179b9aa82f5c90602c4ed8.html#afcd26ca66a179b9aa82f5c90602c4ed8a2b1e772016688b78b808e96a44d1ee02">MED_NO_CMODE</a>,&amp;coordinatechangement,
                                 &amp;geotransformation)) &lt; 0) {
      <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : number of nodes ...&quot;</span>);
      <span class="keywordflow">goto</span> ERROR;
    }
  
    <span class="comment">/* read mesh nodes coordinates */</span>
    <span class="keywordflow">if</span> ((coordinates = (<a class="code" href="a00320_ab1eab99ca56ac95ce5b1c0e4ae0f095a.html#ab1eab99ca56ac95ce5b1c0e4ae0f095a">med_float</a>*) malloc(<span class="keyword">sizeof</span>(<a class="code" href="a00320_ab1eab99ca56ac95ce5b1c0e4ae0f095a.html#ab1eab99ca56ac95ce5b1c0e4ae0f095a">med_float</a>)*nnodes*spacedim)) == NULL) {
      <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : memory allocation ...&quot;</span>);
      <span class="keywordflow">goto</span> ERROR;
    }
    
    <span class="keywordflow">if</span> (<a class="code" href="a01011_ga392a4bd4e6d340020755de7353f8a528.html#ga392a4bd4e6d340020755de7353f8a528" title="Cette routine permet de lire dans un maillage le tableau des coordonnées des noeuds...">MEDmeshNodeCoordinateRd</a>(fid, meshname, <a class="code" href="a00321_a8f72b6ceb3b6f5a67f9efd46cb90707a.html#a8f72b6ceb3b6f5a67f9efd46cb90707a">MED_NO_DT</a>, <a class="code" href="a00321_a95919207fd7a18ba26e6e03f04811e3f.html#a95919207fd7a18ba26e6e03f04811e3f">MED_NO_IT</a>, <a class="code" href="a00320_a0ac861d71fe5e0be056a86f9212f1c6a.html#a0ac861d71fe5e0be056a86f9212f1c6aa9a1509b3f93e5915a24f555890c73ee1">MED_FULL_INTERLACE</a>,
                                coordinates) &lt; 0) {
      <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : nodes coordinates ...&quot;</span>);
      free(coordinates);
      <span class="keywordflow">goto</span> ERROR;
    }

    <span class="comment">/* read all MED geometry cell types */</span>
    <span class="keywordflow">for</span> (it=1; it&lt;= <a class="code" href="a00321_abd42d91233c317ca8eb9b592e4502053.html#abd42d91233c317ca8eb9b592e4502053">MED_N_CELL_FIXED_GEO</a>; it++) {   

      geotype = geotypes[it];

      <span class="keywordflow">if</span> ((ngeo = <a class="code" href="a01011_ga45758103360dacf7b8a6c53ebfa4d7e5.html#ga45758103360dacf7b8a6c53ebfa4d7e5" title="Cette routine permet de lire le nombre d&amp;#39;entités dans un maillage pour une séquence...">MEDmeshnEntity</a>(fid, meshname, <a class="code" href="a00321_a8f72b6ceb3b6f5a67f9efd46cb90707a.html#a8f72b6ceb3b6f5a67f9efd46cb90707a">MED_NO_DT</a>, <a class="code" href="a00321_a95919207fd7a18ba26e6e03f04811e3f.html#a95919207fd7a18ba26e6e03f04811e3f">MED_NO_IT</a>, <a class="code" href="a00321_aab0e957294723517d5c3641bb71b0470.html#aab0e957294723517d5c3641bb71b0470a227d14957ec5f221685cb1d6ec3b6c67">MED_CELL</a>,geotype,
                                 <a class="code" href="a00321_a25ee4b3675737fc23511b28b3245c61b.html#a25ee4b3675737fc23511b28b3245c61bac845229e0179819897411d7cb9186824">MED_CONNECTIVITY</a>, <a class="code" href="a00321_afcd26ca66a179b9aa82f5c90602c4ed8.html#afcd26ca66a179b9aa82f5c90602c4ed8a4ae92e7de0898383577cbba640006baa">MED_NODAL</a>, &amp;coordinatechangement,
                                 &amp;geotransformation)) &lt; 0) {
        <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : number of cell ...&quot;</span>);
        <a class="code" href="a00348_a818470a84d2ad18a3fbb48170296cd95.html#a818470a84d2ad18a3fbb48170296cd95">ISCRUTE</a>(geotype);
        <span class="keywordflow">goto</span> ERROR;
      }
    
      <span class="keywordflow">if</span> (ngeo) {
        <span class="comment">/* read cells connectivity in the mesh */</span>
        <span class="keywordflow">if</span> ((connectivity = (<a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> *) malloc(<span class="keyword">sizeof</span>(<a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a>)*ngeo*(geotype%100))) == NULL) {
          <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : memory allocation ...&quot;</span>);
          <span class="keywordflow">goto</span> ERROR;
        }
        
        <span class="keywordflow">if</span> (<a class="code" href="a01011_ga014f716ad13c72466b4aa94237876bf5.html#ga014f716ad13c72466b4aa94237876bf5" title="Cette routine permet de lire dans un maillage le tableau des connectivités pour...">MEDmeshElementConnectivityRd</a>(fid, meshname, <a class="code" href="a00321_a8f72b6ceb3b6f5a67f9efd46cb90707a.html#a8f72b6ceb3b6f5a67f9efd46cb90707a">MED_NO_DT</a>, <a class="code" href="a00321_a95919207fd7a18ba26e6e03f04811e3f.html#a95919207fd7a18ba26e6e03f04811e3f">MED_NO_IT</a>, <a class="code" href="a00321_aab0e957294723517d5c3641bb71b0470.html#aab0e957294723517d5c3641bb71b0470a227d14957ec5f221685cb1d6ec3b6c67">MED_CELL</a>,
                                         geotype, <a class="code" href="a00321_afcd26ca66a179b9aa82f5c90602c4ed8.html#afcd26ca66a179b9aa82f5c90602c4ed8a4ae92e7de0898383577cbba640006baa">MED_NODAL</a>, <a class="code" href="a00320_a0ac861d71fe5e0be056a86f9212f1c6a.html#a0ac861d71fe5e0be056a86f9212f1c6aa9a1509b3f93e5915a24f555890c73ee1">MED_FULL_INTERLACE</a>, connectivity) &lt; 0) {
          <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : cellconnectivity ...&quot;</span>);
          <a class="code" href="a00348_a818470a84d2ad18a3fbb48170296cd95.html#a818470a84d2ad18a3fbb48170296cd95">ISCRUTE</a>(geotype);
          free(connectivity);
          <span class="keywordflow">goto</span> ERROR;
        }

        <span class="comment">/* memory deallocation */</span>
        free(connectivity);
        connectivity = NULL;
      }
    }
    

    <span class="comment">/* read nodes coordinates changements step by step */</span>
    <span class="keywordflow">for</span> (it=1;it&lt;nstep;it++) {
      
      <span class="keywordflow">if</span> (<a class="code" href="a01011_ga3faa1e7f284f59b74778ad5db9c00c95.html#ga3faa1e7f284f59b74778ad5db9c00c95" title="Cette routine permet de lire les informations relatives à une séquence de calcul...">MEDmeshComputationStepInfo</a>(fid, meshname, it+1, 
                                     &amp;numdt, &amp;numit, &amp;dt) &lt; 0) {
        <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : Computing step info ...&quot;</span>);
        <a class="code" href="a00348_a257959db0a78623caa051d11ceb2f8cb.html#a257959db0a78623caa051d11ceb2f8cb">SSCRUTE</a>(meshname);
        <span class="keywordflow">goto</span> ERROR;
      }
      
      <span class="comment">/* test changement : for nodes coordinates */</span>
      <span class="keywordflow">if</span> ((nnodes = <a class="code" href="a01011_ga2b875dddcf5922d6143c72cb1e0924cf.html#ga2b875dddcf5922d6143c72cb1e0924cf" title="Cette routine permet de lire le nombre d&amp;#39;entités dans un maillage pour une séquence...">MEDmeshnEntityWithProfile</a>(fid, meshname, numdt, numit, 
                                              <a class="code" href="a00321_aab0e957294723517d5c3641bb71b0470.html#aab0e957294723517d5c3641bb71b0470a074507163b07b6d764823a78c5c07f0f">MED_NODE</a>, <a class="code" href="a00321_a9a2843c7d6eacffdd9377b5bfb8a6de3.html#a9a2843c7d6eacffdd9377b5bfb8a6de3">MED_NONE</a>,
                                              <a class="code" href="a00321_a25ee4b3675737fc23511b28b3245c61b.html#a25ee4b3675737fc23511b28b3245c61bad78949eab3c743083dfbf687c92bbdcb">MED_COORDINATE</a>, <a class="code" href="a00321_afcd26ca66a179b9aa82f5c90602c4ed8.html#afcd26ca66a179b9aa82f5c90602c4ed8a2b1e772016688b78b808e96a44d1ee02">MED_NO_CMODE</a>,
                                              <a class="code" href="a00321_a3f7b3a3c5ddcaba3fa1741a367503c8d.html#a3f7b3a3c5ddcaba3fa1741a367503c8da56cfcdcbbab7ddfc577de288697cd291">MED_GLOBAL_PFLMODE</a>, profilename, &amp;profilesize,
                                              &amp;coordinatechangement, &amp;geotransformation)) &lt; 0) {
        <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : number of nodes ...&quot;</span>); 
        <span class="keywordflow">goto</span> ERROR;
      }
      
      <span class="comment">/* if only coordinates have changed, then read the new coordinates */</span>
      <span class="keywordflow">if</span> (coordinatechangement &amp;&amp; geotransformation) {  
        <span class="keywordflow">if</span> (<a class="code" href="a01011_ga069faade0b33a1d245a20160e7f33ce5.html#ga069faade0b33a1d245a20160e7f33ce5" title="Cette routine permet de lire dans un maillage le tableau des coordonnées des noeuds...">MEDmeshNodeCoordinateWithProfileRd</a>(fid, meshname, numdt, numit, 
                                               <a class="code" href="a00321_a3f7b3a3c5ddcaba3fa1741a367503c8d.html#a3f7b3a3c5ddcaba3fa1741a367503c8da56cfcdcbbab7ddfc577de288697cd291">MED_GLOBAL_PFLMODE</a>,profilename,
                                               <a class="code" href="a00320_a0ac861d71fe5e0be056a86f9212f1c6a.html#a0ac861d71fe5e0be056a86f9212f1c6aa9a1509b3f93e5915a24f555890c73ee1">MED_FULL_INTERLACE</a>,<a class="code" href="a00321_a65a18ab6db672a2d21312d1813a3bb19.html#a65a18ab6db672a2d21312d1813a3bb19">MED_ALL_CONSTITUENT</a>,
                                               coordinates) &lt; 0) {
          <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : nodes coordinates ...&quot;</span>);
          free(coordinates);
          <span class="keywordflow">goto</span> ERROR;
        }
      }

      <span class="keywordflow">if</span> (coordinatechangement &amp;&amp; ! geotransformation) {        

        matrixsize = <a class="code" href="a01011_ga45758103360dacf7b8a6c53ebfa4d7e5.html#ga45758103360dacf7b8a6c53ebfa4d7e5" title="Cette routine permet de lire le nombre d&amp;#39;entités dans un maillage pour une séquence...">MEDmeshnEntity</a>(fid,meshname,numdt,numit,
                                    <a class="code" href="a00321_aab0e957294723517d5c3641bb71b0470.html#aab0e957294723517d5c3641bb71b0470a074507163b07b6d764823a78c5c07f0f">MED_NODE</a>,<a class="code" href="a00321_a9a2843c7d6eacffdd9377b5bfb8a6de3.html#a9a2843c7d6eacffdd9377b5bfb8a6de3">MED_NONE</a>,<a class="code" href="a00321_a25ee4b3675737fc23511b28b3245c61b.html#a25ee4b3675737fc23511b28b3245c61ba883b42694f7b0c829a27c20ad7483588">MED_COORDINATE_TRSF</a>,<a class="code" href="a00321_afcd26ca66a179b9aa82f5c90602c4ed8.html#afcd26ca66a179b9aa82f5c90602c4ed8a4ae92e7de0898383577cbba640006baa">MED_NODAL</a>,&amp;coordinatechangement, 
                                    &amp;matrixtransformation);
        
        <span class="keywordflow">if</span> (matrixsize &lt; 0) {
          <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : matrix transformation ...&quot;</span>);
          <span class="keywordflow">goto</span> ERROR;
        }
                
        <span class="keywordflow">if</span> (matrixtransformation) {
          <span class="keywordflow">if</span> ( <a class="code" href="a01011_ga7c511c6150325e5274781e1234ce043e.html#ga7c511c6150325e5274781e1234ce043e" title="Cette routine lit les paramètres de translation rotation à appliquer aux noeuds...">MEDmeshNodeCoordinateTrsfRd</a>(fid, meshname, numdt, numit, matrix) &lt; 0 ) {
            <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : read transformation matrix ...&quot;</span>);
            <span class="keywordflow">goto</span> ERROR;
          }
        }
      }
    }
  }
  free(coordinates);

  ret=0;
 ERROR:

  <span class="comment">/* close MED file */</span>
  <span class="keywordflow">if</span> (<a class="code" href="a01005_ga12a0e901c376be997a41a073ce426283.html#ga12a0e901c376be997a41a073ce426283" title="Fermeture d&amp;#39;un fichier MED.">MEDfileClose</a>(fid) &lt; 0) {
    <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : close file&quot;</span>);             
    ret=-1; 
  } 

  
  <span class="keywordflow">return</span> ret;
}

</pre></div> <h3><a class="anchor" id="4."></a>Cr&eacute;er et lire une &eacute;quivalence entre les entit&eacute;s d'un maillage</h3>
<p>La notion d'&eacute;quivalence permet de g&eacute;rer des listes de correspondance mettant en relation deux entit&eacute;s de m&ecirc;me type (deux noeuds, deux mailles, deux ar&ecirc;tes ou deux faces).  </p>
<p>Une &eacute;quivalence est identifi&eacute;e par son nom (cha&icirc;ne de <a class="el" href="a00321_a0ae989cbbfeecbb5296b3ceba8dab886.html#a0ae989cbbfeecbb5296b3ceba8dab886">MED_NAME_SIZE</a> caract&egrave;res) et poss&egrave;de &eacute;galement une description (cha&icirc;ne d'au plus <a class="el" href="a00321_ab69710ecf9f5257080a943579852d0f0.html#ab69710ecf9f5257080a943579852d0f0">MED_COMMENT_SIZE</a>). La routine <a class="el" href="a01002_ga29dda89b8ee21c695d3bc823b56498d6.html#ga29dda89b8ee21c695d3bc823b56498d6">MEDequivalenceCr</a> / <a class="el" href="a01017_ga714cd2d9b5e681645022e227a0eee1aa.html#ga714cd2d9b5e681645022e227a0eee1aa">meqcre</a> permet de cr&eacute;er une &eacute;quivalence. L'&eacute;criture des &eacute;quivalences est optionnelle : un fichier peut contenir de z&eacute;ro &agrave; plusieurs &eacute;quivalences. Une fois l'&eacute;quivalence cr&eacute;&eacute;e, il s'agit de lui associer des tableaux de correspondances entre les entit&eacute;s souhait&eacute;es. La routine <a class="el" href="a01002_ga6b614eb87b395eee93eebb99d29ecb84.html#ga6b614eb87b395eee93eebb99d29ecb84">MEDequivalenceCorrespondenceWr</a> / <a class="el" href="a01017_ga71cde7e41d1b7f5b26b2d38b6cacf40a.html#ga71cde7e41d1b7f5b26b2d38b6cacf40a">meqcow</a> permet d'&eacute;crire un tableau de correspondance dans une &eacute;quivalence pour un type d'entit&eacute; pour une &eacute;tape d'&eacute;volution du maillage (&lt;MED_NO_DT, MED_NO_IT&gt; par d&eacute;faut). Si cette entit&eacute; correspond &agrave; un &eacute;l&eacute;ment, il faut en plus pr&eacute;ciser le type g&eacute;om&eacute;trique de l'&eacute;l&eacute;ment.  </p>
<p>Les correspondances entre entit&eacute;s sont stock&eacute;es 2 &agrave; 2 en m&eacute;moire dans une &eacute;quivalence : ainsi dans l'exemple suivant, le tableau de correspondances suivant {1,2,3,4,5,6} appliqu&eacute; &agrave; des entit&eacute;s de type MED_TRIA3 (triangle &agrave; 3 noeuds), signifie qu'on a les 3 correspondances suivantes : entre le triangle num&eacute;ro 1 et le triangle num&eacute;ro 2, entre le triangle num&eacute;ro 3 et le triangle num&eacute;ro 4, entre le triangle num&eacute;ro 5 et le triangle num&eacute;ro 6.  </p>
<div class="fragment"><pre class="fragment"><span class="comment">/*  This file is part of MED.</span>
<span class="comment"> *</span>
<span class="comment"> *  COPYRIGHT (C) 1999 - 2012  EDF R&amp;D, CEA/DEN</span>
<span class="comment"> *  MED is free software: you can redistribute it and/or modify</span>
<span class="comment"> *  it under the terms of the GNU Lesser General Public License as published by</span>
<span class="comment"> *  the Free Software Foundation, either version 3 of the License, or</span>
<span class="comment"> *  (at your option) any later version.</span>
<span class="comment"> *</span>
<span class="comment"> *  MED is distributed in the hope that it will be useful,</span>
<span class="comment"> *  but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="comment"> *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<span class="comment"> *  GNU Lesser General Public License for more details.</span>
<span class="comment"> *</span>
<span class="comment"> *  You should have received a copy of the GNU Lesser General Public License</span>
<span class="comment"> *  along with MED.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span>
<span class="comment"> */</span>

<span class="comment">/******************************************************************************</span>
<span class="comment"> * - Nom du fichier : test12.c</span>
<span class="comment"> *</span>
<span class="comment"> * - Description : ecriture d&apos;une equivalence dans un maillage MED </span>
<span class="comment"> *</span>
<span class="comment"> *****************************************************************************/</span>

<span class="preprocessor">#include &lt;med.h&gt;</span>
<span class="preprocessor">#define MESGERR 1</span>
<span class="preprocessor"></span><span class="preprocessor">#include &lt;med_utils.h&gt;</span>

<span class="preprocessor">#ifdef DEF_LECT_ECR</span>
<span class="preprocessor"></span><span class="preprocessor">#define MODE_ACCES MED_ACC_RDWR</span>
<span class="preprocessor"></span><span class="preprocessor">#elif DEF_LECT_AJOUT</span>
<span class="preprocessor"></span><span class="preprocessor">#define MODE_ACCES MED_ACC_RDEXT</span>
<span class="preprocessor"></span><span class="preprocessor">#else</span>
<span class="preprocessor"></span><span class="preprocessor">#define MODE_ACCES MED_ACC_CREAT</span>
<span class="preprocessor"></span><span class="preprocessor">#endif</span>
<span class="preprocessor"></span>
<span class="keywordtype">int</span> <a class="code" href="a00750_a3c04138a5bfe5d72780bb7e82a18e627.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a> (<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> **argv)


{
  <a class="code" href="a00320_afa4ec8284026c8c5545e5333475fb65a.html#afa4ec8284026c8c5545e5333475fb65a">med_idt</a> fid;
  <span class="keywordtype">char</span> maa[<a class="code" href="a00321_a0ae989cbbfeecbb5296b3ceba8dab886.html#a0ae989cbbfeecbb5296b3ceba8dab886">MED_NAME_SIZE</a>+1]= <span class="stringliteral">&quot;maa1&quot;</span>;
  <span class="keywordtype">char</span> equ[<a class="code" href="a00321_a0ae989cbbfeecbb5296b3ceba8dab886.html#a0ae989cbbfeecbb5296b3ceba8dab886">MED_NAME_SIZE</a>+1] = <span class="stringliteral">&quot;equivalence&quot;</span>;
  <span class="keywordtype">char</span> des[<a class="code" href="a00321_ab69710ecf9f5257080a943579852d0f0.html#ab69710ecf9f5257080a943579852d0f0">MED_COMMENT_SIZE</a>+1] = <span class="stringliteral">&quot;equivalence sur les mailles MED_TRIA3&quot;</span>;
  <a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> mdim = 3;
  <a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> ncor = 3;
  <a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> cor[6] = {1,2,3,4,5,6};
  <span class="keywordtype">char</span>    nomcoo[3*<a class="code" href="a00321_a213ecd1a546eb96092b980a870bc386b.html#a213ecd1a546eb96092b980a870bc386b">MED_SNAME_SIZE</a>+1] = <span class="stringliteral">&quot;x               y               z               &quot;</span>;
  <span class="keywordtype">char</span>    unicoo[3*<a class="code" href="a00321_a213ecd1a546eb96092b980a870bc386b.html#a213ecd1a546eb96092b980a870bc386b">MED_SNAME_SIZE</a>+1] = <span class="stringliteral">&quot;cm              cm              cm              &quot;</span>;


  <span class="comment">/* Creation du fichier &quot;test12.med&quot; */</span>
  <span class="keywordflow">if</span> ((fid = <a class="code" href="a01005_ga9376a1654b7bf099c3f8941074c5fdfb.html#ga9376a1654b7bf099c3f8941074c5fdfb" title="Ouverture d&amp;#39;un fichier MED.">MEDfileOpen</a>(<span class="stringliteral">&quot;test12.med&quot;</span>,<a class="code" href="a00750_a29a43500a889d39744e184ece0d749be.html#a29a43500a889d39744e184ece0d749be">MODE_ACCES</a>)) &lt; 0) {
    <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;Erreur a la creation du fichier test12.med&quot;</span>);
    <span class="keywordflow">return</span> -1;
  }

  <span class="keywordflow">if</span> (<a class="code" href="a01011_ga6007c3f1a62732e7a46c5eca232be78a.html#ga6007c3f1a62732e7a46c5eca232be78a" title="Cette routine permet de créer un maillage dans un fichier.">MEDmeshCr</a>( fid, maa, 3, 3, <a class="code" href="a00321_a821a4dd94c5c6b095318432bdec8d8a1.html#a821a4dd94c5c6b095318432bdec8d8a1a3719e53a4838d222f0a58148292fda41">MED_UNSTRUCTURED_MESH</a>,
                 <span class="stringliteral">&quot;un maillage pour test12&quot;</span>,<span class="stringliteral">&quot;s&quot;</span>, <a class="code" href="a00321_a5b97067a30629cd60470d074691d6798.html#a5b97067a30629cd60470d074691d6798ae896b6adfbde9870b4e875e5167eddd0">MED_SORT_DTIT</a>,
                 <a class="code" href="a00321_a57867e4bed1d104c865cfc9d23c9204d.html#a57867e4bed1d104c865cfc9d23c9204da682ef7f1042079519664eae87f90297e">MED_CARTESIAN</a>, nomcoo, unicoo) &lt; 0) {
    <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;Erreur a la creation du maillage : &quot;</span>); <a class="code" href="a00348_a257959db0a78623caa051d11ceb2f8cb.html#a257959db0a78623caa051d11ceb2f8cb">SSCRUTE</a>(maa);
    <span class="keywordflow">return</span> -1;
  }

  <span class="comment">/* Creation de l&apos;equivalence */</span>
  <span class="keywordflow">if</span> (<a class="code" href="a01002_ga29dda89b8ee21c695d3bc823b56498d6.html#ga29dda89b8ee21c695d3bc823b56498d6" title="Cette routine permet la création d&amp;#39;une équivalence portant sur les entités...">MEDequivalenceCr</a>(fid,maa,equ,des) &lt; 0) {
    <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;Erreur a la creation de l&apos;equivalence&quot;</span>);
    <span class="keywordflow">return</span> -1;
  }

  <span class="comment">/* Ecriture des sur les mailles MED_TRIA3 */</span>
  <span class="keywordflow">if</span> (<a class="code" href="a01002_ga6b614eb87b395eee93eebb99d29ecb84.html#ga6b614eb87b395eee93eebb99d29ecb84" title="Cette routine permet d&amp;#39;écrire un tableau de correspondances entre les entités...">MEDequivalenceCorrespondenceWr</a>(fid,maa,equ,<a class="code" href="a00321_a8f72b6ceb3b6f5a67f9efd46cb90707a.html#a8f72b6ceb3b6f5a67f9efd46cb90707a">MED_NO_DT</a>,<a class="code" href="a00321_a95919207fd7a18ba26e6e03f04811e3f.html#a95919207fd7a18ba26e6e03f04811e3f">MED_NO_IT</a>,
                                     <a class="code" href="a00321_aab0e957294723517d5c3641bb71b0470.html#aab0e957294723517d5c3641bb71b0470a227d14957ec5f221685cb1d6ec3b6c67">MED_CELL</a>,<a class="code" href="a00321_a4a1eb7ba296742a6f5eb8b5b23b39670.html#a4a1eb7ba296742a6f5eb8b5b23b39670">MED_TRIA3</a>,ncor,cor) &lt; 0) {
    <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;Erreur a l&apos;ecriture du tableau des correspondances&quot;</span>);
    <span class="keywordflow">return</span> -1;
  }
  <span class="comment">/* Fermeture du fichier */</span>
  <span class="keywordflow">if</span> (<a class="code" href="a01005_ga12a0e901c376be997a41a073ce426283.html#ga12a0e901c376be997a41a073ce426283" title="Fermeture d&amp;#39;un fichier MED.">MEDfileClose</a>(fid) &lt; 0) {
    <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;Erreur a la fermeture du fichier&quot;</span>);
    <span class="keywordflow">return</span> -1;
  }

  <span class="keywordflow">return</span> 0;
}




</pre></div> <p>A la lecture, l'acc&egrave;s aux &eacute;quivalences dans un fichier peut se faire via un it&eacute;rateur. La routine <a class="el" href="a01002_ga141a73149854a23b235db0009d54568a.html#ga141a73149854a23b235db0009d54568a">MEDnEquivalence</a> / <a class="el" href="a01017_ga0d0e9aa2b68a9fa2eba636d811021fbc.html#ga0d0e9aa2b68a9fa2eba636d811021fbc">meqneq</a> permet de lire le nombre d'&eacute;quivalence dans un fichier. Il s'agit ensuite d'it&eacute;rer sur toutes les &eacute;quivalences et &agrave; chaque it&eacute;ration : la routine <a class="el" href="a01002_ga095907f3c6186b90e3e0bd3337f5f4b3.html#ga095907f3c6186b90e3e0bd3337f5f4b3">MEDequivalenceInfo</a> / <a class="el" href="a01017_ga8c9298d26896331de56706dddfbeedf3.html#ga8c9298d26896331de56706dddfbeedf3">meqeqi</a> lit les informations relatives &agrave; une &eacute;quivalence (nom, description, nombre d'&eacute;tape d'&eacute;volution du maillage, nombre de correspondance pour l'&eacute;tape par d&eacute;faut &lt;MED_NO_DT,MED_NO_IT&gt;) ; la routine <a class="el" href="a01002_ga3a2ff4642c52826b41f78a337584271a.html#ga3a2ff4642c52826b41f78a337584271a">MEDequivalenceCorrespondenceSize</a> / <a class="el" href="a01017_gab361acdc44d8ab629d6c0a73972698c0.html#gab361acdc44d8ab629d6c0a73972698c0">meqcsz</a> lit le nombre de correspondance par &eacute;tape d'&eacute;volution du maillage ; la routine <a class="el" href="a01002_ga4c612876ec9ff0c398a291be79df540b.html#ga4c612876ec9ff0c398a291be79df540b">MEDequivalenceCorrespondenceRd</a> / <a class="el" href="a01017_ga8168ef8d17b74cf728642f9036c555c5.html#ga8168ef8d17b74cf728642f9036c555c5">meqcor</a> permet de lire un tableau de correspondance pour un type d'entit&eacute; pour une &eacute;tape d'&eacute;volution du maillage. </p>
<p>A noter &eacute;galement l'existence de la routine <a class="el" href="a01002_ga8f0a42049df9f516b3f43848c33838bc.html#ga8f0a42049df9f516b3f43848c33838bc">MEDequivalenceComputingStepInfo</a> / <a class="el" href="a01017_ga24c25697bae26305400669efae7e121c.html#ga24c25697bae26305400669efae7e121c">meqcsi</a> qui permet de lire les informations relatives &agrave; une &eacute;quivalence pour une &eacute;tape d'&eacute;volution du maillage donn&eacute;e. </p>
<p>Le cas d'utilisation suivant propose une lecture g&eacute;n&eacute;rique de toutes les &eacute;quivalences qu'il est possible de trouver dans un fichier MED.  </p>
<div class="fragment"><pre class="fragment"><span class="comment">/*  This file is part of MED.</span>
<span class="comment"> *</span>
<span class="comment"> *  COPYRIGHT (C) 1999 - 2012  EDF R&amp;D, CEA/DEN</span>
<span class="comment"> *  MED is free software: you can redistribute it and/or modify</span>
<span class="comment"> *  it under the terms of the GNU Lesser General Public License as published by</span>
<span class="comment"> *  the Free Software Foundation, either version 3 of the License, or</span>
<span class="comment"> *  (at your option) any later version.</span>
<span class="comment"> *</span>
<span class="comment"> *  MED is distributed in the hope that it will be useful,</span>
<span class="comment"> *  but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="comment"> *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<span class="comment"> *  GNU Lesser General Public License for more details.</span>
<span class="comment"> *</span>
<span class="comment"> *  You should have received a copy of the GNU Lesser General Public License</span>
<span class="comment"> *  along with MED.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span>
<span class="comment"> */</span>

<span class="comment">/******************************************************************************</span>
<span class="comment"> * - Nom du fichier : test13.c</span>
<span class="comment"> *</span>
<span class="comment"> * - Description : lecture des equivalences d&apos;un maillage MED.</span>
<span class="comment"> *</span>
<span class="comment"> *****************************************************************************/</span>

<span class="preprocessor">#include &lt;med.h&gt;</span>
<span class="preprocessor">#define MESGERR 1</span>
<span class="preprocessor"></span><span class="preprocessor">#include &lt;med_utils.h&gt;</span>


<span class="preprocessor">#ifdef DEF_LECT_ECR</span>
<span class="preprocessor"></span><span class="preprocessor">#define MODE_ACCES MED_ACC_RDWR</span>
<span class="preprocessor"></span><span class="preprocessor">#elif DEF_LECT_AJOUT</span>
<span class="preprocessor"></span><span class="preprocessor">#define MODE_ACCES MED_ACC_RDEXT</span>
<span class="preprocessor"></span><span class="preprocessor">#else</span>
<span class="preprocessor"></span><span class="preprocessor">#define MODE_ACCES MED_ACC_CREAT</span>
<span class="preprocessor"></span><span class="preprocessor">#endif</span>
<span class="preprocessor"></span>
<span class="keywordtype">int</span> <a class="code" href="a00750_a3c04138a5bfe5d72780bb7e82a18e627.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a> (<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> **argv)


{
  <a class="code" href="a00320_abd29d7c6abaef5da2a5ed1b73464f0ba.html#abd29d7c6abaef5da2a5ed1b73464f0ba">med_err</a> ret = 0;
  <a class="code" href="a00320_afa4ec8284026c8c5545e5333475fb65a.html#afa4ec8284026c8c5545e5333475fb65a">med_idt</a> fid = 0;
  <span class="keywordtype">char</span>    maa[<a class="code" href="a00321_a0ae989cbbfeecbb5296b3ceba8dab886.html#a0ae989cbbfeecbb5296b3ceba8dab886">MED_NAME_SIZE</a>+1]=<span class="stringliteral">&quot;&quot;</span>;
  <a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> mdim=0,sdim=0;
  <a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> nequ=0,ncor=0,nstep=0,nocstpncor=0;
  <a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> *cor;
  <span class="keywordtype">char</span> equ[<a class="code" href="a00321_a0ae989cbbfeecbb5296b3ceba8dab886.html#a0ae989cbbfeecbb5296b3ceba8dab886">MED_NAME_SIZE</a>+1]   =<span class="stringliteral">&quot;&quot;</span>;
  <span class="keywordtype">char</span> des[<a class="code" href="a00321_ab69710ecf9f5257080a943579852d0f0.html#ab69710ecf9f5257080a943579852d0f0">MED_COMMENT_SIZE</a>+1]=<span class="stringliteral">&quot;&quot;</span>;

  <span class="keywordtype">int</span> i,j,k;
  <a class="code" href="a00321_a821a4dd94c5c6b095318432bdec8d8a1.html#a821a4dd94c5c6b095318432bdec8d8a1">med_mesh_type</a> type;
  <a class="code" href="a00321_a5b97067a30629cd60470d074691d6798.html#a5b97067a30629cd60470d074691d6798">med_sorting_type</a> sort;
  <span class="keywordtype">char</span> desc[<a class="code" href="a00321_ab69710ecf9f5257080a943579852d0f0.html#ab69710ecf9f5257080a943579852d0f0">MED_COMMENT_SIZE</a>+1];
  <span class="keywordtype">char</span> dtunit[<a class="code" href="a00321_a213ecd1a546eb96092b980a870bc386b.html#a213ecd1a546eb96092b980a870bc386b">MED_SNAME_SIZE</a>+1]=<span class="stringliteral">&quot;&quot;</span>;
  <span class="keywordtype">char</span> nomcoo[3*<a class="code" href="a00321_a213ecd1a546eb96092b980a870bc386b.html#a213ecd1a546eb96092b980a870bc386b">MED_SNAME_SIZE</a>+1];
  <span class="keywordtype">char</span> unicoo[3*<a class="code" href="a00321_a213ecd1a546eb96092b980a870bc386b.html#a213ecd1a546eb96092b980a870bc386b">MED_SNAME_SIZE</a>+1];
  <a class="code" href="a00321_a57867e4bed1d104c865cfc9d23c9204d.html#a57867e4bed1d104c865cfc9d23c9204d">med_axis_type</a> rep;

  <a class="code" href="a00321_a1043613afc3cd2e24785dfc7c0452ab8.html#a1043613afc3cd2e24785dfc7c0452ab8">med_geometry_type</a> *<a class="code" href="a00318_a23177e52deed15ecdc7cd7642dbc7ba6.html#a23177e52deed15ecdc7cd7642dbc7ba6">typmai</a> = <a class="code" href="a00499_a54c2e34174a890046d0a204fa1a918a8.html#a54c2e34174a890046d0a204fa1a918a8">MED_GET_CELL_GEOMETRY_TYPE</a>;
  <a class="code" href="a00321_a1043613afc3cd2e24785dfc7c0452ab8.html#a1043613afc3cd2e24785dfc7c0452ab8">med_geometry_type</a> *<a class="code" href="a00318_a4447d14196935d212b710dc4107d24fc.html#a4447d14196935d212b710dc4107d24fc">typfac</a> = <a class="code" href="a00499_afd26706c57b29262890b417e48a360e6.html#afd26706c57b29262890b417e48a360e6">MED_GET_FACE_GEOMETRY_TYPE</a>;
  <a class="code" href="a00321_a1043613afc3cd2e24785dfc7c0452ab8.html#a1043613afc3cd2e24785dfc7c0452ab8">med_geometry_type</a> *<a class="code" href="a00318_a53ebfab5f817eb092b89fc5883d08906.html#a53ebfab5f817eb092b89fc5883d08906">typare</a> = <a class="code" href="a00499_a824a6a6383128fcc9df409d0d12cfef0.html#a824a6a6383128fcc9df409d0d12cfef0">MED_GET_EDGE_GEOMETRY_TYPE</a>;

  <span class="keywordflow">if</span> (argc != 2) {
    <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;Il faut passer un fichier MED en paramètre&quot;</span>);
    <span class="keywordflow">return</span> -1;
  }

  <span class="comment">/* Ouverture du fichier passe en argument en lecture seule */</span>
  <span class="keywordflow">if</span> ((fid = <a class="code" href="a01005_ga9376a1654b7bf099c3f8941074c5fdfb.html#ga9376a1654b7bf099c3f8941074c5fdfb" title="Ouverture d&amp;#39;un fichier MED.">MEDfileOpen</a>(argv[1],<a class="code" href="a00321_adcd0322de9fec3b5e199ffeda3f44c85.html#adcd0322de9fec3b5e199ffeda3f44c85a616bf8345c622a34f0787f42eb400f25">MED_ACC_RDONLY</a>)) &lt; 0) {
    <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;Erreur a l&apos;ouverture du fichier : &quot;</span>); <a class="code" href="a00348_a257959db0a78623caa051d11ceb2f8cb.html#a257959db0a78623caa051d11ceb2f8cb">SSCRUTE</a>(argv[1]);
    <span class="keywordflow">return</span> -1;
  }

  <span class="keywordflow">if</span> ((sdim=<a class="code" href="a01011_gad36ab4651405ed8542fb2a63e2fc44da.html#gad36ab4651405ed8542fb2a63e2fc44da" title="Cette routine permet de lire dans un maillage le nombre d&amp;#39;axes du repère des...">MEDmeshnAxis</a>(fid, 1)) &lt;0) {
    <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;Erreur a la lecture de la dimension de l&apos;espace du maillage :&quot;</span>);
    <a class="code" href="a00348_a257959db0a78623caa051d11ceb2f8cb.html#a257959db0a78623caa051d11ceb2f8cb">SSCRUTE</a>(maa);
    <span class="keywordflow">return</span> -1;
  }

  <span class="comment">/* Lecture des infos concernant le premier maillage */</span>
  <span class="keywordflow">if</span> ( <a class="code" href="a01011_ga71e0d79fbb40abdc9c20bc5be01441ac.html#ga71e0d79fbb40abdc9c20bc5be01441ac" title="Cette routine permet de lire les informations relatives à un maillage dans un fichier...">MEDmeshInfo</a>( fid, 1,  maa, &amp;sdim, &amp;mdim, &amp;type, desc, dtunit, &amp;sort,
                    &amp;nstep,  &amp;rep, nomcoo,unicoo) &lt; 0 ) {
    <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;Erreur a la lecture des informations sur le maillage : &quot;</span>);<a class="code" href="a00348_a257959db0a78623caa051d11ceb2f8cb.html#a257959db0a78623caa051d11ceb2f8cb">SSCRUTE</a>(maa);
    <span class="keywordflow">return</span> -1;
  } <span class="keywordflow">else</span> {
    printf(<span class="stringliteral">&quot;Maillage de nom : |%s| , de dimension : &quot;</span>IFORMAT<span class="stringliteral">&quot; , et de type %d\n&quot;</span>,maa,mdim,type);
    printf(<span class="stringliteral">&quot;\t -Dimension de l&apos;espace : &quot;</span>IFORMAT<span class="stringliteral">&quot;\n&quot;</span>,sdim);
    printf(<span class="stringliteral">&quot;\t -Description du maillage : %s\n&quot;</span>,desc);
    printf(<span class="stringliteral">&quot;\t -Noms des axes : |%s|\n&quot;</span>,nomcoo);
    printf(<span class="stringliteral">&quot;\t -Unités des axes : |%s|\n&quot;</span>,unicoo);
    printf(<span class="stringliteral">&quot;\t -Type de repère : %d\n&quot;</span>,rep);
    printf(<span class="stringliteral">&quot;\t -Nombre d&apos;étapes de calcul : &quot;</span>IFORMAT<span class="stringliteral">&quot;\n&quot;</span>,nstep);
    printf(<span class="stringliteral">&quot;\t -Unité des dates : |%s|\n&quot;</span>,dtunit);
  }

  <span class="comment">/* Lecture du nombre d&apos;equivalence */</span>
  <span class="keywordflow">if</span> ((nequ = <a class="code" href="a01002_ga141a73149854a23b235db0009d54568a.html#ga141a73149854a23b235db0009d54568a" title="Cette routine permet de lire le nombre d&amp;#39;équivalence dans un fichier.">MEDnEquivalence</a>(fid,maa)) &lt; 0) {
    <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;Erreur a la lecture du nombre d&apos;equivalence&quot;</span>);
    <span class="keywordflow">return</span> -1;
  }
  printf(<span class="stringliteral">&quot;Nombre d&apos;equivalences : &quot;</span>IFORMAT<span class="stringliteral">&quot; \n&quot;</span>,nequ);

  <span class="comment">/* Lecture de toutes les equivalences du maillage */</span>
  <span class="keywordflow">if</span> (nequ &gt; 0)
    <span class="keywordflow">for</span> (i = 0;i&lt;nequ;i++) {
      printf(<span class="stringliteral">&quot;Equivalence numero : %d \n&quot;</span>,i+1);

      <span class="comment">/* Lecture des infos sur l&apos;equivalence */</span>
      <span class="keywordflow">if</span> (<a class="code" href="a01002_ga095907f3c6186b90e3e0bd3337f5f4b3.html#ga095907f3c6186b90e3e0bd3337f5f4b3" title="Cette routine permet lire les informations d&amp;#39;une équivalence portant sur les...">MEDequivalenceInfo</a>(fid,maa,i+1,equ,des,&amp;nstep,&amp;nocstpncor) &lt; 0) {
        <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;Erreur a la lecture de l&apos;equivalence d&apos;indice&quot;</span>);
        <a class="code" href="a00348_ae7ba0433e91c450cd44c3808c2acb497.html#ae7ba0433e91c450cd44c3808c2acb497">ISCRUTE_int</a>(i+1);
        <span class="keywordflow">return</span> -1;
      }
      printf(<span class="stringliteral">&quot;Nom de l&apos;equivalence: |%s| \n&quot;</span>,equ);
      printf(<span class="stringliteral">&quot;Description de l&apos;equivalence : |%s| \n&quot;</span>,des);
      printf(<span class="stringliteral">&quot;Nombre d&apos;étapes de calcul : &quot;</span>IFORMAT<span class="stringliteral">&quot; \n&quot;</span>,nstep);
      printf(<span class="stringliteral">&quot;Nombre de correspondances pour l&apos;étape de calcul MED_NO_DT,MED_NO_IT : &quot;</span>IFORMAT<span class="stringliteral">&quot; \n&quot;</span>,nocstpncor);

      <span class="comment">/* Lecture des correspondances sur les differents types d&apos;entites */</span>

      <span class="comment">/* Les noeuds */</span>
      <span class="keywordflow">if</span> ( <a class="code" href="a01002_ga3a2ff4642c52826b41f78a337584271a.html#ga3a2ff4642c52826b41f78a337584271a" title="Cette routine permet de lire le nombre de correspondances dans une équivalence pour...">MEDequivalenceCorrespondenceSize</a>(fid,maa,equ,<a class="code" href="a00321_a8f72b6ceb3b6f5a67f9efd46cb90707a.html#a8f72b6ceb3b6f5a67f9efd46cb90707a">MED_NO_DT</a>,<a class="code" href="a00321_a95919207fd7a18ba26e6e03f04811e3f.html#a95919207fd7a18ba26e6e03f04811e3f">MED_NO_IT</a>,<a class="code" href="a00321_aab0e957294723517d5c3641bb71b0470.html#aab0e957294723517d5c3641bb71b0470a074507163b07b6d764823a78c5c07f0f">MED_NODE</a>,<a class="code" href="a00321_a9a2843c7d6eacffdd9377b5bfb8a6de3.html#a9a2843c7d6eacffdd9377b5bfb8a6de3">MED_NONE</a>,&amp;ncor) &lt; 0) {
        <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;Erreur a la lecture du nombre de correspondance sur les noeuds&quot;</span>);
        <span class="keywordflow">return</span> -1;
      }
      printf(<span class="stringliteral">&quot;Il y a &quot;</span>IFORMAT<span class="stringliteral">&quot; correspondances sur les noeuds \n&quot;</span>,ncor);
      <span class="keywordflow">if</span> (ncor &gt; 0) {
        cor = (<a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a>*) malloc(<span class="keyword">sizeof</span>(<a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a>)*ncor*2);
        <span class="keywordflow">if</span> (<a class="code" href="a01002_ga4c612876ec9ff0c398a291be79df540b.html#ga4c612876ec9ff0c398a291be79df540b" title="Cette routine permet de lire un tableau de correspondances entre les entités d&amp;#39;un...">MEDequivalenceCorrespondenceRd</a>(fid,maa,equ,<a class="code" href="a00321_a8f72b6ceb3b6f5a67f9efd46cb90707a.html#a8f72b6ceb3b6f5a67f9efd46cb90707a">MED_NO_DT</a>,<a class="code" href="a00321_a95919207fd7a18ba26e6e03f04811e3f.html#a95919207fd7a18ba26e6e03f04811e3f">MED_NO_IT</a>,
                                           <a class="code" href="a00321_aab0e957294723517d5c3641bb71b0470.html#aab0e957294723517d5c3641bb71b0470a074507163b07b6d764823a78c5c07f0f">MED_NODE</a>,<a class="code" href="a00321_a9a2843c7d6eacffdd9377b5bfb8a6de3.html#a9a2843c7d6eacffdd9377b5bfb8a6de3">MED_NONE</a>,cor) &lt; 0) {
          <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;Erreur a la lecture des correspondances sur les noeuds&quot;</span>);
          ret = -1;
        }
        <span class="keywordflow">if</span> (ret == 0)
          <span class="keywordflow">for</span> (j=0;j&lt;ncor;j++)
            printf(<span class="stringliteral">&quot;Correspondance %d : &quot;</span>IFORMAT<span class="stringliteral">&quot; et &quot;</span>IFORMAT<span class="stringliteral">&quot; \n&quot;</span>,j+1,*(cor+2*j),
                   *(cor+2*j+1));
        free(cor);
      }

      <span class="comment">/* Les mailles : on ne prend pas en compte les mailles 3D */</span>
      <span class="keywordflow">if</span> (ret == 0)
        <span class="keywordflow">for</span> (j=1;j&lt;=<a class="code" href="a00321_abd42d91233c317ca8eb9b592e4502053.html#abd42d91233c317ca8eb9b592e4502053">MED_N_CELL_FIXED_GEO</a>;j++) {

          <span class="keywordflow">if</span> ( <a class="code" href="a01002_ga3a2ff4642c52826b41f78a337584271a.html#ga3a2ff4642c52826b41f78a337584271a" title="Cette routine permet de lire le nombre de correspondances dans une équivalence pour...">MEDequivalenceCorrespondenceSize</a>(fid,maa,equ,<a class="code" href="a00321_a8f72b6ceb3b6f5a67f9efd46cb90707a.html#a8f72b6ceb3b6f5a67f9efd46cb90707a">MED_NO_DT</a>,<a class="code" href="a00321_a95919207fd7a18ba26e6e03f04811e3f.html#a95919207fd7a18ba26e6e03f04811e3f">MED_NO_IT</a>,<a class="code" href="a00321_aab0e957294723517d5c3641bb71b0470.html#aab0e957294723517d5c3641bb71b0470a227d14957ec5f221685cb1d6ec3b6c67">MED_CELL</a>,typmai[j],&amp;ncor) &lt; 0) {
            <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;Erreur a la lecture du nombre de correspondance sur les mailles : &quot;</span>);
            <a class="code" href="a00348_a257959db0a78623caa051d11ceb2f8cb.html#a257959db0a78623caa051d11ceb2f8cb">SSCRUTE</a>(<a class="code" href="a00499_af132d1ce1d5887f7a690eae70010a9e6.html#af132d1ce1d5887f7a690eae70010a9e6">MED_GET_CELL_GEOMETRY_TYPENAME</a>[j]);
            <span class="keywordflow">return</span> -1;
          }
          printf(<span class="stringliteral">&quot;Il y a &quot;</span>IFORMAT<span class="stringliteral">&quot; correspondances sur les mailles %s \n&quot;</span>,ncor,
                 <a class="code" href="a00499_af132d1ce1d5887f7a690eae70010a9e6.html#af132d1ce1d5887f7a690eae70010a9e6">MED_GET_CELL_GEOMETRY_TYPENAME</a>[j]);
          <span class="keywordflow">if</span> (ncor &gt; 0) {
            cor = (<a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a>*) malloc(<span class="keyword">sizeof</span>(<a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a>)*ncor*2);
            <span class="keywordflow">if</span> (<a class="code" href="a01002_ga4c612876ec9ff0c398a291be79df540b.html#ga4c612876ec9ff0c398a291be79df540b" title="Cette routine permet de lire un tableau de correspondances entre les entités d&amp;#39;un...">MEDequivalenceCorrespondenceRd</a>(fid,maa,equ,<a class="code" href="a00321_a8f72b6ceb3b6f5a67f9efd46cb90707a.html#a8f72b6ceb3b6f5a67f9efd46cb90707a">MED_NO_DT</a>,<a class="code" href="a00321_a95919207fd7a18ba26e6e03f04811e3f.html#a95919207fd7a18ba26e6e03f04811e3f">MED_NO_IT</a>,
                                               <a class="code" href="a00321_aab0e957294723517d5c3641bb71b0470.html#aab0e957294723517d5c3641bb71b0470a227d14957ec5f221685cb1d6ec3b6c67">MED_CELL</a>,typmai[j],cor) &lt; 0) {
              <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;Erreur a la lecture des correspondances sur les mailles : &quot;</span>);
              <a class="code" href="a00348_a257959db0a78623caa051d11ceb2f8cb.html#a257959db0a78623caa051d11ceb2f8cb">SSCRUTE</a>(<a class="code" href="a00499_af132d1ce1d5887f7a690eae70010a9e6.html#af132d1ce1d5887f7a690eae70010a9e6">MED_GET_CELL_GEOMETRY_TYPENAME</a>[j]);
              ret = -1;
            }
            <span class="keywordflow">if</span> (ret == 0)
              <span class="keywordflow">for</span> (k=0;k&lt;ncor;k++)
                printf(<span class="stringliteral">&quot;Correspondance %d : &quot;</span>IFORMAT<span class="stringliteral">&quot; et &quot;</span>IFORMAT<span class="stringliteral">&quot; \n&quot;</span>,k+1,*(cor+2*k),
                       *(cor+2*k+1));
            free(cor);
          }
        }

      <span class="comment">/* Les faces */</span>
      <span class="keywordflow">if</span> (ret == 0)
        <span class="keywordflow">for</span> (j=1;j&lt;=<a class="code" href="a00321_ab0fae842b07280cb7fb20f10a68076ee.html#ab0fae842b07280cb7fb20f10a68076ee">MED_N_FACE_FIXED_GEO</a>;j++) {
          <span class="keywordflow">if</span> ( <a class="code" href="a01002_ga3a2ff4642c52826b41f78a337584271a.html#ga3a2ff4642c52826b41f78a337584271a" title="Cette routine permet de lire le nombre de correspondances dans une équivalence pour...">MEDequivalenceCorrespondenceSize</a>(fid,maa,equ,<a class="code" href="a00321_a8f72b6ceb3b6f5a67f9efd46cb90707a.html#a8f72b6ceb3b6f5a67f9efd46cb90707a">MED_NO_DT</a>,<a class="code" href="a00321_a95919207fd7a18ba26e6e03f04811e3f.html#a95919207fd7a18ba26e6e03f04811e3f">MED_NO_IT</a>,
                                                <a class="code" href="a00321_aab0e957294723517d5c3641bb71b0470.html#aab0e957294723517d5c3641bb71b0470a9168c75d6fb79842aeb30740f5146d25">MED_DESCENDING_FACE</a>,typfac[j],&amp;ncor) &lt; 0) {
            <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;Erreur a la lecture du nombre de correspondance sur les faces : &quot;</span>);
            <a class="code" href="a00348_a257959db0a78623caa051d11ceb2f8cb.html#a257959db0a78623caa051d11ceb2f8cb">SSCRUTE</a>(<a class="code" href="a00499_ab2c7c692304448d9b705889ade145e56.html#ab2c7c692304448d9b705889ade145e56">MED_GET_FACE_GEOMETRY_TYPENAME</a>[j]);
            <span class="keywordflow">return</span> -1;
          }
          printf(<span class="stringliteral">&quot;Il y a &quot;</span>IFORMAT<span class="stringliteral">&quot; correspondances sur les faces %s \n&quot;</span>,ncor,
                 <a class="code" href="a00499_ab2c7c692304448d9b705889ade145e56.html#ab2c7c692304448d9b705889ade145e56">MED_GET_FACE_GEOMETRY_TYPENAME</a>[j]);
          <span class="keywordflow">if</span> (ncor &gt; 0) {
            cor = (<a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a>*) malloc(<span class="keyword">sizeof</span>(<a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a>)*ncor*2);
            <span class="keywordflow">if</span> (<a class="code" href="a01002_ga4c612876ec9ff0c398a291be79df540b.html#ga4c612876ec9ff0c398a291be79df540b" title="Cette routine permet de lire un tableau de correspondances entre les entités d&amp;#39;un...">MEDequivalenceCorrespondenceRd</a>(fid,maa,equ,<a class="code" href="a00321_a8f72b6ceb3b6f5a67f9efd46cb90707a.html#a8f72b6ceb3b6f5a67f9efd46cb90707a">MED_NO_DT</a>,<a class="code" href="a00321_a95919207fd7a18ba26e6e03f04811e3f.html#a95919207fd7a18ba26e6e03f04811e3f">MED_NO_IT</a>,
                                               <a class="code" href="a00321_aab0e957294723517d5c3641bb71b0470.html#aab0e957294723517d5c3641bb71b0470a9168c75d6fb79842aeb30740f5146d25">MED_DESCENDING_FACE</a>,typfac[j],cor) &lt; 0) {
              <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;Erreur a la lecture des correspondances sur les faces : &quot;</span>);
              <a class="code" href="a00348_a257959db0a78623caa051d11ceb2f8cb.html#a257959db0a78623caa051d11ceb2f8cb">SSCRUTE</a>(<a class="code" href="a00499_ab2c7c692304448d9b705889ade145e56.html#ab2c7c692304448d9b705889ade145e56">MED_GET_FACE_GEOMETRY_TYPENAME</a>[j]);
              ret = -1;
            }
            <span class="keywordflow">if</span> (ret == 0)
              <span class="keywordflow">for</span> (k=0;k&lt;ncor;k++)
                printf(<span class="stringliteral">&quot;Correspondance %d : &quot;</span>IFORMAT<span class="stringliteral">&quot; et &quot;</span>IFORMAT<span class="stringliteral">&quot; \n&quot;</span>,k+1,*(cor+2*k),
                       *(cor+2*k+1));
            free(cor);
          }
        }

      <span class="comment">/*  Les aretes */</span>
      <span class="keywordflow">if</span> (ret == 0)
        <span class="keywordflow">for</span> (j=1;j&lt;=<a class="code" href="a00321_abc947dde9b1b8982162dde8888a79ab4.html#abc947dde9b1b8982162dde8888a79ab4">MED_N_EDGE_FIXED_GEO</a>;j++) {
          <span class="keywordflow">if</span> ( <a class="code" href="a01002_ga3a2ff4642c52826b41f78a337584271a.html#ga3a2ff4642c52826b41f78a337584271a" title="Cette routine permet de lire le nombre de correspondances dans une équivalence pour...">MEDequivalenceCorrespondenceSize</a>(fid,maa,equ,<a class="code" href="a00321_a8f72b6ceb3b6f5a67f9efd46cb90707a.html#a8f72b6ceb3b6f5a67f9efd46cb90707a">MED_NO_DT</a>,<a class="code" href="a00321_a95919207fd7a18ba26e6e03f04811e3f.html#a95919207fd7a18ba26e6e03f04811e3f">MED_NO_IT</a>,
                                                <a class="code" href="a00321_aab0e957294723517d5c3641bb71b0470.html#aab0e957294723517d5c3641bb71b0470aecea01a443c5512ff49ddba9f992aa0e">MED_DESCENDING_EDGE</a>,typare[j],&amp;ncor) &lt; 0) {
            <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;Erreur a la lecture du nombre de correspondance sur les aretes : &quot;</span>);
            <a class="code" href="a00348_a257959db0a78623caa051d11ceb2f8cb.html#a257959db0a78623caa051d11ceb2f8cb">SSCRUTE</a>(<a class="code" href="a00499_ac7b61e15c064e78b7cec77aeabd7532e.html#ac7b61e15c064e78b7cec77aeabd7532e">MED_GET_EDGE_GEOMETRY_TYPENAME</a>[j]);
            <span class="keywordflow">return</span> -1;
          }
          printf(<span class="stringliteral">&quot;Il y a &quot;</span>IFORMAT<span class="stringliteral">&quot; correspondances sur les aretes %s \n&quot;</span>,ncor,
                 <a class="code" href="a00499_ac7b61e15c064e78b7cec77aeabd7532e.html#ac7b61e15c064e78b7cec77aeabd7532e">MED_GET_EDGE_GEOMETRY_TYPENAME</a>[j]);
          <span class="keywordflow">if</span> (ncor &gt; 0) {
            cor = (<a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a>*) malloc(<span class="keyword">sizeof</span>(<a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a>)*ncor*2);
            <span class="keywordflow">if</span> (<a class="code" href="a01002_ga4c612876ec9ff0c398a291be79df540b.html#ga4c612876ec9ff0c398a291be79df540b" title="Cette routine permet de lire un tableau de correspondances entre les entités d&amp;#39;un...">MEDequivalenceCorrespondenceRd</a>(fid,maa,equ,<a class="code" href="a00321_a8f72b6ceb3b6f5a67f9efd46cb90707a.html#a8f72b6ceb3b6f5a67f9efd46cb90707a">MED_NO_DT</a>,<a class="code" href="a00321_a95919207fd7a18ba26e6e03f04811e3f.html#a95919207fd7a18ba26e6e03f04811e3f">MED_NO_IT</a>,
                                               <a class="code" href="a00321_aab0e957294723517d5c3641bb71b0470.html#aab0e957294723517d5c3641bb71b0470aecea01a443c5512ff49ddba9f992aa0e">MED_DESCENDING_EDGE</a>,typare[j],cor) &lt; 0) {
             <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;Erreur a la lecture des correspondances sur les faces : &quot;</span>);
             <a class="code" href="a00348_a257959db0a78623caa051d11ceb2f8cb.html#a257959db0a78623caa051d11ceb2f8cb">SSCRUTE</a>(<a class="code" href="a00499_ac7b61e15c064e78b7cec77aeabd7532e.html#ac7b61e15c064e78b7cec77aeabd7532e">MED_GET_EDGE_GEOMETRY_TYPENAME</a>[j]);
             ret = -1;
           }
           <span class="keywordflow">if</span> (ret == 0)
             <span class="keywordflow">for</span> (k=0;k&lt;ncor;k++)
               printf(<span class="stringliteral">&quot;Correspondance %d : &quot;</span>IFORMAT<span class="stringliteral">&quot; et &quot;</span>IFORMAT<span class="stringliteral">&quot; \n&quot;</span>,k+1,*(cor+2*k),
                      *(cor+2*k+1));
           free(cor);
          }
        }

    }

  <span class="comment">/* Fermeture du fichier */</span>
  <span class="keywordflow">if</span> (<a class="code" href="a01005_ga12a0e901c376be997a41a073ce426283.html#ga12a0e901c376be997a41a073ce426283" title="Fermeture d&amp;#39;un fichier MED.">MEDfileClose</a>(fid) &lt; 0) {
    <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;Erreur a la fermeture du fichier &quot;</span>);
    <span class="keywordflow">return</span> -1;
  }

  <span class="keywordflow">return</span> ret;
}




</pre></div> <h3><a class="anchor" id="5."></a>Cr&eacute;er et lire un maillage avec des &eacute;l&eacute;ments de structure</h3>
<p>MED permet de cr&eacute;er des mod&egrave;les d'&eacute;l&eacute;ments de structure. Un mod&egrave;le d'&eacute;l&eacute;ment est propre &agrave; un fichier qui doit &ecirc;tre celui de(s) maillage(s) de calcul qui utilisent le mod&egrave;le. Il peut y avoir plusieurs mod&egrave;les d'&eacute;l&eacute;ments de structures dans un m&ecirc;me fichier. Une fois le mod&egrave;le d&eacute;fini, l'&eacute;l&eacute;ment de structure devient un nouveau type d'&eacute;l&eacute;ment d'un maillage de calcul au m&ecirc;me titre que les autres types d'&eacute;l&eacute;ments pr&eacute;-d&eacute;finis dans le mod&egrave;le. </p>
<p>Le mod&egrave;le MED r&eacute;serve des noms de mod&egrave;les pour les particules (<a class="el" href="a00321_a786e7850e4d89a31047496e6fd48476d.html#a786e7850e4d89a31047496e6fd48476d">MED_PARTICLE_NAME</a>), les billes (<a class="el" href="a00321_aa86785fc7c9bc73e184da6e687f79f2b.html#aa86785fc7c9bc73e184da6e687f79f2b">MED_BALL_NAME</a>) et les poutres (<a class="el" href="a00321_a738baa2a243efa4f2e957c2a75b616c1.html#a738baa2a243efa4f2e957c2a75b616c1">MED_BEAM_NAME</a>). Cette liste de noms r&eacute;serv&eacute;s est amen&eacute;e &agrave; s'&eacute;toffer au fil des versions de MED, de fait tous les noms de mod&egrave;le commen&ccedil;ant par &nbsp;MED_&nbsp; sont &eacute;galement r&eacute;serv&eacute;s. A chaque nom de mod&egrave;le r&eacute;serv&eacute; ou fix&eacute; par l'utilisateur est associ&eacute; un num&eacute;ro de type g&eacute;om&eacute;trique unique au fichier. Ce num&eacute;ro compl&egrave;te les num&eacute;ros existants pour les types g&eacute;om&eacute;triques &eacute;l&eacute;ments finis. Le num&eacute;ro de type d'un &eacute;l&eacute;ment de structure est utilisable comme celui des types g&eacute;om&eacute;triques classiques pour s'informer de la pr&eacute;sence du type d'&eacute;l&eacute;ment dans un maillage de calcul. Le type d'entit&eacute; de ce type d'&eacute;l&eacute;ment est <a class="el" href="a00321_aab0e957294723517d5c3641bb71b0470.html#aab0e957294723517d5c3641bb71b0470abdd6b14142920f599bbe4e97c4bb921e">MED_STRUCT_ELEMENT</a>. </p>
<p>Un mod&egrave;le de structure utilis&eacute; dans un fichier doit &ecirc;tre compl&egrave;tement d&eacute;fini dans ce fichier. Ainsi les maillages et les champs s'appuyant sur des &eacute;lements de ce mod&egrave;le pourront &ecirc;tre relus par tout code s'int&eacute;ressant aux &eacute;l&eacute;ments de structure. La description d'un mod&egrave;le d'&eacute;l&eacute;ment de structure peut s'appuyer sur un maillage support.  </p>
<p>Si le mod&egrave;le ne contient pas de maillage support, chaque &eacute;l&eacute;ment de structure associ&eacute; au mod&egrave;le, s'appuie sur les noeuds du maillage de calcul pour se positionner. C'est le cas par exemple du mod&egrave;le pr&eacute;-d&eacute;fini des particules. Les coordonn&eacute;es de ces noeuds peuvent &eacute;voluer au cours du temps selon le principe des maillages &eacute;volutifs pr&eacute;sent&eacute;s pr&eacute;c&eacute;demment.  </p>
<p>Un maillage support contient 1 ou plusieurs noeuds et &eacute;ventuellement des mailles. La connectivit&eacute; des &eacute;l&eacute;ments de structure y est uniquement d&eacute;crite en mode nodal. Les noeuds d'un maillage support sont d&eacute;finis ind&eacute;pendamment des maillages de calcul. Ces noeuds ne sont pas r&eacute;f&eacute;renc&eacute;s dans les maillages de calculs. Les coordonn&eacute;es des noeuds sont d&eacute;finies dans un espace de dimension &eacute;gale &agrave; celle de l'&eacute;l&eacute;ment de structure. Le rep&egrave;re de coordonn&eacute;es est propre &agrave; la description du mod&egrave;le de l'&eacute;l&eacute;ment. Les mailles d&eacute;finies dans un maillage support sont ind&eacute;pendantes des maillages de calcul et ne sont pas r&eacute;f&eacute;renc&eacute;es dans les maillages de calcul. S'il y a des mailles dans le maillage support, la connectivit&eacute; des &eacute;l&eacute;ments de structure r&eacute;f&eacute;rence des num&eacute;ros de mailles dans les maillages de calcul. Il ne peut y avoir qu'un seul type g&eacute;om&eacute;trique de maille dans un maillage support. Dans un maillage support, il est pas utile d'&eacute;crire les num&eacute;ros de familles (toutes les entit&eacute;s sont rattach&eacute;es &agrave; la famille 0 par d&eacute;faut), les num&eacute;ros optionnels, les noms optionnels des entit&eacute;s du maillage. Un maillage support ne peut contenir de polygones ou poly&egrave;dres quelconques.  </p>
<p>Les caract&eacute;ristiques d'un &eacute;l&eacute;ment de structure sont d&eacute;crites par des attributs. Il existe deux types d'attributs caract&eacute;ristiques : des attributs caract&eacute;ristiques &agrave; valeur constante pour tous les &eacute;l&eacute;ments du mod&egrave;le (ou attributs caract&eacute;ristiques du mod&egrave;le), des attributs caract&eacute;ristiques &agrave; valeur variable selon les &eacute;l&eacute;ments du mod&egrave;le (la valeur est alors d&eacute;finie au niveau des &eacute;l&eacute;ments dans les maillage de calcul). Les attributs caract&eacute;ristiques sont typ&eacute; par les types MED standards (entier, r&eacute;el, cha&icirc;ne de caract&egrave;res de taille <a class="el" href="a00321_a0ae989cbbfeecbb5296b3ceba8dab886.html#a0ae989cbbfeecbb5296b3ceba8dab886">MED_NAME_SIZE</a>). Un attribut peut comporter plusieurs composantes au m&ecirc;me titre qu'un champ.  </p>
<p>La cr&eacute;ation d'un mod&egrave;le d'&eacute;l&eacute;ment de structure se fait avec la routine <a class="el" href="a01014_ga018cf42798055d8cd2a8ec80f733d31d.html#ga018cf42798055d8cd2a8ec80f733d31d">MEDstructElementCr</a> / <a class="el" href="a01029_ga80f3a277c487989f3dabcdf442005ba2.html#ga80f3a277c487989f3dabcdf442005ba2">msecre</a>. Un mod&egrave;le est identifi&eacute; par son nom qui est une cha&icirc;ne de <a class="el" href="a00321_a0ae989cbbfeecbb5296b3ceba8dab886.html#a0ae989cbbfeecbb5296b3ceba8dab886">MED_NAME_SIZE</a> caract&egrave;res. La cr&eacute;ation d'un attribut caract&eacute;ristique &agrave; valeur variable se fait avec la routine <a class="el" href="a01014_gab486f3f6ba5622b8e22562286921bdd1.html#gab486f3f6ba5622b8e22562286921bdd1">MEDstructElementVarAttCr</a> / <a class="el" href="a01029_ga5f7862f73c77451fda10a80f4c18f35f.html#ga5f7862f73c77451fda10a80f4c18f35f">msevac</a>. La cr&eacute;ation d'un attribut caract&eacute;ristique du mod&egrave;le se fait avec les routines <a class="el" href="a01014_ga4076c307f43a271a12071bb74b0690ef.html#ga4076c307f43a271a12071bb74b0690ef">MEDstructElementConstAttWr</a> / <a class="el" href="a01029_ga60f2d448a1b86749c7049e0ed3cea3bd.html#ga60f2d448a1b86749c7049e0ed3cea3bd">mseraw</a>, <a class="el" href="a01029_ga37c2870b9d3ae0a4f240dc8f2d6547db.html#ga37c2870b9d3ae0a4f240dc8f2d6547db">mseiaw</a>, <a class="el" href="a01029_ga4e1629648a6de4834329c3bd5dc3d92c.html#ga4e1629648a6de4834329c3bd5dc3d92c">msesaw</a>. La routine <a class="el" href="a01014_gabebaf350609299e314c5950be79b0855.html#gabebaf350609299e314c5950be79b0855">MEDmeshStructElementVarAttWr</a> / <a class="el" href="a01029_gaacd1c28d8a12571d7b421e5ca9272259.html#gaacd1c28d8a12571d7b421e5ca9272259">mmhraw</a>, <a class="el" href="a01029_ga17b923437b8044aea3b9b5750d48575d.html#ga17b923437b8044aea3b9b5750d48575d">mmhiaw</a>, <a class="el" href="a01029_ga6f35f87f0174bcb86d6d8b746f4659d7.html#ga6f35f87f0174bcb86d6d8b746f4659d7">mmhsaw</a> permet d'&eacute;crire les valeurs d'un attribut &agrave; valeur variable, l'appel &agrave; cette routine se faisant au moment de la cr&eacute;ation d'un maillage de calcul. Les routines <a class="el" href="a01014_ga4076c307f43a271a12071bb74b0690ef.html#ga4076c307f43a271a12071bb74b0690ef">MEDstructElementConstAttWr</a> / <a class="el" href="a01029_ga60f2d448a1b86749c7049e0ed3cea3bd.html#ga60f2d448a1b86749c7049e0ed3cea3bd">mseraw</a>, <a class="el" href="a01029_ga37c2870b9d3ae0a4f240dc8f2d6547db.html#ga37c2870b9d3ae0a4f240dc8f2d6547db">mseiaw</a>, <a class="el" href="a01029_ga4e1629648a6de4834329c3bd5dc3d92c.html#ga4e1629648a6de4834329c3bd5dc3d92c">msesaw</a> et <a class="el" href="a01014_ga10af186c4d6fa0cfd0aa3a6b2c90c0a4.html#ga10af186c4d6fa0cfd0aa3a6b2c90c0a4">MEDstructElementConstAttWithProfileWr</a> / <a class="el" href="a01029_gafb90ddf463c56822261e1e0a3f49340e.html#gafb90ddf463c56822261e1e0a3f49340e">mserpw</a>, <a class="el" href="a01029_ga9bdd31f4d8ed07c9f0fc96f340d9234d.html#ga9bdd31f4d8ed07c9f0fc96f340d9234d">mseipw</a>, <a class="el" href="a01029_ga802fc8379d73d146d0771518f8da150a.html#ga802fc8379d73d146d0771518f8da150a">msespw</a> permettent d'&eacute;crire les valeurs d'un attribut constant respectivement sans et avec un profil.  </p>
<p>La cr&eacute;ation d'un maillage support se fait avec une routine sp&eacute;cifique <a class="el" href="a01016_ga8d14cb8ed06c18d7a8c7a32d89b5ebd5.html#ga8d14cb8ed06c18d7a8c7a32d89b5ebd5">MEDsupportMeshCr</a> / <a class="el" href="a01031_gaa6323f29e87be5e3e2c4295f40564f07.html#gaa6323f29e87be5e3e2c4295f40564f07">msmcre</a>. L'&eacute;criture des coordonn&eacute;es des noeuds et de la connectivit&eacute; des mailles se fait avec les m&ecirc;mes routines que celles utilis&eacute;es pour les maillages de calcul. Un maillage support est identifi&eacute; par son nom qui est une cha&icirc;ne de <a class="el" href="a00321_a0ae989cbbfeecbb5296b3ceba8dab886.html#a0ae989cbbfeecbb5296b3ceba8dab886">MED_NAME_SIZE</a> caract&egrave;res. </p>
<p>Le cas d'utilisation suivant d&eacute;finit 3 mod&egrave;les d'&eacute;l&eacute;ments de structure diff&eacute;rents pour les particules, les billes et les poutres. Les deux derniers mod&egrave;les s'appuient sur des maillages support &eacute;galement d&eacute;finis dans le fichier. Des &eacute;l&eacute;ments de structure qui correspondent &agrave; ces mod&egrave;les sont finalement utilis&eacute;s dans un maillage de calcul.  </p>
<div class="fragment"><pre class="fragment"><span class="comment">/*  This file is part of MED.</span>
<span class="comment"> *</span>
<span class="comment"> *  COPYRIGHT (C) 1999 - 2012  EDF R&amp;D, CEA/DEN</span>
<span class="comment"> *  MED is free software: you can redistribute it and/or modify</span>
<span class="comment"> *  it under the terms of the GNU Lesser General Public License as published by</span>
<span class="comment"> *  the Free Software Foundation, either version 3 of the License, or</span>
<span class="comment"> *  (at your option) any later version.</span>
<span class="comment"> *</span>
<span class="comment"> *  MED is distributed in the hope that it will be useful,</span>
<span class="comment"> *  but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="comment"> *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<span class="comment"> *  GNU Lesser General Public License for more details.</span>
<span class="comment"> *</span>
<span class="comment"> *  You should have received a copy of the GNU Lesser General Public License</span>
<span class="comment"> *  along with MED.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span>
<span class="comment"> */</span>

<span class="comment">/*</span>
<span class="comment"> * StructElement use case 1 : write struct elements model in a file</span>
<span class="comment"> * STEP 1 : suppport mesh creation</span>
<span class="comment"> * STEP 2 : struct element model creation</span>
<span class="comment"> * STEP 3 : computation mesh creation</span>
<span class="comment"> */</span>

<span class="preprocessor">#include &lt;med.h&gt;</span>
<span class="preprocessor">#define MESGERR 1</span>
<span class="preprocessor"></span><span class="preprocessor">#include &lt;med_utils.h&gt;</span>

<span class="preprocessor">#include &lt;string.h&gt;</span>

<span class="keywordtype">int</span> <a class="code" href="a00750_a3c04138a5bfe5d72780bb7e82a18e627.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a> (<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> **argv) {
  <a class="code" href="a00320_afa4ec8284026c8c5545e5333475fb65a.html#afa4ec8284026c8c5545e5333475fb65a">med_idt</a> fid;
  <span class="keywordtype">char</span> elementname[<a class="code" href="a00321_a0ae989cbbfeecbb5296b3ceba8dab886.html#a0ae989cbbfeecbb5296b3ceba8dab886">MED_NAME_SIZE</a>+1]=<span class="stringliteral">&quot;&quot;</span>;
  <span class="keyword">const</span> <span class="keywordtype">char</span> ballsupportname[<a class="code" href="a00321_a0ae989cbbfeecbb5296b3ceba8dab886.html#a0ae989cbbfeecbb5296b3ceba8dab886">MED_NAME_SIZE</a>+1]=<span class="stringliteral">&quot;BALL_SUPPORT_MESH&quot;</span>;
  <span class="keyword">const</span> <span class="keywordtype">char</span> beamsupportname[<a class="code" href="a00321_a0ae989cbbfeecbb5296b3ceba8dab886.html#a0ae989cbbfeecbb5296b3ceba8dab886">MED_NAME_SIZE</a>+1]=<span class="stringliteral">&quot;BEAM_SUPPORT_MESH&quot;</span>;
  <span class="keyword">const</span> <span class="keywordtype">char</span> computmeshname[<a class="code" href="a00321_a0ae989cbbfeecbb5296b3ceba8dab886.html#a0ae989cbbfeecbb5296b3ceba8dab886">MED_NAME_SIZE</a>+1]=<span class="stringliteral">&quot;COMPUT_MESH&quot;</span>;
  <span class="keyword">const</span> <span class="keywordtype">char</span> beamsectionname[<a class="code" href="a00321_a0ae989cbbfeecbb5296b3ceba8dab886.html#a0ae989cbbfeecbb5296b3ceba8dab886">MED_NAME_SIZE</a>+1]=<span class="stringliteral">&quot;BEAM_SECTION_MESH&quot;</span>;
  <span class="keyword">const</span> <a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> elementdim = 3;
  <a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> nnode;
  <a class="code" href="a00321_a1043613afc3cd2e24785dfc7c0452ab8.html#a1043613afc3cd2e24785dfc7c0452ab8">med_geometry_type</a> geotype=<a class="code" href="a00321_a9a2843c7d6eacffdd9377b5bfb8a6de3.html#a9a2843c7d6eacffdd9377b5bfb8a6de3">MED_NONE</a>;
  <a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> ncomp;
  <span class="keyword">const</span> <a class="code" href="a00320_ab1eab99ca56ac95ce5b1c0e4ae0f095a.html#ab1eab99ca56ac95ce5b1c0e4ae0f095a">med_float</a> ballmeshnodescoo[3] = {0.0, 0.0, 0.0 };
  <span class="keyword">const</span> <a class="code" href="a00320_ab1eab99ca56ac95ce5b1c0e4ae0f095a.html#ab1eab99ca56ac95ce5b1c0e4ae0f095a">med_float</a> beammeshnodescoo[3*7] = {0.0,0.0,0.0,
                                           0.0,0.0,2.0,
                                           0.0,0.0,4.0,
                                           0.0,0.0,5.0,
                                           0.0,0.0,7.0,
                                           0.0,0.0,10.0,
                                           0.0,0.0,11.0 };
  <span class="keyword">const</span> <a class="code" href="a00320_ab1eab99ca56ac95ce5b1c0e4ae0f095a.html#ab1eab99ca56ac95ce5b1c0e4ae0f095a">med_float</a> beamsectioncoo[9*3] = {-0.2,-0.2,0.0,
                                         0.0,-0.2,0.0,
                                         0.2,-0.2,0.0,
                                         -0.2, 0.0,0.0,
                                         0.0, 0.0,0.0,
                                         0.2, 0.0,0.0,
                                         -0.2, 0.2,0.0,
                                         0.0, 0.2,0.0,
                                         0.2, 0.2,0.0 };
  <span class="keyword">const</span> <a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> seg2connectivity[2*6] = {1,2, 2,3, 3,4, 4,5, 5,6, 6,7};
  <a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> spacedim, meshdim,nseg2;
  <span class="comment">/*                                         123456789012345612345678901234561234567890123456 */</span>
  <span class="keyword">const</span> <span class="keywordtype">char</span> axisname[3*<a class="code" href="a00321_a213ecd1a546eb96092b980a870bc386b.html#a213ecd1a546eb96092b980a870bc386b">MED_SNAME_SIZE</a>+1] = <span class="stringliteral">&quot;x               y               z               &quot;</span>;
  <span class="keyword">const</span> <span class="keywordtype">char</span> unitname[3*<a class="code" href="a00321_a213ecd1a546eb96092b980a870bc386b.html#a213ecd1a546eb96092b980a870bc386b">MED_SNAME_SIZE</a>+1] = <span class="stringliteral">&quot;cm              cm              cm              &quot;</span>;
  <span class="keyword">const</span> <a class="code" href="a00320_ab1eab99ca56ac95ce5b1c0e4ae0f095a.html#ab1eab99ca56ac95ce5b1c0e4ae0f095a">med_float</a> attvalue[6] = {0.2,0.3,0.4,0.4,0.3,0.2};
  <span class="comment">/*                                            1234567890123456789012345678901234567890123456789012345678901234        */</span>
  <span class="keyword">const</span> <span class="keywordtype">char</span> attprovalue[2*<a class="code" href="a00321_a0ae989cbbfeecbb5296b3ceba8dab886.html#a0ae989cbbfeecbb5296b3ceba8dab886">MED_NAME_SIZE</a>+1] = {<span class="stringliteral">&quot;EXTREMITY_1_____________________________________________________&quot;</span> \
                                               <span class="stringliteral">&quot;EXTREMITY_2_____________________________________________________&quot;</span> };
  <span class="keyword">const</span> <span class="keywordtype">char</span> profilename[<a class="code" href="a00321_a0ae989cbbfeecbb5296b3ceba8dab886.html#a0ae989cbbfeecbb5296b3ceba8dab886">MED_NAME_SIZE</a>+1] = <span class="stringliteral">&quot;EXTREMITY_PROFILE_NAME&quot;</span>;
  <span class="keyword">const</span> <a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> profilesize = 2;
  <span class="keyword">const</span> <a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> profile[2] = {1,6};
  <span class="keyword">const</span> <a class="code" href="a00320_ab1eab99ca56ac95ce5b1c0e4ae0f095a.html#ab1eab99ca56ac95ce5b1c0e4ae0f095a">med_float</a> meshcoo[3*12] = { 0.0, 0.0, 0.0,
                                    1.1, 1.1, 1.1,
                                    2.2, 2.2, 2.2,
                                    10., 10., 10.,
                                    12., 12., 12.,
                                    60., 20., 20.,
                                    70., 20., 20.,
                                    80., 20., 20.,
                                    90., 20., 20.,
                                    100., 20., 20.,
                                    110., 20., 20.,
                                    120., 20., 20.
  };
  <span class="keyword">const</span> <a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> beamconnectivity[12] = {  6,7,
                                          7,8,
                                          8,9,
                                          9,10,
                                          10,11,
                                          11,12 };
  <a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> nentity;
  <span class="keyword">const</span> <a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> labels[3] = { 1, 2, 3 }; <span class="comment">/* nodes numbers */</span>
  <span class="keyword">const</span> <a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> ballconnectivity[2] = { 4, 5 }; <span class="comment">/* nodes numbers */</span>
  <span class="keyword">const</span> <a class="code" href="a00320_ab1eab99ca56ac95ce5b1c0e4ae0f095a.html#ab1eab99ca56ac95ce5b1c0e4ae0f095a">med_float</a> balldiameter[2] = { 2.0, 5.8 };
  <span class="keyword">const</span> <a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> nquad4=4;
  <span class="keyword">const</span> <a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> beamsectionconnectivity[4*4] = { 4,5,2,1,
                                                 5,6,3,2,
                                                 7,8,5,4,
                                                 8,9,6,5};
  <span class="keywordtype">int</span> ret=-1;
  
  <span class="comment">/* file creation */</span>
  fid = <a class="code" href="a01005_ga9376a1654b7bf099c3f8941074c5fdfb.html#ga9376a1654b7bf099c3f8941074c5fdfb" title="Ouverture d&amp;#39;un fichier MED.">MEDfileOpen</a>(<span class="stringliteral">&quot;UsesCase_MEDstructElement_1.med&quot;</span>,<a class="code" href="a00321_adcd0322de9fec3b5e199ffeda3f44c85.html#adcd0322de9fec3b5e199ffeda3f44c85aa23dd1c18b596924d5f50c8402b84c8e">MED_ACC_CREAT</a>);
  <span class="keywordflow">if</span> (fid &lt; 0) {
    <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : file creation&quot;</span>);
    <span class="keywordflow">goto</span> ERROR;
  }

  <span class="comment">/* STEP 1 : support meshes creation */</span>
  spacedim =  3;
  meshdim = 3;

  <span class="comment">/* Mesh 1 : support mesh for ball model */</span>
  <span class="keywordflow">if</span> (<a class="code" href="a01016_ga8d14cb8ed06c18d7a8c7a32d89b5ebd5.html#ga8d14cb8ed06c18d7a8c7a32d89b5ebd5" title="Cette routine permet de créer un maillage support.">MEDsupportMeshCr</a>(fid, ballsupportname, spacedim, meshdim, <span class="stringliteral">&quot;Support mesh for a ball model&quot;</span>,
                       <a class="code" href="a00321_a57867e4bed1d104c865cfc9d23c9204d.html#a57867e4bed1d104c865cfc9d23c9204da682ef7f1042079519664eae87f90297e">MED_CARTESIAN</a>, axisname, unitname) &lt; 0) {
    <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : creating a support mesh ...&quot;</span>);
    <span class="keywordflow">goto</span> ERROR;
  }
  <span class="comment">/* 1 node and no cell in the mesh */</span>
  nnode = 1;
  <span class="keywordflow">if</span> (<a class="code" href="a01011_gab2a6fcbbb0dfb0dba573320ed07f503b.html#gab2a6fcbbb0dfb0dba573320ed07f503b" title="Cette routine permet d&amp;#39;écrire dans un maillage le tableau des coordonnées des...">MEDmeshNodeCoordinateWr</a>(fid, ballsupportname, <a class="code" href="a00321_a8f72b6ceb3b6f5a67f9efd46cb90707a.html#a8f72b6ceb3b6f5a67f9efd46cb90707a">MED_NO_DT</a>, <a class="code" href="a00321_a95919207fd7a18ba26e6e03f04811e3f.html#a95919207fd7a18ba26e6e03f04811e3f">MED_NO_IT</a>, 0.0,
                              <a class="code" href="a00320_a0ac861d71fe5e0be056a86f9212f1c6a.html#a0ac861d71fe5e0be056a86f9212f1c6aa9a1509b3f93e5915a24f555890c73ee1">MED_FULL_INTERLACE</a>, nnode, ballmeshnodescoo) &lt; 0) {
    <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : write nodes coordinates ...&quot;</span>);
    <span class="keywordflow">goto</span> ERROR;
  }

  <span class="comment">/* Mesh 2 :support mesh for beam model */</span>
  <span class="keywordflow">if</span> (<a class="code" href="a01016_ga8d14cb8ed06c18d7a8c7a32d89b5ebd5.html#ga8d14cb8ed06c18d7a8c7a32d89b5ebd5" title="Cette routine permet de créer un maillage support.">MEDsupportMeshCr</a>(fid, beamsupportname, spacedim, meshdim, <span class="stringliteral">&quot;Support mesh for a beam model&quot;</span>,
                       <a class="code" href="a00321_a57867e4bed1d104c865cfc9d23c9204d.html#a57867e4bed1d104c865cfc9d23c9204da682ef7f1042079519664eae87f90297e">MED_CARTESIAN</a>, axisname, unitname) &lt; 0) {
    <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : creating a support mesh ...&quot;</span>);
    <span class="keywordflow">goto</span> ERROR;
  }
  <span class="comment">/* 7 nodes and 6 MED_SEG2 */</span>
  nnode = 7;
  <span class="keywordflow">if</span> (<a class="code" href="a01011_gab2a6fcbbb0dfb0dba573320ed07f503b.html#gab2a6fcbbb0dfb0dba573320ed07f503b" title="Cette routine permet d&amp;#39;écrire dans un maillage le tableau des coordonnées des...">MEDmeshNodeCoordinateWr</a>(fid, beamsupportname, <a class="code" href="a00321_a8f72b6ceb3b6f5a67f9efd46cb90707a.html#a8f72b6ceb3b6f5a67f9efd46cb90707a">MED_NO_DT</a>, <a class="code" href="a00321_a95919207fd7a18ba26e6e03f04811e3f.html#a95919207fd7a18ba26e6e03f04811e3f">MED_NO_IT</a>, 0.0,
                              <a class="code" href="a00320_a0ac861d71fe5e0be056a86f9212f1c6a.html#a0ac861d71fe5e0be056a86f9212f1c6aa9a1509b3f93e5915a24f555890c73ee1">MED_FULL_INTERLACE</a>, nnode,  beammeshnodescoo) &lt; 0) {
    <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : write nodes coordinates ...&quot;</span>);
    <span class="keywordflow">goto</span> ERROR;
  }
  nseg2 = 6;
  <span class="keywordflow">if</span> (<a class="code" href="a01011_ga091f97ef25e5bb96e3d941b85131cea9.html#ga091f97ef25e5bb96e3d941b85131cea9" title="Cette routine permet d&amp;#39;écrire dans un maillage le tableau des connectivités...">MEDmeshElementConnectivityWr</a>(fid, beamsupportname, <a class="code" href="a00321_a8f72b6ceb3b6f5a67f9efd46cb90707a.html#a8f72b6ceb3b6f5a67f9efd46cb90707a">MED_NO_DT</a>, <a class="code" href="a00321_a95919207fd7a18ba26e6e03f04811e3f.html#a95919207fd7a18ba26e6e03f04811e3f">MED_NO_IT</a>, 0.0, <a class="code" href="a00321_aab0e957294723517d5c3641bb71b0470.html#aab0e957294723517d5c3641bb71b0470a227d14957ec5f221685cb1d6ec3b6c67">MED_CELL</a>, <a class="code" href="a00321_a29927daaa1a87f2129295a68264ad526.html#a29927daaa1a87f2129295a68264ad526">MED_SEG2</a>,
                                   <a class="code" href="a00321_afcd26ca66a179b9aa82f5c90602c4ed8.html#afcd26ca66a179b9aa82f5c90602c4ed8a4ae92e7de0898383577cbba640006baa">MED_NODAL</a>, <a class="code" href="a00320_a0ac861d71fe5e0be056a86f9212f1c6a.html#a0ac861d71fe5e0be056a86f9212f1c6aa9a1509b3f93e5915a24f555890c73ee1">MED_FULL_INTERLACE</a>, nseg2, seg2connectivity) &lt; 0) {
    <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : write cells connectivity ...&quot;</span>);
    <span class="keywordflow">goto</span> ERROR;
  }

  <span class="comment">/* Mesh 3 : support mesh to define a section for integration points of</span>
<span class="comment">     a struct element */</span>
  <span class="keywordflow">if</span> (<a class="code" href="a01016_ga8d14cb8ed06c18d7a8c7a32d89b5ebd5.html#ga8d14cb8ed06c18d7a8c7a32d89b5ebd5" title="Cette routine permet de créer un maillage support.">MEDsupportMeshCr</a>(fid, beamsectionname, spacedim, meshdim, <span class="stringliteral">&quot;Support mesh for a section of the beam model&quot;</span>,
                       <a class="code" href="a00321_a57867e4bed1d104c865cfc9d23c9204d.html#a57867e4bed1d104c865cfc9d23c9204da682ef7f1042079519664eae87f90297e">MED_CARTESIAN</a>, axisname, unitname) &lt; 0) {
    <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : creating a support mesh ...&quot;</span>);
    <span class="keywordflow">goto</span> ERROR;
  }

  nnode = 9;
  <span class="keywordflow">if</span> (<a class="code" href="a01011_gab2a6fcbbb0dfb0dba573320ed07f503b.html#gab2a6fcbbb0dfb0dba573320ed07f503b" title="Cette routine permet d&amp;#39;écrire dans un maillage le tableau des coordonnées des...">MEDmeshNodeCoordinateWr</a>(fid, beamsectionname, <a class="code" href="a00321_a8f72b6ceb3b6f5a67f9efd46cb90707a.html#a8f72b6ceb3b6f5a67f9efd46cb90707a">MED_NO_DT</a>, <a class="code" href="a00321_a95919207fd7a18ba26e6e03f04811e3f.html#a95919207fd7a18ba26e6e03f04811e3f">MED_NO_IT</a>, 0.0,
                              <a class="code" href="a00320_a0ac861d71fe5e0be056a86f9212f1c6a.html#a0ac861d71fe5e0be056a86f9212f1c6aa9a1509b3f93e5915a24f555890c73ee1">MED_FULL_INTERLACE</a>, nnode, beamsectioncoo) &lt; 0) {
    <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : write nodes coordinates ...&quot;</span>);
    <span class="keywordflow">goto</span> ERROR;
  }

  <span class="keywordflow">if</span> (<a class="code" href="a01011_ga091f97ef25e5bb96e3d941b85131cea9.html#ga091f97ef25e5bb96e3d941b85131cea9" title="Cette routine permet d&amp;#39;écrire dans un maillage le tableau des connectivités...">MEDmeshElementConnectivityWr</a>(fid, beamsectionname, <a class="code" href="a00321_a8f72b6ceb3b6f5a67f9efd46cb90707a.html#a8f72b6ceb3b6f5a67f9efd46cb90707a">MED_NO_DT</a>, <a class="code" href="a00321_a95919207fd7a18ba26e6e03f04811e3f.html#a95919207fd7a18ba26e6e03f04811e3f">MED_NO_IT</a>, 0.0, <a class="code" href="a00321_aab0e957294723517d5c3641bb71b0470.html#aab0e957294723517d5c3641bb71b0470a227d14957ec5f221685cb1d6ec3b6c67">MED_CELL</a>, <a class="code" href="a00321_a24ea9c52f5bde41d9a072925249ec06c.html#a24ea9c52f5bde41d9a072925249ec06c">MED_QUAD4</a>,
                                   <a class="code" href="a00321_afcd26ca66a179b9aa82f5c90602c4ed8.html#afcd26ca66a179b9aa82f5c90602c4ed8a4ae92e7de0898383577cbba640006baa">MED_NODAL</a>, <a class="code" href="a00320_a0ac861d71fe5e0be056a86f9212f1c6a.html#a0ac861d71fe5e0be056a86f9212f1c6aa9a1509b3f93e5915a24f555890c73ee1">MED_FULL_INTERLACE</a>, nquad4, beamsectionconnectivity) &lt; 0) {
    <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : write cells connectivity ...&quot;</span>);
    <span class="keywordflow">goto</span> ERROR;
  }

  <span class="comment">/* STEP 2 */</span>
  <span class="comment">/* particle model creation : no support mesh */</span>
  strcpy(elementname,<a class="code" href="a00321_a786e7850e4d89a31047496e6fd48476d.html#a786e7850e4d89a31047496e6fd48476d">MED_PARTICLE_NAME</a>);
  <span class="keywordflow">if</span> ((geotype = <a class="code" href="a01014_ga018cf42798055d8cd2a8ec80f733d31d.html#ga018cf42798055d8cd2a8ec80f733d31d" title="Cette routine permet de créer un nouveau modèle d&amp;#39;éléments de structure dans...">MEDstructElementCr</a>(fid, elementname, elementdim, <a class="code" href="a00321_aff82475025000f628497e5c0d7117bcf.html#aff82475025000f628497e5c0d7117bcf">MED_NO_MESHNAME</a>,
                                    <a class="code" href="a00321_a9a2843c7d6eacffdd9377b5bfb8a6de3.html#a9a2843c7d6eacffdd9377b5bfb8a6de3">MED_NONE</a>,<a class="code" href="a00321_a9a2843c7d6eacffdd9377b5bfb8a6de3.html#a9a2843c7d6eacffdd9377b5bfb8a6de3">MED_NONE</a>)) &lt; 0) {
    <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : creating struct element&quot;</span>);
    <span class="keywordflow">goto</span> ERROR;
  }
  ncomp=1;
  <span class="keywordflow">if</span> (<a class="code" href="a01014_gab486f3f6ba5622b8e22562286921bdd1.html#gab486f3f6ba5622b8e22562286921bdd1" title="Cette routine déclare la présence d&amp;#39;un attribut caractéristique variable attaché...">MEDstructElementVarAttCr</a>(fid, elementname,
                               <a class="code" href="a00321_a1ccd58b1b04b04136557b619d5ce4c9d.html#a1ccd58b1b04b04136557b619d5ce4c9d">MED_PARTICLE_LABEL</a>, <a class="code" href="a00321_ab6689ff0f472c1b88f02f030d34825b8.html#ab6689ff0f472c1b88f02f030d34825b8add7fd38889e057c70ed529bac85db4ee">MED_ATT_INT</a>, ncomp) &lt; 0) {
    <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : creating struct element&quot;</span>);
    <span class="keywordflow">goto</span> ERROR;
  }

  <span class="comment">/* ball model creation */</span>
  strcpy(elementname,<a class="code" href="a00321_aa86785fc7c9bc73e184da6e687f79f2b.html#aa86785fc7c9bc73e184da6e687f79f2b">MED_BALL_NAME</a>);
  <span class="keywordflow">if</span> ((geotype = <a class="code" href="a01014_ga018cf42798055d8cd2a8ec80f733d31d.html#ga018cf42798055d8cd2a8ec80f733d31d" title="Cette routine permet de créer un nouveau modèle d&amp;#39;éléments de structure dans...">MEDstructElementCr</a>(fid, elementname, elementdim, ballsupportname,
                                    <a class="code" href="a00321_aab0e957294723517d5c3641bb71b0470.html#aab0e957294723517d5c3641bb71b0470a074507163b07b6d764823a78c5c07f0f">MED_NODE</a>,<a class="code" href="a00321_a9a2843c7d6eacffdd9377b5bfb8a6de3.html#a9a2843c7d6eacffdd9377b5bfb8a6de3">MED_NONE</a>)) &lt; 0) {
    <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : creating struct element&quot;</span>);
    <span class="keywordflow">goto</span> ERROR;
  }
  ncomp=1;
  <span class="keywordflow">if</span> (<a class="code" href="a01014_gab486f3f6ba5622b8e22562286921bdd1.html#gab486f3f6ba5622b8e22562286921bdd1" title="Cette routine déclare la présence d&amp;#39;un attribut caractéristique variable attaché...">MEDstructElementVarAttCr</a>(fid, elementname,
                               <a class="code" href="a00321_a0bd406d126080383a267241ac784fb41.html#a0bd406d126080383a267241ac784fb41">MED_BALL_DIAMETER</a>, <a class="code" href="a00321_ab6689ff0f472c1b88f02f030d34825b8.html#ab6689ff0f472c1b88f02f030d34825b8acdee779d6931de0b056721831ae6bd95">MED_ATT_FLOAT64</a>, ncomp) &lt; 0) {
    <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : creating struct element&quot;</span>);
    <span class="keywordflow">goto</span> ERROR;
  }


  <span class="comment">/* A beam */</span>
  strcpy(elementname,<a class="code" href="a00321_a738baa2a243efa4f2e957c2a75b616c1.html#a738baa2a243efa4f2e957c2a75b616c1">MED_BEAM_NAME</a>);
  <span class="keywordflow">if</span> ((geotype = <a class="code" href="a01014_ga018cf42798055d8cd2a8ec80f733d31d.html#ga018cf42798055d8cd2a8ec80f733d31d" title="Cette routine permet de créer un nouveau modèle d&amp;#39;éléments de structure dans...">MEDstructElementCr</a>(fid, elementname, elementdim, beamsupportname,
                                    <a class="code" href="a00321_aab0e957294723517d5c3641bb71b0470.html#aab0e957294723517d5c3641bb71b0470a227d14957ec5f221685cb1d6ec3b6c67">MED_CELL</a>,<a class="code" href="a00321_a29927daaa1a87f2129295a68264ad526.html#a29927daaa1a87f2129295a68264ad526">MED_SEG2</a>)) &lt; 0) {
    <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : creating struct element&quot;</span>);
    <span class="keywordflow">goto</span> ERROR;
  }
  ncomp=1;
  <span class="comment">/* a first constant attribute */</span>
  <span class="keywordflow">if</span> (<a class="code" href="a01014_ga4076c307f43a271a12071bb74b0690ef.html#ga4076c307f43a271a12071bb74b0690ef" title="Cette routine définit un attribut caractéristique constant d&amp;#39;un modèle d&amp;#39;éléments...">MEDstructElementConstAttWr</a>(fid, elementname,
                                 <a class="code" href="a00321_ac02c21964d5854d4a3a64a1fed762bad.html#ac02c21964d5854d4a3a64a1fed762bad">MED_BEAM_THICKNESS</a>, <a class="code" href="a00321_ab6689ff0f472c1b88f02f030d34825b8.html#ab6689ff0f472c1b88f02f030d34825b8acdee779d6931de0b056721831ae6bd95">MED_ATT_FLOAT64</a>, ncomp,
                                 <a class="code" href="a00321_aab0e957294723517d5c3641bb71b0470.html#aab0e957294723517d5c3641bb71b0470a227d14957ec5f221685cb1d6ec3b6c67">MED_CELL</a>,(<span class="keywordtype">void</span>*) attvalue) &lt; 0) {
    <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : creating struct element&quot;</span>);
    <span class="keywordflow">goto</span> ERROR;
  }
  <span class="comment">/* a second constant attribute defined with a profile for the first and the</span>
<span class="comment">     last segment */</span>
  <span class="comment">/* create the profile */</span>
    <span class="keywordflow">if</span> (<a class="code" href="a01013_gaf7ec6ed01898dcfe98556f399ed044d1.html#gaf7ec6ed01898dcfe98556f399ed044d1" title="Cette routine permet d&amp;#39;écrire un profil dans un fichier MED.">MEDprofileWr</a>(fid, profilename, profilesize, profile ) &lt; 0) {
    <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : create profile ...&quot;</span>);
    <span class="keywordflow">goto</span> ERROR;
  }
  <span class="comment">/* write the constant attribute */</span>
  <span class="keywordflow">if</span> (<a class="code" href="a01014_ga10af186c4d6fa0cfd0aa3a6b2c90c0a4.html#ga10af186c4d6fa0cfd0aa3a6b2c90c0a4" title="Cette routine définit un attribut caractéristique constant d&amp;#39;un modèle d&amp;#39;éléments...">MEDstructElementConstAttWithProfileWr</a>(fid,
                                            elementname,
                                            <span class="stringliteral">&quot;BEAM_EXTREMITIES_LABELS&quot;</span>,
                                            <a class="code" href="a00321_ab6689ff0f472c1b88f02f030d34825b8.html#ab6689ff0f472c1b88f02f030d34825b8af8c39990c775c4813629cfb6947cbc9e">MED_ATT_NAME</a>,
                                            ncomp,
                                            <a class="code" href="a00321_aab0e957294723517d5c3641bb71b0470.html#aab0e957294723517d5c3641bb71b0470a227d14957ec5f221685cb1d6ec3b6c67">MED_CELL</a>,
                                            profilename,
                                            (<span class="keywordtype">void</span>*) attprovalue) &lt; 0) {
    <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : creating struct element&quot;</span>);
    <span class="keywordflow">goto</span> ERROR;
  }

  <span class="comment">/* STEP 3 : Computation mesh creation */</span>

  <span class="comment">/* mesh creation */</span>
  <span class="keywordflow">if</span> (<a class="code" href="a01011_ga6007c3f1a62732e7a46c5eca232be78a.html#ga6007c3f1a62732e7a46c5eca232be78a" title="Cette routine permet de créer un maillage dans un fichier.">MEDmeshCr</a>(fid, computmeshname, spacedim, meshdim,  <a class="code" href="a00321_a821a4dd94c5c6b095318432bdec8d8a1.html#a821a4dd94c5c6b095318432bdec8d8a1a3719e53a4838d222f0a58148292fda41">MED_UNSTRUCTURED_MESH</a>,
                <span class="stringliteral">&quot;Computation mesh&quot;</span>, <span class="stringliteral">&quot;s&quot;</span>, <a class="code" href="a00321_a5b97067a30629cd60470d074691d6798.html#a5b97067a30629cd60470d074691d6798ae896b6adfbde9870b4e875e5167eddd0">MED_SORT_DTIT</a>,
                <a class="code" href="a00321_a57867e4bed1d104c865cfc9d23c9204d.html#a57867e4bed1d104c865cfc9d23c9204da682ef7f1042079519664eae87f90297e">MED_CARTESIAN</a>, axisname, unitname) &lt; 0) {
    <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : creating computation mesh ...&quot;</span>);
    <span class="keywordflow">goto</span> ERROR;
  }

  <span class="comment">/* mesh node creation */</span>
  nnode = 12;
  <span class="keywordflow">if</span> (<a class="code" href="a01011_gab2a6fcbbb0dfb0dba573320ed07f503b.html#gab2a6fcbbb0dfb0dba573320ed07f503b" title="Cette routine permet d&amp;#39;écrire dans un maillage le tableau des coordonnées des...">MEDmeshNodeCoordinateWr</a>(fid, computmeshname, <a class="code" href="a00321_a8f72b6ceb3b6f5a67f9efd46cb90707a.html#a8f72b6ceb3b6f5a67f9efd46cb90707a">MED_NO_DT</a>, <a class="code" href="a00321_a95919207fd7a18ba26e6e03f04811e3f.html#a95919207fd7a18ba26e6e03f04811e3f">MED_NO_IT</a>, <a class="code" href="a00321_a609885580ce660eb5b7c80074d64f93f.html#a609885580ce660eb5b7c80074d64f93f">MED_UNDEF_DT</a>,
                              <a class="code" href="a00320_a0ac861d71fe5e0be056a86f9212f1c6a.html#a0ac861d71fe5e0be056a86f9212f1c6aa9a1509b3f93e5915a24f555890c73ee1">MED_FULL_INTERLACE</a>, nnode, meshcoo) &lt; 0) {
    <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : writing nodes coordinates ...&quot;</span>);
    <span class="keywordflow">goto</span> ERROR;
  }

  <span class="comment">/* 1 beam */</span>
  nentity = 1;
  <a class="code" href="a00348_a257959db0a78623caa051d11ceb2f8cb.html#a257959db0a78623caa051d11ceb2f8cb">SSCRUTE</a>(elementname);
  geotype = <a class="code" href="a01014_gaf49779dbddeb78a562de0f913d3d087c.html#gaf49779dbddeb78a562de0f913d3d087c" title="Cette routine renvoie le type géométrique mgeotype associé au modèle d&amp;#39;éléments...">MEDstructElementGeotype</a>(fid,elementname);
  <a class="code" href="a00348_a818470a84d2ad18a3fbb48170296cd95.html#a818470a84d2ad18a3fbb48170296cd95">ISCRUTE</a>(geotype);

  <span class="keywordflow">if</span> (<a class="code" href="a01011_ga091f97ef25e5bb96e3d941b85131cea9.html#ga091f97ef25e5bb96e3d941b85131cea9" title="Cette routine permet d&amp;#39;écrire dans un maillage le tableau des connectivités...">MEDmeshElementConnectivityWr</a>(fid,computmeshname, <a class="code" href="a00321_a8f72b6ceb3b6f5a67f9efd46cb90707a.html#a8f72b6ceb3b6f5a67f9efd46cb90707a">MED_NO_DT</a>, <a class="code" href="a00321_a95919207fd7a18ba26e6e03f04811e3f.html#a95919207fd7a18ba26e6e03f04811e3f">MED_NO_IT</a>, <a class="code" href="a00321_a609885580ce660eb5b7c80074d64f93f.html#a609885580ce660eb5b7c80074d64f93f">MED_UNDEF_DT</a>,
                                   <a class="code" href="a00321_aab0e957294723517d5c3641bb71b0470.html#aab0e957294723517d5c3641bb71b0470abdd6b14142920f599bbe4e97c4bb921e">MED_STRUCT_ELEMENT</a>, geotype, <a class="code" href="a00321_afcd26ca66a179b9aa82f5c90602c4ed8.html#afcd26ca66a179b9aa82f5c90602c4ed8a4ae92e7de0898383577cbba640006baa">MED_NODAL</a>,
                                   <a class="code" href="a00320_a0ac861d71fe5e0be056a86f9212f1c6a.html#a0ac861d71fe5e0be056a86f9212f1c6aa9a1509b3f93e5915a24f555890c73ee1">MED_FULL_INTERLACE</a>, nentity, beamconnectivity) &lt; 0 ) {
    <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : beam connectivity ...&quot;</span>);
    <span class="keywordflow">goto</span> ERROR;
  }

  <span class="comment">/* Get the dynamic geometry type of each struct element model.</span>
<span class="comment">     Then for each type, write the connectivity and variable(s) attribute(s) */</span>

  <span class="comment">/* 3 particles in the mesh */</span>
  strcpy(elementname,<a class="code" href="a00321_a786e7850e4d89a31047496e6fd48476d.html#a786e7850e4d89a31047496e6fd48476d">MED_PARTICLE_NAME</a>);
  geotype = <a class="code" href="a01014_gaf49779dbddeb78a562de0f913d3d087c.html#gaf49779dbddeb78a562de0f913d3d087c" title="Cette routine renvoie le type géométrique mgeotype associé au modèle d&amp;#39;éléments...">MEDstructElementGeotype</a>(fid,elementname);
  nentity = 3;
  <a class="code" href="a00348_a818470a84d2ad18a3fbb48170296cd95.html#a818470a84d2ad18a3fbb48170296cd95">ISCRUTE</a>(geotype);
  <span class="keywordflow">if</span> (<a class="code" href="a01011_ga091f97ef25e5bb96e3d941b85131cea9.html#ga091f97ef25e5bb96e3d941b85131cea9" title="Cette routine permet d&amp;#39;écrire dans un maillage le tableau des connectivités...">MEDmeshElementConnectivityWr</a>(fid, computmeshname, <a class="code" href="a00321_a8f72b6ceb3b6f5a67f9efd46cb90707a.html#a8f72b6ceb3b6f5a67f9efd46cb90707a">MED_NO_DT</a>, <a class="code" href="a00321_a95919207fd7a18ba26e6e03f04811e3f.html#a95919207fd7a18ba26e6e03f04811e3f">MED_NO_IT</a>, 0.0, 
                                   <a class="code" href="a00321_aab0e957294723517d5c3641bb71b0470.html#aab0e957294723517d5c3641bb71b0470abdd6b14142920f599bbe4e97c4bb921e">MED_STRUCT_ELEMENT</a>, geotype , <a class="code" href="a00321_afcd26ca66a179b9aa82f5c90602c4ed8.html#afcd26ca66a179b9aa82f5c90602c4ed8a4ae92e7de0898383577cbba640006baa">MED_NODAL</a>, <a class="code" href="a00320_a0ac861d71fe5e0be056a86f9212f1c6a.html#a0ac861d71fe5e0be056a86f9212f1c6aa9a1509b3f93e5915a24f555890c73ee1">MED_FULL_INTERLACE</a>,
                                   nentity, 0) &lt; 0) {
    <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : writing particles connectivity ...&quot;</span>);
    <span class="keywordflow">goto</span> ERROR;
  }

  <span class="comment">/* no support mesh =&gt; no connectivity, the particles are localized with an association between</span>
<span class="comment">     the mesh nodes and the label attribute defined in the struct model */</span>
  <span class="keywordflow">if</span> (<a class="code" href="a01014_gabebaf350609299e314c5950be79b0855.html#gabebaf350609299e314c5950be79b0855" title="Cette routine écrit les valeurs d&amp;#39;un attribut caractéristique variable sur...">MEDmeshStructElementVarAttWr</a>(fid, computmeshname, <a class="code" href="a00321_a8f72b6ceb3b6f5a67f9efd46cb90707a.html#a8f72b6ceb3b6f5a67f9efd46cb90707a">MED_NO_DT</a>, <a class="code" href="a00321_a95919207fd7a18ba26e6e03f04811e3f.html#a95919207fd7a18ba26e6e03f04811e3f">MED_NO_IT</a>,
                                   geotype, <a class="code" href="a00321_a1ccd58b1b04b04136557b619d5ce4c9d.html#a1ccd58b1b04b04136557b619d5ce4c9d">MED_PARTICLE_LABEL</a>,
                                   nentity, labels) &lt; 0 ) {
    <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : writing variable attributes  ...&quot;</span>);
    <span class="keywordflow">goto</span> ERROR;
  }


  <span class="comment">/* 2 balls */</span>
  strcpy(elementname,<a class="code" href="a00321_aa86785fc7c9bc73e184da6e687f79f2b.html#aa86785fc7c9bc73e184da6e687f79f2b">MED_BALL_NAME</a>);
  nentity = 2;
  geotype = <a class="code" href="a01014_gaf49779dbddeb78a562de0f913d3d087c.html#gaf49779dbddeb78a562de0f913d3d087c" title="Cette routine renvoie le type géométrique mgeotype associé au modèle d&amp;#39;éléments...">MEDstructElementGeotype</a>(fid,elementname);
  <span class="keywordflow">if</span> (<a class="code" href="a01011_ga091f97ef25e5bb96e3d941b85131cea9.html#ga091f97ef25e5bb96e3d941b85131cea9" title="Cette routine permet d&amp;#39;écrire dans un maillage le tableau des connectivités...">MEDmeshElementConnectivityWr</a>(fid,computmeshname, <a class="code" href="a00321_a8f72b6ceb3b6f5a67f9efd46cb90707a.html#a8f72b6ceb3b6f5a67f9efd46cb90707a">MED_NO_DT</a>, <a class="code" href="a00321_a95919207fd7a18ba26e6e03f04811e3f.html#a95919207fd7a18ba26e6e03f04811e3f">MED_NO_IT</a>, <a class="code" href="a00321_a609885580ce660eb5b7c80074d64f93f.html#a609885580ce660eb5b7c80074d64f93f">MED_UNDEF_DT</a>,
                                   <a class="code" href="a00321_aab0e957294723517d5c3641bb71b0470.html#aab0e957294723517d5c3641bb71b0470abdd6b14142920f599bbe4e97c4bb921e">MED_STRUCT_ELEMENT</a>, geotype, <a class="code" href="a00321_afcd26ca66a179b9aa82f5c90602c4ed8.html#afcd26ca66a179b9aa82f5c90602c4ed8a4ae92e7de0898383577cbba640006baa">MED_NODAL</a>,
                                   <a class="code" href="a00320_a0ac861d71fe5e0be056a86f9212f1c6a.html#a0ac861d71fe5e0be056a86f9212f1c6aa9a1509b3f93e5915a24f555890c73ee1">MED_FULL_INTERLACE</a>, nentity, ballconnectivity) &lt; 0 ) {
    <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : writing balls connectivity&quot;</span>);
    <span class="keywordflow">goto</span> ERROR;
  }

  <span class="comment">/* variable attribute : write ball diameter */</span>
  <span class="keywordflow">if</span> (<a class="code" href="a01014_gabebaf350609299e314c5950be79b0855.html#gabebaf350609299e314c5950be79b0855" title="Cette routine écrit les valeurs d&amp;#39;un attribut caractéristique variable sur...">MEDmeshStructElementVarAttWr</a>(fid, computmeshname, <a class="code" href="a00321_a8f72b6ceb3b6f5a67f9efd46cb90707a.html#a8f72b6ceb3b6f5a67f9efd46cb90707a">MED_NO_DT</a>, <a class="code" href="a00321_a95919207fd7a18ba26e6e03f04811e3f.html#a95919207fd7a18ba26e6e03f04811e3f">MED_NO_IT</a>,
                                   geotype, <a class="code" href="a00321_a0bd406d126080383a267241ac784fb41.html#a0bd406d126080383a267241ac784fb41">MED_BALL_DIAMETER</a>,
                                   nentity, balldiameter) &lt; 0 ) {
    <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : writing variable attributes ...&quot;</span>);
    <span class="keywordflow">goto</span> ERROR;
  }


  ret=0;
 ERROR:

  <span class="comment">/* close file */</span>
  <span class="keywordflow">if</span> (<a class="code" href="a01005_ga12a0e901c376be997a41a073ce426283.html#ga12a0e901c376be997a41a073ce426283" title="Fermeture d&amp;#39;un fichier MED.">MEDfileClose</a>(fid) &lt; 0) {
    <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : file closing&quot;</span>);
    ret=-1;
  }

  <span class="keywordflow">return</span> ret;
}

</pre></div> <p>La routine <a class="el" href="a01014_gae72636de4cc37f6833ea7ee4b831d363.html#gae72636de4cc37f6833ea7ee4b831d363">MEDstructElementInfoByName</a> / <a class="el" href="a01029_ga828b9c113fbc1ebee646a89fadfd5704.html#ga828b9c113fbc1ebee646a89fadfd5704">msesin</a> permet de r&eacute;cup&eacute;rer les informations relatives &agrave; un mod&egrave;le d'&eacute;l&eacute;ment de structure dont on conna&icirc;t le nom. Un autre mode d'acc&egrave;s en lecture consiste &agrave; utiliser la routine <a class="el" href="a01014_ga09f7085855b24af662c32291d0816a59.html#ga09f7085855b24af662c32291d0816a59">MEDnStructElement</a> / <a class="el" href="a01029_gae14abb17891b6f1f480ebc88c6e080a6.html#gae14abb17891b6f1f480ebc88c6e080a6">msense</a> pour lire le nombre de mod&egrave;le dans un fichier. Il s'agit ensuite d'it&eacute;rer sur ces mod&egrave;les. La routine <a class="el" href="a01014_ga6caf4937712d2a1d39ab1fd1482f61a3.html#ga6caf4937712d2a1d39ab1fd1482f61a3">MEDstructElementInfo</a> / <a class="el" href="a01029_gade1dab05fe45f14eb5bac31d4fd6cad5.html#gade1dab05fe45f14eb5bac31d4fd6cad5">msesei</a> permet de lire &agrave; chaque it&eacute;ration les informations relatives &agrave; un mod&egrave;le d'&eacute;l&eacute;ment de structure. Pour ce qui concerne la lecture des attributs constants, la routine <a class="el" href="a01014_gae18e73993c83d627ef6f3684694ab930.html#gae18e73993c83d627ef6f3684694ab930">MEDstructElementConstAttInfo</a> / <a class="el" href="a01029_gad8857ccbcfc7ff55deb000b9b19d5d63.html#gad8857ccbcfc7ff55deb000b9b19d5d63">msecai</a> permet de lire les informations relatives &agrave; ce type d'attribut et les routines <a class="el" href="a01014_gad1ed6ae520fcf95a45b6496b32a7a530.html#gad1ed6ae520fcf95a45b6496b32a7a530">MEDstructElementConstAttRd</a> / <a class="el" href="a01029_ga51727887d739a3b3732ba470e596ce3f.html#ga51727887d739a3b3732ba470e596ce3f">mserar</a>, <a class="el" href="a01029_ga3d106f2ce183a5d1bab0bceddf5ca8fd.html#ga3d106f2ce183a5d1bab0bceddf5ca8fd">mseiar</a>, <a class="el" href="a01029_gaae3d520c36392441c49f4ae22aa06285.html#gaae3d520c36392441c49f4ae22aa06285">msesar</a> permettent de lire les valeurs d'un attribut constant sans et avec un profil. Pour ce qui concerne les attributs variables, la routine <a class="el" href="a01014_ga0cc47995358440cb879ce89fd34eefc5.html#ga0cc47995358440cb879ce89fd34eefc5">MEDstructElementVarAttInfo</a> / <a class="el" href="a01029_gae7890c940eaa1f8c6d53f6893d0543ba.html#gae7890c940eaa1f8c6d53f6893d0543ba">msevai</a> permet de lire les informations relatives &agrave; ce type d'attribut et les routines <a class="el" href="a01014_gadaad15d6beac5cd36a36587894afa35c.html#gadaad15d6beac5cd36a36587894afa35c">MEDmeshStructElementVarAttRd</a> / <a class="el" href="a01029_ga3d46a75ff03a715feb119b7e396bd23d.html#ga3d46a75ff03a715feb119b7e396bd23d">mmhrar</a>, <a class="el" href="a01029_gab9dae00e51b20ccdd76a22ea3922b5c4.html#gab9dae00e51b20ccdd76a22ea3922b5c4">mmhiar</a>, <a class="el" href="a01029_ga38f1a310bad64fd75c1764da37bea06e.html#ga38f1a310bad64fd75c1764da37bea06e">mmhsar</a> permettent de lire les valeurs d'un attribut variable.  </p>
<p>A noter &eacute;galement l'existence : de la routine <a class="el" href="a01014_gab6cc5a1b97bee5ee0126092dd9d65771.html#gab6cc5a1b97bee5ee0126092dd9d65771">MEDstructElementName</a> / <a class="el" href="a01029_ga43e688e823d3ddd0c1c559451a3894ae.html#ga43e688e823d3ddd0c1c559451a3894ae">msesen</a> qui &agrave; partir du num&eacute;ro de type g&eacute;om&eacute;trique de l'&eacute;l&eacute;ment de structure, fournit le nom de cet &eacute;l&eacute;ment ; de la routine <a class="el" href="a01014_gaf49779dbddeb78a562de0f913d3d087c.html#gaf49779dbddeb78a562de0f913d3d087c">MEDstructElementGeotype</a> / <a class="el" href="a01029_ga83627d3323d4af0d0546f5585fdd7fcb.html#ga83627d3323d4af0d0546f5585fdd7fcb">msesgt</a> qui &agrave; partir du nom de l'&eacute;l&eacute;ment renvoie son type. Enfin la routine <a class="el" href="a01014_ga40d7f05b412bc08666b765a25c0388a1.html#ga40d7f05b412bc08666b765a25c0388a1">MEDstructElementAttSizeof</a> / <a class="el" href="a01029_gab1cd10c94f2ebafc51805c5490597253.html#gab1cd10c94f2ebafc51805c5490597253">mseasz</a> renvoie la taille en octets du type &eacute;l&eacute;mentaire d'un attribut constant ou variable, ce qui permet d'allouer correctement la taille des tableaux pour lire les valeurs des attributs.  </p>
<p>La routine <a class="el" href="a01016_ga3d3676f1d3f031c34f4383f950f0baa5.html#ga3d3676f1d3f031c34f4383f950f0baa5">MEDsupportMeshInfoByName</a> / <a class="el" href="a01031_gaed1bba40be52fad63bbecb0388a6722a.html#gaed1bba40be52fad63bbecb0388a6722a">msmsni</a> permet de r&eacute;cup&eacute;rer les informations relatives &agrave; un maillage support dont on conna&icirc;t le nom. Un autre mode d'acc&egrave;s en lecture consiste &agrave; utiliser la routine <a class="el" href="a01016_ga19e188df09fd462a4a91a6c5dd6ffe7d.html#ga19e188df09fd462a4a91a6c5dd6ffe7d">MEDnSupportMesh</a> / <a class="el" href="a01031_gaae8ae70328938d4c2b2fb620b81314fa.html#gaae8ae70328938d4c2b2fb620b81314fa">msmnsm</a> afin de lire le nombre de maillage support dans un fichier. Il s'agit ensuite d'it&eacute;rer sur ces maillages support et &agrave; chaque it&eacute;ration de lire les informations relative au maillage avec la routine <a class="el" href="a01016_ga23ddf2e0ab45f4e7a37be051aa5753e4.html#ga23ddf2e0ab45f4e7a37be051aa5753e4">MEDsupportMeshInfo</a> / <a class="el" href="a01031_ga051b0cd632e7bd97804bfd939cdbc25e.html#ga051b0cd632e7bd97804bfd939cdbc25e">msmsmi</a>. La lecture des coordonn&eacute;es des noeuds et de la connectivit&eacute; des mailles se fait avec les m&ecirc;mes routines que celles utilis&eacute;es pour les maillages de calcul. </p>
<p>Ce cas d'utilisation montre comment &agrave; partir d'un maillage de calcul, acc&eacute;der aux mod&egrave;les d'&eacute;l&eacute;ments de structure et aux maillages supports. </p>
<div class="fragment"><pre class="fragment"><span class="comment">/*  This file is part of MED.</span>
<span class="comment"> *</span>
<span class="comment"> *  COPYRIGHT (C) 1999 - 2012  EDF R&amp;D, CEA/DEN</span>
<span class="comment"> *  MED is free software: you can redistribute it and/or modify</span>
<span class="comment"> *  it under the terms of the GNU Lesser General Public License as published by</span>
<span class="comment"> *  the Free Software Foundation, either version 3 of the License, or</span>
<span class="comment"> *  (at your option) any later version.</span>
<span class="comment"> *</span>
<span class="comment"> *  MED is distributed in the hope that it will be useful,</span>
<span class="comment"> *  but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="comment"> *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<span class="comment"> *  GNU Lesser General Public License for more details.</span>
<span class="comment"> *</span>
<span class="comment"> *  You should have received a copy of the GNU Lesser General Public License</span>
<span class="comment"> *  along with MED.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span>
<span class="comment"> */</span>

<span class="preprocessor">#include &lt;med.h&gt;</span>
<span class="preprocessor">#define MESGERR 1</span>
<span class="preprocessor"></span><span class="preprocessor">#include &lt;med_utils.h&gt;</span>

<span class="preprocessor">#include &lt;string.h&gt;</span>

<span class="comment">/* </span>
<span class="comment"> * StructElement use case 3 : read struct element models in a file from a computation mesh </span>
<span class="comment"> */</span>

<span class="keywordtype">int</span> <a class="code" href="a00750_a3c04138a5bfe5d72780bb7e82a18e627.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a> (<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> **argv) {
  <a class="code" href="a00320_afa4ec8284026c8c5545e5333475fb65a.html#afa4ec8284026c8c5545e5333475fb65a">med_idt</a> fid;
  <a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> nmodels, nsmesh;
  <span class="keywordtype">int</span> i,j;
  <span class="keywordtype">char</span> elementname[<a class="code" href="a00321_a0ae989cbbfeecbb5296b3ceba8dab886.html#a0ae989cbbfeecbb5296b3ceba8dab886">MED_NAME_SIZE</a>+1]=<span class="stringliteral">&quot;&quot;</span>;
  <span class="keywordtype">char</span> supportmeshname[<a class="code" href="a00321_a0ae989cbbfeecbb5296b3ceba8dab886.html#a0ae989cbbfeecbb5296b3ceba8dab886">MED_NAME_SIZE</a>+1]=<span class="stringliteral">&quot;&quot;</span>;
  <span class="keyword">const</span> <span class="keywordtype">char</span> computmeshname[<a class="code" href="a00321_a0ae989cbbfeecbb5296b3ceba8dab886.html#a0ae989cbbfeecbb5296b3ceba8dab886">MED_NAME_SIZE</a>+1]=<span class="stringliteral">&quot;COMPUT_MESH&quot;</span>;
  <a class="code" href="a00321_a1043613afc3cd2e24785dfc7c0452ab8.html#a1043613afc3cd2e24785dfc7c0452ab8">med_geometry_type</a> *geotype;
  <a class="code" href="a00321_aab0e957294723517d5c3641bb71b0470.html#aab0e957294723517d5c3641bb71b0470">med_entity_type</a> entitype;
  <a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> elementdim;
  <a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> nnode,ncell;
  <a class="code" href="a00321_a1043613afc3cd2e24785dfc7c0452ab8.html#a1043613afc3cd2e24785dfc7c0452ab8">med_geometry_type</a> geocelltype;
  <a class="code" href="a00321_a23f7fa6d76886ed3c91dc33b59190dee.html#a23f7fa6d76886ed3c91dc33b59190dee">med_bool</a> anyprofile=0;
  <a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> nconstatt, *nvaratt=NULL;
  <span class="keywordtype">char</span> attname[<a class="code" href="a00321_a0ae989cbbfeecbb5296b3ceba8dab886.html#a0ae989cbbfeecbb5296b3ceba8dab886">MED_NAME_SIZE</a>+1]=<span class="stringliteral">&quot;&quot;</span>;
  <span class="keywordtype">char</span> profilename[<a class="code" href="a00321_a0ae989cbbfeecbb5296b3ceba8dab886.html#a0ae989cbbfeecbb5296b3ceba8dab886">MED_NAME_SIZE</a>+1]=<span class="stringliteral">&quot;&quot;</span>;
  <a class="code" href="a00321_ab6689ff0f472c1b88f02f030d34825b8.html#ab6689ff0f472c1b88f02f030d34825b8">med_attribute_type</a> atttype;
  <a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> nattcomp;
  <a class="code" href="a00321_aab0e957294723517d5c3641bb71b0470.html#aab0e957294723517d5c3641bb71b0470">med_entity_type</a> attentitype;
  <a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> profilesize;
  <a class="code" href="a00320_ab1eab99ca56ac95ce5b1c0e4ae0f095a.html#ab1eab99ca56ac95ce5b1c0e4ae0f095a">med_float</a> *value=NULL;
  <a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> size=0;
  <a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> meshdim, spacedim;
  <span class="keywordtype">char</span> description[<a class="code" href="a00321_ab69710ecf9f5257080a943579852d0f0.html#ab69710ecf9f5257080a943579852d0f0">MED_COMMENT_SIZE</a>+1]=<span class="stringliteral">&quot;&quot;</span>;
  <span class="keywordtype">char</span> axisname[3*<a class="code" href="a00321_a213ecd1a546eb96092b980a870bc386b.html#a213ecd1a546eb96092b980a870bc386b">MED_SNAME_SIZE</a>+1]=<span class="stringliteral">&quot;&quot;</span>;
  <span class="keywordtype">char</span> axisunit[3*<a class="code" href="a00321_a213ecd1a546eb96092b980a870bc386b.html#a213ecd1a546eb96092b980a870bc386b">MED_SNAME_SIZE</a>+1]=<span class="stringliteral">&quot;&quot;</span>;
  <a class="code" href="a00321_a57867e4bed1d104c865cfc9d23c9204d.html#a57867e4bed1d104c865cfc9d23c9204d">med_axis_type</a> axistype;
  <a class="code" href="a00320_ab1eab99ca56ac95ce5b1c0e4ae0f095a.html#ab1eab99ca56ac95ce5b1c0e4ae0f095a">med_float</a> *coordinates=NULL;
  <a class="code" href="a00321_a23f7fa6d76886ed3c91dc33b59190dee.html#a23f7fa6d76886ed3c91dc33b59190dee">med_bool</a> coordinatechangement;
  <a class="code" href="a00321_a23f7fa6d76886ed3c91dc33b59190dee.html#a23f7fa6d76886ed3c91dc33b59190dee">med_bool</a> geotransformation;
  <a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> nseg2;
  <a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> *seg2connectivity=NULL;
  <a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> nentities=0;
  <a class="code" href="a00321_a5b97067a30629cd60470d074691d6798.html#a5b97067a30629cd60470d074691d6798">med_sorting_type</a> sortingtype;
  <a class="code" href="a00321_a821a4dd94c5c6b095318432bdec8d8a1.html#a821a4dd94c5c6b095318432bdec8d8a1">med_mesh_type</a> meshtype;
  <a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> nstep;
  <span class="keywordtype">char</span> dtunit[<a class="code" href="a00321_a213ecd1a546eb96092b980a870bc386b.html#a213ecd1a546eb96092b980a870bc386b">MED_SNAME_SIZE</a>+1]=<span class="stringliteral">&quot;&quot;</span>;
  <span class="keywordtype">char</span> unitname[2*<a class="code" href="a00321_a213ecd1a546eb96092b980a870bc386b.html#a213ecd1a546eb96092b980a870bc386b">MED_SNAME_SIZE</a>+1]=<span class="stringliteral">&quot;&quot;</span>;
  <span class="keywordtype">int</span> ret=-1;

  <span class="comment">/* open file */</span>
  fid = <a class="code" href="a01005_ga9376a1654b7bf099c3f8941074c5fdfb.html#ga9376a1654b7bf099c3f8941074c5fdfb" title="Ouverture d&amp;#39;un fichier MED.">MEDfileOpen</a>(<span class="stringliteral">&quot;UsesCase_MEDstructElement_1.med&quot;</span>,<a class="code" href="a00321_adcd0322de9fec3b5e199ffeda3f44c85.html#adcd0322de9fec3b5e199ffeda3f44c85a616bf8345c622a34f0787f42eb400f25">MED_ACC_RDONLY</a>);
  <span class="keywordflow">if</span> (fid &lt; 0) {
    <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : file creation ...&quot;</span>);
    <span class="keywordflow">goto</span> ERROR;
  }

  <span class="comment">/* </span>
<span class="comment">   * ... In this case, we know that the MED file has only one mesh, </span>
<span class="comment">   * a real code working would check ... </span>
<span class="comment">   */</span>
  <span class="comment">/* read mesh informations : mesh dimension, space dimension ... */</span>
  <span class="keywordflow">if</span> (<a class="code" href="a01011_gaf5e84a05155579ded1ba18a672385f97.html#gaf5e84a05155579ded1ba18a672385f97" title="Cette routine permet de lire les informations relatives à un maillage en précisant...">MEDmeshInfoByName</a>(fid, computmeshname, &amp;spacedim, &amp;meshdim, &amp;meshtype, description, 
                        dtunit, &amp;sortingtype, &amp;nstep, &amp;axistype, axisname, unitname) &lt; 0) {
    <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : mesh info ...&quot;</span>);
    <span class="keywordflow">goto</span> ERROR;
  }

  <span class="comment">/* read how many struct element models in the mesh ? */</span>
  <span class="keywordflow">if</span> ((nmodels = <a class="code" href="a01011_ga45758103360dacf7b8a6c53ebfa4d7e5.html#ga45758103360dacf7b8a6c53ebfa4d7e5" title="Cette routine permet de lire le nombre d&amp;#39;entités dans un maillage pour une séquence...">MEDmeshnEntity</a>(fid, computmeshname, <a class="code" href="a00321_a8f72b6ceb3b6f5a67f9efd46cb90707a.html#a8f72b6ceb3b6f5a67f9efd46cb90707a">MED_NO_DT</a>, <a class="code" href="a00321_a95919207fd7a18ba26e6e03f04811e3f.html#a95919207fd7a18ba26e6e03f04811e3f">MED_NO_IT</a>, <a class="code" href="a00321_aab0e957294723517d5c3641bb71b0470.html#aab0e957294723517d5c3641bb71b0470abdd6b14142920f599bbe4e97c4bb921e">MED_STRUCT_ELEMENT</a>, <a class="code" href="a00321_ad9a7aaf0f9d302fa8e22f98cb8fe0371.html#ad9a7aaf0f9d302fa8e22f98cb8fe0371">MED_GEO_ALL</a>,
                              <a class="code" href="a00321_a25ee4b3675737fc23511b28b3245c61b.html#a25ee4b3675737fc23511b28b3245c61bab36865870154d1aa71cda04491911275">MED_UNDEF_DATATYPE</a>, <a class="code" href="a00321_afcd26ca66a179b9aa82f5c90602c4ed8.html#afcd26ca66a179b9aa82f5c90602c4ed8a2b1e772016688b78b808e96a44d1ee02">MED_NO_CMODE</a>,&amp;coordinatechangement,
                              &amp;geotransformation)) &lt; 0) {
    <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : number of nodes ...&quot;</span>);
    <span class="keywordflow">goto</span> ERROR;
  }

  geotype = (<a class="code" href="a00321_a1043613afc3cd2e24785dfc7c0452ab8.html#a1043613afc3cd2e24785dfc7c0452ab8">med_geometry_type</a> *) malloc(<span class="keyword">sizeof</span>(<a class="code" href="a00321_a1043613afc3cd2e24785dfc7c0452ab8.html#a1043613afc3cd2e24785dfc7c0452ab8">med_geometry_type</a>)*nmodels);
  nvaratt = (<a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> *) malloc(<span class="keyword">sizeof</span>(<a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a>)*nmodels);

  <span class="comment">/* Get the name and the geotype of each struct element model used in the computation mesh.</span>
<span class="comment">     For each struct element geotype read the connectivity and the attribute(s) </span>
<span class="comment">     The mesh support may be read if needed.</span>
<span class="comment">  */</span>
  <span class="keywordflow">for</span> (i=0;i&lt;nmodels;i++) {

    <span class="comment">/* read the geotype */</span>
    <span class="keywordflow">if</span> (<a class="code" href="a01011_ga2f2759063b94d0b418dff7aa7a985891.html#ga2f2759063b94d0b418dff7aa7a985891" title="Cette routine indique de façon itérative les types géométriques disponibles dans...">MEDmeshEntityInfo</a>(fid, computmeshname, <a class="code" href="a00321_a8f72b6ceb3b6f5a67f9efd46cb90707a.html#a8f72b6ceb3b6f5a67f9efd46cb90707a">MED_NO_DT</a>, <a class="code" href="a00321_a95919207fd7a18ba26e6e03f04811e3f.html#a95919207fd7a18ba26e6e03f04811e3f">MED_NO_IT</a>, <a class="code" href="a00321_aab0e957294723517d5c3641bb71b0470.html#aab0e957294723517d5c3641bb71b0470abdd6b14142920f599bbe4e97c4bb921e">MED_STRUCT_ELEMENT</a>,i+1,elementname,(geotype+i)) &lt; 0) {
      <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : name and type of MED_STRUCT_ELEMENT ...&quot;</span>);
      <span class="keywordflow">goto</span> ERROR;
    }

    <span class="comment">/* read how many MED_STRUCT_ELEMENT of type *(geotype+i) there is in the mesh */</span>
    <span class="keywordflow">if</span> ((nentities = <a class="code" href="a01011_ga45758103360dacf7b8a6c53ebfa4d7e5.html#ga45758103360dacf7b8a6c53ebfa4d7e5" title="Cette routine permet de lire le nombre d&amp;#39;entités dans un maillage pour une séquence...">MEDmeshnEntity</a>(fid, computmeshname, <a class="code" href="a00321_a8f72b6ceb3b6f5a67f9efd46cb90707a.html#a8f72b6ceb3b6f5a67f9efd46cb90707a">MED_NO_DT</a>, <a class="code" href="a00321_a95919207fd7a18ba26e6e03f04811e3f.html#a95919207fd7a18ba26e6e03f04811e3f">MED_NO_IT</a>, <a class="code" href="a00321_aab0e957294723517d5c3641bb71b0470.html#aab0e957294723517d5c3641bb71b0470abdd6b14142920f599bbe4e97c4bb921e">MED_STRUCT_ELEMENT</a>,*(geotype+i),
                                    <a class="code" href="a00321_a25ee4b3675737fc23511b28b3245c61b.html#a25ee4b3675737fc23511b28b3245c61bac845229e0179819897411d7cb9186824">MED_CONNECTIVITY</a>, <a class="code" href="a00321_afcd26ca66a179b9aa82f5c90602c4ed8.html#afcd26ca66a179b9aa82f5c90602c4ed8a4ae92e7de0898383577cbba640006baa">MED_NODAL</a>, &amp;coordinatechangement,
                                    &amp;geotransformation)) &lt; 0) {
      <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : number of MED_STRUCT_ELEMENT ...&quot;</span>);
      <span class="keywordflow">goto</span> ERROR;
    }

    <span class="comment">/* read informations about the model */</span>
    <span class="keywordflow">if</span> (<a class="code" href="a01014_gae72636de4cc37f6833ea7ee4b831d363.html#gae72636de4cc37f6833ea7ee4b831d363" title="Cette routine décrit les caractéristiques d&amp;#39;un modèle d&amp;#39;élément de structure...">MEDstructElementInfoByName</a>(fid, elementname, geotype+i, &amp;elementdim,
                                   supportmeshname, &amp;entitype, &amp;nnode, &amp;ncell,
                                   &amp;geocelltype, &amp;nconstatt, &amp;anyprofile, nvaratt+i) &lt; 0) {
      <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : struct element models information ...&quot;</span>);
      <span class="keywordflow">goto</span> ERROR;
    }
    
    <span class="comment">/* read support mesh  */</span>
    <span class="comment">/* TODO : Ceci est optionnel dans ce usescase */</span> 
    <span class="keywordflow">if</span> (strcmp(supportmeshname,<span class="stringliteral">&quot;&quot;</span>)) {
      <span class="keywordflow">if</span> ( <a class="code" href="a01016_ga3d3676f1d3f031c34f4383f950f0baa5.html#ga3d3676f1d3f031c34f4383f950f0baa5" title="Cette routine permet de lire les informations relatives à un maillage support en...">MEDsupportMeshInfoByName</a>(fid, supportmeshname, &amp;spacedim, &amp;meshdim, description,
                                    &amp;axistype, axisname, axisunit) &lt; 0 ) {
        <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : read information about mesh support ...&quot;</span>);
        <span class="keywordflow">goto</span> ERROR;
      }

      <a class="code" href="a00348_a818470a84d2ad18a3fbb48170296cd95.html#a818470a84d2ad18a3fbb48170296cd95">ISCRUTE</a>(nnode);
      <span class="comment">/* read how many nodes in the support mesh */</span>
      <span class="comment">/* Ceci est optionnel dans ce usescase */</span> 
      <span class="keywordflow">if</span> ((nnode = <a class="code" href="a01011_ga45758103360dacf7b8a6c53ebfa4d7e5.html#ga45758103360dacf7b8a6c53ebfa4d7e5" title="Cette routine permet de lire le nombre d&amp;#39;entités dans un maillage pour une séquence...">MEDmeshnEntity</a>(fid, supportmeshname, <a class="code" href="a00321_a8f72b6ceb3b6f5a67f9efd46cb90707a.html#a8f72b6ceb3b6f5a67f9efd46cb90707a">MED_NO_DT</a>, <a class="code" href="a00321_a95919207fd7a18ba26e6e03f04811e3f.html#a95919207fd7a18ba26e6e03f04811e3f">MED_NO_IT</a>, <a class="code" href="a00321_aab0e957294723517d5c3641bb71b0470.html#aab0e957294723517d5c3641bb71b0470a074507163b07b6d764823a78c5c07f0f">MED_NODE</a>, <a class="code" href="a00321_a9a2843c7d6eacffdd9377b5bfb8a6de3.html#a9a2843c7d6eacffdd9377b5bfb8a6de3">MED_NONE</a>,
                                  <a class="code" href="a00321_a25ee4b3675737fc23511b28b3245c61b.html#a25ee4b3675737fc23511b28b3245c61bad78949eab3c743083dfbf687c92bbdcb">MED_COORDINATE</a>, <a class="code" href="a00321_afcd26ca66a179b9aa82f5c90602c4ed8.html#afcd26ca66a179b9aa82f5c90602c4ed8a2b1e772016688b78b808e96a44d1ee02">MED_NO_CMODE</a>,&amp;coordinatechangement,
                                  &amp;geotransformation)) &lt; 0) {
        <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : read number of nodes ...&quot;</span>);
        <span class="keywordflow">goto</span> ERROR;
      }
     <a class="code" href="a00348_a818470a84d2ad18a3fbb48170296cd95.html#a818470a84d2ad18a3fbb48170296cd95">ISCRUTE</a>(nnode);

      <span class="comment">/* read support mesh nodes coordinates */</span>
      <span class="comment">/* Ceci est optionnel dans ce usescase */</span> 
      coordinates = (<a class="code" href="a00320_ab1eab99ca56ac95ce5b1c0e4ae0f095a.html#ab1eab99ca56ac95ce5b1c0e4ae0f095a">med_float</a>*) malloc(<span class="keyword">sizeof</span>(<a class="code" href="a00320_ab1eab99ca56ac95ce5b1c0e4ae0f095a.html#ab1eab99ca56ac95ce5b1c0e4ae0f095a">med_float</a>)*nnode*spacedim);

      <span class="keywordflow">if</span> (<a class="code" href="a01011_ga392a4bd4e6d340020755de7353f8a528.html#ga392a4bd4e6d340020755de7353f8a528" title="Cette routine permet de lire dans un maillage le tableau des coordonnées des noeuds...">MEDmeshNodeCoordinateRd</a>(fid, supportmeshname, <a class="code" href="a00321_a8f72b6ceb3b6f5a67f9efd46cb90707a.html#a8f72b6ceb3b6f5a67f9efd46cb90707a">MED_NO_DT</a>, <a class="code" href="a00321_a95919207fd7a18ba26e6e03f04811e3f.html#a95919207fd7a18ba26e6e03f04811e3f">MED_NO_IT</a>, <a class="code" href="a00320_a0ac861d71fe5e0be056a86f9212f1c6a.html#a0ac861d71fe5e0be056a86f9212f1c6aa9a1509b3f93e5915a24f555890c73ee1">MED_FULL_INTERLACE</a>,
                                  coordinates) &lt; 0) {
        <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : read nodes coordinates ...&quot;</span>);
        free(coordinates);
        <span class="keywordflow">goto</span> ERROR;
      }

      <span class="comment">/* free memory */</span>
      free(coordinates);

      <span class="comment">/* read how many MED_SEG2 cells in the support mesh */</span>
      <span class="comment">/* Ceci est optionnel dans ce usescase */</span> 
      <span class="keywordflow">if</span> ((nseg2 = <a class="code" href="a01011_ga45758103360dacf7b8a6c53ebfa4d7e5.html#ga45758103360dacf7b8a6c53ebfa4d7e5" title="Cette routine permet de lire le nombre d&amp;#39;entités dans un maillage pour une séquence...">MEDmeshnEntity</a>(fid, supportmeshname, <a class="code" href="a00321_a8f72b6ceb3b6f5a67f9efd46cb90707a.html#a8f72b6ceb3b6f5a67f9efd46cb90707a">MED_NO_DT</a>, <a class="code" href="a00321_a95919207fd7a18ba26e6e03f04811e3f.html#a95919207fd7a18ba26e6e03f04811e3f">MED_NO_IT</a>, <a class="code" href="a00321_aab0e957294723517d5c3641bb71b0470.html#aab0e957294723517d5c3641bb71b0470a227d14957ec5f221685cb1d6ec3b6c67">MED_CELL</a>,geocelltype,
                                  <a class="code" href="a00321_a25ee4b3675737fc23511b28b3245c61b.html#a25ee4b3675737fc23511b28b3245c61bac845229e0179819897411d7cb9186824">MED_CONNECTIVITY</a>, <a class="code" href="a00321_afcd26ca66a179b9aa82f5c90602c4ed8.html#afcd26ca66a179b9aa82f5c90602c4ed8a4ae92e7de0898383577cbba640006baa">MED_NODAL</a>, &amp;coordinatechangement,
                                  &amp;geotransformation)) &lt; 0) {
        <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : number of MED_SEG2 ...&quot;</span>);
        <span class="keywordflow">goto</span> ERROR;
      }
     <a class="code" href="a00348_a818470a84d2ad18a3fbb48170296cd95.html#a818470a84d2ad18a3fbb48170296cd95">ISCRUTE</a>(nseg2);
     <a class="code" href="a00348_a818470a84d2ad18a3fbb48170296cd95.html#a818470a84d2ad18a3fbb48170296cd95">ISCRUTE</a>(ncell);
      <span class="comment">/* read MED_SEG2 connectivity in the support mesh */</span>
      <span class="keywordflow">if</span> (nseg2 &gt; 0) {
        seg2connectivity = (<a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> *) malloc(<span class="keyword">sizeof</span>(<a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a>)*nseg2*2);

        <span class="keywordflow">if</span> (<a class="code" href="a01011_ga014f716ad13c72466b4aa94237876bf5.html#ga014f716ad13c72466b4aa94237876bf5" title="Cette routine permet de lire dans un maillage le tableau des connectivités pour...">MEDmeshElementConnectivityRd</a>(fid, supportmeshname, <a class="code" href="a00321_a8f72b6ceb3b6f5a67f9efd46cb90707a.html#a8f72b6ceb3b6f5a67f9efd46cb90707a">MED_NO_DT</a>, <a class="code" href="a00321_a95919207fd7a18ba26e6e03f04811e3f.html#a95919207fd7a18ba26e6e03f04811e3f">MED_NO_IT</a>, <a class="code" href="a00321_aab0e957294723517d5c3641bb71b0470.html#aab0e957294723517d5c3641bb71b0470a227d14957ec5f221685cb1d6ec3b6c67">MED_CELL</a>,
                                         geocelltype, <a class="code" href="a00321_afcd26ca66a179b9aa82f5c90602c4ed8.html#afcd26ca66a179b9aa82f5c90602c4ed8a4ae92e7de0898383577cbba640006baa">MED_NODAL</a>, <a class="code" href="a00320_a0ac861d71fe5e0be056a86f9212f1c6a.html#a0ac861d71fe5e0be056a86f9212f1c6aa9a1509b3f93e5915a24f555890c73ee1">MED_FULL_INTERLACE</a>, seg2connectivity) &lt; 0) {
          <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : MED_SEG2 connectivity ...&quot;</span>);
          free(seg2connectivity);
          <span class="keywordflow">goto</span> ERROR;
        }
        free(seg2connectivity);
      }
    }

    <span class="comment">/* read constant attribute(s) */</span>
    <span class="comment">/* Optionnel pour ce usescase (cf. usescase lecture modèle) */</span>
    <span class="keywordflow">for</span> (j=0; j&lt;nconstatt; j++) {
      <span class="keywordflow">if</span> ( <a class="code" href="a01014_gae18e73993c83d627ef6f3684694ab930.html#gae18e73993c83d627ef6f3684694ab930" title="Cette routine décrit les caractéristiques d&amp;#39;un attribut constant de modèle...">MEDstructElementConstAttInfo</a>(fid, elementname, j+1,
                                        attname, &amp;atttype, &amp;nattcomp, &amp;attentitype,
                                        profilename, &amp;profilesize) &lt; 0) {
        <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : const attribute information ...&quot;</span>);
        <span class="keywordflow">goto</span> ERROR;
      }

      <span class="comment">/* if there is a profile =&gt; read the profile, see UsesCase_MEDprofile_2 */</span>

      <span class="comment">/* memory allocation */</span>
      <span class="keywordflow">if</span> (profilesize != 0)
        size = profilesize*nattcomp*<a class="code" href="a01014_ga40d7f05b412bc08666b765a25c0388a1.html#ga40d7f05b412bc08666b765a25c0388a1" title="Cette routine renvoie la taille en octets du type élémentaire atttype.">MEDstructElementAttSizeof</a>(atttype);
      <span class="keywordflow">else</span>
        <span class="keywordflow">if</span> (attentitype== <a class="code" href="a00321_aab0e957294723517d5c3641bb71b0470.html#aab0e957294723517d5c3641bb71b0470a074507163b07b6d764823a78c5c07f0f">MED_NODE</a>)
          size = nnode*nattcomp*<a class="code" href="a01014_ga40d7f05b412bc08666b765a25c0388a1.html#ga40d7f05b412bc08666b765a25c0388a1" title="Cette routine renvoie la taille en octets du type élémentaire atttype.">MEDstructElementAttSizeof</a>(atttype);
        <span class="keywordflow">else</span>
          size = ncell*nattcomp*<a class="code" href="a01014_ga40d7f05b412bc08666b765a25c0388a1.html#ga40d7f05b412bc08666b765a25c0388a1" title="Cette routine renvoie la taille en octets du type élémentaire atttype.">MEDstructElementAttSizeof</a>(atttype);
      <span class="keywordflow">if</span> ( atttype == <a class="code" href="a00321_ab6689ff0f472c1b88f02f030d34825b8.html#ab6689ff0f472c1b88f02f030d34825b8af8c39990c775c4813629cfb6947cbc9e">MED_ATT_NAME</a>) ++size;
      <a class="code" href="a00348_a818470a84d2ad18a3fbb48170296cd95.html#a818470a84d2ad18a3fbb48170296cd95">ISCRUTE</a>(size);
      value = (<a class="code" href="a00320_ab1eab99ca56ac95ce5b1c0e4ae0f095a.html#ab1eab99ca56ac95ce5b1c0e4ae0f095a">med_float</a> *) malloc(size);


      <span class="comment">/* read attribute(s) value(s) */</span>
      <span class="keywordflow">if</span> ( <a class="code" href="a01014_gad1ed6ae520fcf95a45b6496b32a7a530.html#gad1ed6ae520fcf95a45b6496b32a7a530" title="Cette routine lit la valeur d&amp;#39;un attribut caractéristique constant d&amp;#39;un...">MEDstructElementConstAttRd</a>(fid, elementname, attname, (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *)value ) &lt; 0 ) {
        <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : const attribute value ...&quot;</span>);
        free(value);
        <span class="keywordflow">goto</span> ERROR;
      }

      <span class="comment">/* memory deallocation */</span>
      free(value);
    }

    <span class="comment">/* read variable attribute(s) */</span>
    <span class="keywordflow">for</span> (j=0; j&lt;*(nvaratt+i); j++) {

      <span class="comment">/* read informations about the attribute */</span>
      <span class="keywordflow">if</span> ( <a class="code" href="a01014_ga0cc47995358440cb879ce89fd34eefc5.html#ga0cc47995358440cb879ce89fd34eefc5" title="Cette routine décrit les caractéristiques d&amp;#39;un attribut variable de modèle...">MEDstructElementVarAttInfo</a>(fid, elementname, j+1, 
                                      attname, &amp;atttype, &amp;nattcomp) &lt; 0) {
            <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : var attribute information ...&quot;</span>);
            <span class="keywordflow">goto</span> ERROR;
      }
      
      <span class="comment">/* memory allocation */</span>
      size = nentities*nattcomp*<a class="code" href="a01014_ga40d7f05b412bc08666b765a25c0388a1.html#ga40d7f05b412bc08666b765a25c0388a1" title="Cette routine renvoie la taille en octets du type élémentaire atttype.">MEDstructElementAttSizeof</a>(atttype);
      <span class="keywordflow">if</span> ( atttype == <a class="code" href="a00321_ab6689ff0f472c1b88f02f030d34825b8.html#ab6689ff0f472c1b88f02f030d34825b8af8c39990c775c4813629cfb6947cbc9e">MED_ATT_NAME</a>) ++size;
      <a class="code" href="a00348_a818470a84d2ad18a3fbb48170296cd95.html#a818470a84d2ad18a3fbb48170296cd95">ISCRUTE</a>(size);
      value = (<a class="code" href="a00320_ab1eab99ca56ac95ce5b1c0e4ae0f095a.html#ab1eab99ca56ac95ce5b1c0e4ae0f095a">med_float</a> *) malloc((size)*<span class="keyword">sizeof</span>(char));
      
      <span class="comment">/* read attribute values */</span>
      <span class="keywordflow">if</span> (<a class="code" href="a01014_gadaad15d6beac5cd36a36587894afa35c.html#gadaad15d6beac5cd36a36587894afa35c" title="Cette routine lit les valeurs d&amp;#39;un attribut caractéristique variable sur les...">MEDmeshStructElementVarAttRd</a>(fid, computmeshname, <a class="code" href="a00321_a8f72b6ceb3b6f5a67f9efd46cb90707a.html#a8f72b6ceb3b6f5a67f9efd46cb90707a">MED_NO_DT</a>, <a class="code" href="a00321_a95919207fd7a18ba26e6e03f04811e3f.html#a95919207fd7a18ba26e6e03f04811e3f">MED_NO_IT</a>,
                                       *(geotype+i), attname, value ) &lt; 0) {
        <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : read variable attributes values ...&quot;</span>);
        free(value);
        <span class="keywordflow">goto</span> ERROR;
      }

      <span class="comment">/* free memory */</span>
      free(value);
      
    }
    
  }

  ret=0;
 ERROR:

  <span class="comment">/* free memory */</span>
  free(geotype);
  free(nvaratt);

  <span class="comment">/* close file */</span>
  <span class="keywordflow">if</span> (<a class="code" href="a01005_ga12a0e901c376be997a41a073ce426283.html#ga12a0e901c376be997a41a073ce426283" title="Fermeture d&amp;#39;un fichier MED.">MEDfileClose</a>(fid) &lt; 0) {
    <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : file closing ...&quot;</span>);
    ret=-1;
  }

  <span class="keywordflow">return</span> ret;
}

</pre></div> <h3 style="page-break-before: always"><a class="anchor" id="6."></a>Ecriture et lecture en parall&egrave;le par la d&eacute;composition de domaine </h3>
<p>En vue de calculs parall&egrave;les, le domaine de calcul est subdivis&eacute; en sous-domaines o&ugrave; se r&eacute;partissent les maillages. Classiquement, chaque sous-domaine sera trait&eacute; par un seul processeur qui aura uniquement acc&egrave;s aux donn&eacute;es des autres sous-domaines par l'interm&eacute;diaire de messages. </p>
<div align="center">
<img src="../png/sous-domaines.png" alt="sous-domaines.png"/>
</div>
  <p><br/>
Du point de vue du stockage, un maillage distribu&eacute; a la m&ecirc;me structure qu'un maillage MED classique mais ses composantes (entit&eacute;s g&eacute;om&eacute;trique, familles, groupes) peuvent &ecirc;tre r&eacute;parties sur plusieurs sous-domaines affect&eacute;s &agrave; des processeurs disjoints. Lors de cette distribution certains sommets, faces, ar&ecirc;tes ou mailles se retrouvent sur la fronti&egrave;re commune de deux sous-domaines. L'ensemble de ces &eacute;l&eacute;ments communs &agrave; deux sous-domaines constitue un joint. Dans un cadre tr&egrave;s g&eacute;n&eacute;ral, les &eacute;l&eacute;ments communs &agrave; deux sous-domaines peuvent appara&icirc;tre comme : la jointure de deux maillages qui se correspondent parfaitement (on parle alors de <em>raccordement conforme), </em>la jointure de deux maillages de pavage diff&eacute;rent (<em>raccordement non conforme),</em> le recouvrement de deux maillages qu'il soit conforme ou non.  </p>
<p>La notion de joint est assez g&eacute;n&eacute;rale pour permettre de stocker ces trois types d'interface. Elle consiste &agrave; donner la liste des couples des num&eacute;ros correspondant des entit&eacute;s en regard vues du domaine local et vues du domaine distant.  </p>
<p><br/>
  </p>
<div align="center">
<img src="../png/description-joint.png" alt="description-joint.png"/>
</div>
  <p><a class="anchor" id="1.3"></a><br/>
Un maillage distribu&eacute; est donc enti&egrave;rement d&eacute;termin&eacute; par la donn&eacute;e des maillages affect&eacute;s &agrave; chacun des sous-domaines, par la d&eacute;finition de  joints  - raccord entre les maillages de sous-domaines voisins, par une num&eacute;rotation globale optionnelle des entit&eacute;s.  </p>
<p>Comme les maillages sont distribu&eacute;s, les donn&eacute;es MED s'y rattachant peuvent &ecirc;tre stock&eacute;es dans plusieurs fichiers. La liste de ces fichiers est rassembl&eacute;e dans un fichier ma&icirc;tre au format ASCII. Ce fichier permet de rep&eacute;rer o&ugrave; se trouvent stock&eacute;es les parties de maillages distribu&eacute;es correspondant &agrave; chaque sous-domaine. Il contient : un ent&ecirc;te d'identification ; le nombre de sous-domaines sur lesquels sont distribu&eacute;s les maillages ; les informations n&eacute;cessaires pour rep&eacute;rer les parties de maillages affect&eacute;es &agrave; chaque sous-domaine. Pour ce faire, il y a autant de lignes que de parties de maillages distribu&eacute;s. Chaque ligne se compose : du nom de maillage global, du num&eacute;ro de sous-domaine concern&eacute;, du nom de maillage local correspondant au maillage global sur ce sous-domaine, du nom de la machine h&eacute;bergeant le fichier MED contenant ces informations (ce nom peut &eacute;ventuellement &ecirc;tre une adresse IP de la machine et ne comportera pas de blanc), du chemin absolu ou relatif menant &agrave; ce fichier  </p>
<p>Le fichier ASCII sera au format unix, et le retour &agrave; la ligne est un caract&egrave;re ASCII 10 (caract&egrave;re Carriage Return seul sans caract&egrave;re Line Feed comme sous windows). Dans les chemins, les sous r&eacute;pertoires seront d&eacute;limit&eacute;s par le caract&egrave;re '/'. Toute ligne commen&ccedil;ant par '#' sera ignor&eacute;e par la librairie (commentaires). Mais un '#' en cours de ligne ne sera pas interpr&eacute;t&eacute; comme un commentaire. <br/>
<br/>
Les fichiers MED correspondant &agrave; chaque sous-domaine sont rep&eacute;r&eacute;s par leur chemin absolu ou relatif dans le syst&egrave;me de fichier. Dans le cas relatif, l'acc&egrave;s aux fichiers depuis la librairie pourra d&eacute;pendre de la machine ou du syst&egrave;me d'exploitation sur lequel on s'ex&eacute;cute. A charge de l'utilisateur de v&eacute;rifier l'interpr&eacute;tation coh&eacute;rente des chemins de fichiers relatifs. <br/>
<br/>
<br/>
  </p>
<div align="center">
<img src="../png/temp-vitesse.png" alt="temp-vitesse.png"/>
</div>
  <p><br/>
<br/>
<br/>
  </p>
<p>Voici un exemple de fichier ma&icirc;tre, d&eacute;crivant la r&eacute;partition de 2 maillages VIT et TEMP sur 4 sous domaines disjoints. Le calcul s'effectue sur un solide (o&ugrave; seule est d&eacute;finie la temp&eacute;rature) baign&eacute;e d'un liquide (ou sont d&eacute;finies les vitesses et temp&eacute;ratures)  </p>
<pre># MED Fichier v3.0
#
# Nombre de sous-domaines
4
#
# fichiers MED par sous-domaine
VIT 1 VIT_1 localhost /absolute/path/fichier_dom_1
VIT 2 VIT_2 localhost /absolute/path/fichier_dom_2
TEMP 1 TEMP_1 localhost /absolute/path/fichier_dom_1
TEMP 2 TEMP_2 localhost /absolute/path/fichier_dom_2
TEMP 3 TEMP_3 localhost /absolute/path/fichier_dom_3
TEMP 4 TEMP_4 localhost /absolute/path/fichier_dom_4</pre><p>La cr&eacute;ation ou la transformation du fichier ma&icirc;tre est &agrave; la charge du d&eacute;coupeur. On suppose que ce fichier est coh&eacute;rent dans l'utilisation de la librairie. </p>
<p>A l'&eacute;criture, les routines disponibles permettent de : cr&eacute;er un joint dans un maillage (<a class="el" href="a01015_gab139ed60d40b7a61416f46eb5ff2dac2.html#gab139ed60d40b7a61416f46eb5ff2dac2">MEDsubdomainJointCr</a> / <a class="el" href="a01030_ga967b0b3fe45b38a26ef8bee3083c9703.html#ga967b0b3fe45b38a26ef8bee3083c9703">msdjcr</a>) ; &eacute;crire un tableau de correspondances entre bin&ocirc;mes d'entit&eacute;s du maillage dans un joint (<a class="el" href="a01015_ga78dd95846735f895e33876bf69e1d5a4.html#ga78dd95846735f895e33876bf69e1d5a4">MEDsubdomainCorrespondenceWr</a> / <a class="el" href="a01030_ga1bfa5efab2c4edb54e5046707251c8ac.html#ga1bfa5efab2c4edb54e5046707251c8ac">msdcrw</a>) ; &eacute;crire la num&eacute;rotation globale associ&eacute;e &agrave; un type d'entit&eacute; pour la rep&eacute;rer sur le domaine global (<a class="el" href="a01011_ga7368d6375462e4390041bae334cfcb43.html#ga7368d6375462e4390041bae334cfcb43">MEDmeshGlobalNumberWr</a> / <a class="el" href="a01026_ga556ce42f1aed2f6d9a87a5300701ae39.html#ga556ce42f1aed2f6d9a87a5300701ae39">mmhgnw</a>). </p>
<p><br/>
  </p>
<p>A la lecture, les routines disponibles permettent de : lire le nombre de joints dans un maillage (<a class="el" href="a01015_ga90067f55ea12412a0688c6c304204e65.html#ga90067f55ea12412a0688c6c304204e65">MEDnSubdomainJoint</a> / <a class="el" href="a01030_gad174a460873cbe35cc3d93daec020bd1.html#gad174a460873cbe35cc3d93daec020bd1">msdnjn</a>) ; lire les informations concernant un joint (<a class="el" href="a01015_ga25a6e4dff83d09a8f46ed161136bf44c.html#ga25a6e4dff83d09a8f46ed161136bf44c">MEDsubdomainJointInfo</a> / <a class="el" href="a01030_ga30cf9dfc3d3d65234d16933deae2a5bf.html#ga30cf9dfc3d3d65234d16933deae2a5bf">msdjni</a>), lire le nombre de couple en correspondance d'un type donn&eacute; dans un joint (<a class="el" href="a01015_gafcee5c816538dcc38fabe842ee00c1c7.html#gafcee5c816538dcc38fabe842ee00c1c7">MEDsubdomainComputingStepInfo</a> / <a class="el" href="a01030_gabdc2af50a919ae0ec50ec37f15ec6c2a.html#gabdc2af50a919ae0ec50ec37f15ec6c2a">msdcsi</a>) ; lire le nombre d'entit&eacute;s en correspondance dans un joint pour un couple d'entit&eacute;s et une s&eacute;quence de calcul donn&eacute;s (<a class="el" href="a01015_ga47aeb9b5072799cc4a3a0e672ad5d29f.html#ga47aeb9b5072799cc4a3a0e672ad5d29f">MEDsubdomainCorrespondenceSize</a> / <a class="el" href="a01030_gab1d6e6d9186fbce2111e7031cb416745.html#gab1d6e6d9186fbce2111e7031cb416745">msdcsz</a>); lire les informations sur les couples d'entit&eacute;s en correspondance dans un joint pour une s&eacute;quence de calcul donn&eacute;e (<a class="el" href="a01015_gae6262eba284cc7118a1c6b2617d471b4.html#gae6262eba284cc7118a1c6b2617d471b4">MEDsubdomainCorrespondenceSizeInfo</a> / <a class="el" href="a01030_gaf2b0e91ece651744f10dc5cac8c25b2a.html#gaf2b0e91ece651744f10dc5cac8c25b2a">msdszi</a>) ; lire un tableau de correspondances entre bin&ocirc;mes d'entit&eacute;s du maillage dans un joint (<a class="el" href="a01015_ga5170722fcd38ed65987bea79c4ac9d3b.html#ga5170722fcd38ed65987bea79c4ac9d3b">MEDsubdomainCorrespondenceRd</a> / <a class="el" href="a01030_gae2cb7634189a49d02c34a8a73355b50e.html#gae2cb7634189a49d02c34a8a73355b50e">msdcrr</a>) ; lire la num&eacute;rotation globale associ&eacute;e &agrave; un type d'entit&eacute; pour la rep&eacute;rer sur le domaine global (<a class="el" href="a01011_gab28f41670fee25385d66d45a0d86d93f.html#gab28f41670fee25385d66d45a0d86d93f">MEDmeshGlobalNumberRd</a> / <a class="el" href="a01026_gaad05a0bbb3dd90936857ce5b0dfecb8e.html#gaad05a0bbb3dd90936857ce5b0dfecb8e">mmhgnr</a>). </p>
<p>Les cas d'utilisation suivant illustrent comment &eacute;crire et lire des maillages avec des joints et un syst&egrave;me de num&eacute;rotation global. </p>
<div class="fragment"><pre class="fragment"><span class="comment">/*  This file is part of MED.</span>
<span class="comment"> *</span>
<span class="comment"> *  COPYRIGHT (C) 1999 - 2012  EDF R&amp;D, CEA/DEN</span>
<span class="comment"> *  MED is free software: you can redistribute it and/or modify</span>
<span class="comment"> *  it under the terms of the GNU Lesser General Public License as published by</span>
<span class="comment"> *  the Free Software Foundation, either version 3 of the License, or</span>
<span class="comment"> *  (at your option) any later version.</span>
<span class="comment"> *</span>
<span class="comment"> *  MED is distributed in the hope that it will be useful,</span>
<span class="comment"> *  but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="comment"> *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<span class="comment"> *  GNU Lesser General Public License for more details.</span>
<span class="comment"> *</span>
<span class="comment"> *  You should have received a copy of the GNU Lesser General Public License</span>
<span class="comment"> *  along with MED.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span>
<span class="comment"> */</span>

<span class="comment">/******************************************************************************</span>
<span class="comment"> * - Nom du fichier : test29.c</span>
<span class="comment"> *</span>
<span class="comment"> * - Description : ecriture d&apos;un joint dans un maillage MED </span>
<span class="comment"> *</span>
<span class="comment"> *****************************************************************************/</span>

<span class="preprocessor">#include &lt;med.h&gt;</span>
<span class="preprocessor">#define MESGERR 1</span>
<span class="preprocessor"></span><span class="preprocessor">#include &lt;med_utils.h&gt;</span>

<span class="preprocessor">#ifdef DEF_LECT_ECR</span>
<span class="preprocessor"></span><span class="preprocessor">#define MODE_ACCES MED_ACC_RDWR</span>
<span class="preprocessor"></span><span class="preprocessor">#elif DEF_LECT_AJOUT</span>
<span class="preprocessor"></span><span class="preprocessor">#define MODE_ACCES MED_ACC_RDEXT</span>
<span class="preprocessor"></span><span class="preprocessor">#else</span>
<span class="preprocessor"></span><span class="preprocessor">#define MODE_ACCES MED_ACC_CREAT</span>
<span class="preprocessor"></span><span class="preprocessor">#endif</span>
<span class="preprocessor"></span>
<span class="keywordtype">int</span> <a class="code" href="a00750_a3c04138a5bfe5d72780bb7e82a18e627.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a> (<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> **argv)


{
  <a class="code" href="a00320_afa4ec8284026c8c5545e5333475fb65a.html#afa4ec8284026c8c5545e5333475fb65a">med_idt</a> fid;

  <span class="keywordtype">char</span> maa[<a class="code" href="a00321_a0ae989cbbfeecbb5296b3ceba8dab886.html#a0ae989cbbfeecbb5296b3ceba8dab886">MED_NAME_SIZE</a>+1]= <span class="stringliteral">&quot;maa1&quot;</span>;
  <span class="keywordtype">char</span> jnt[<a class="code" href="a00321_a0ae989cbbfeecbb5296b3ceba8dab886.html#a0ae989cbbfeecbb5296b3ceba8dab886">MED_NAME_SIZE</a>+1] = <span class="stringliteral">&quot;joint&quot;</span>;
  <span class="keywordtype">char</span> des_jnt[<a class="code" href="a00321_ab69710ecf9f5257080a943579852d0f0.html#ab69710ecf9f5257080a943579852d0f0">MED_COMMENT_SIZE</a>+1] = <span class="stringliteral">&quot;joint avec le sous-domaine 2&quot;</span>;
  <span class="keywordtype">char</span> maa_distant[<a class="code" href="a00321_a0ae989cbbfeecbb5296b3ceba8dab886.html#a0ae989cbbfeecbb5296b3ceba8dab886">MED_NAME_SIZE</a>+1]= <span class="stringliteral">&quot;maa1&quot;</span>;
  <a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> dom_dist = 2;

  <a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> mdim = 3;
  <a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> ncor = 3;
  <a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> cor[6] = {1,2,3,4,5,6};
  <a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> cor2[6] = {10,20,30,40,50,60};
  <span class="keywordtype">char</span> nomcoo[3*<a class="code" href="a00321_a213ecd1a546eb96092b980a870bc386b.html#a213ecd1a546eb96092b980a870bc386b">MED_SNAME_SIZE</a>+1] = <span class="stringliteral">&quot;x               y               z               &quot;</span>;
  <span class="keywordtype">char</span> unicoo[3*<a class="code" href="a00321_a213ecd1a546eb96092b980a870bc386b.html#a213ecd1a546eb96092b980a870bc386b">MED_SNAME_SIZE</a>+1] = <span class="stringliteral">&quot;cm              cm              cm              &quot;</span>;


  <span class="comment">/* Creation du fichier &quot;test29.med&quot; */</span>
  <span class="keywordflow">if</span> ((fid = <a class="code" href="a01005_ga9376a1654b7bf099c3f8941074c5fdfb.html#ga9376a1654b7bf099c3f8941074c5fdfb" title="Ouverture d&amp;#39;un fichier MED.">MEDfileOpen</a>(<span class="stringliteral">&quot;test29.med&quot;</span>,<a class="code" href="a00750_a29a43500a889d39744e184ece0d749be.html#a29a43500a889d39744e184ece0d749be">MODE_ACCES</a>)) &lt; 0) {
    <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;Erreur a la creation du fichier test29.med&quot;</span>);
    <span class="keywordflow">return</span> -1;
  }

  <span class="keywordflow">if</span> (<a class="code" href="a01011_ga6007c3f1a62732e7a46c5eca232be78a.html#ga6007c3f1a62732e7a46c5eca232be78a" title="Cette routine permet de créer un maillage dans un fichier.">MEDmeshCr</a>( fid, maa, mdim, mdim, <a class="code" href="a00321_a821a4dd94c5c6b095318432bdec8d8a1.html#a821a4dd94c5c6b095318432bdec8d8a1a3719e53a4838d222f0a58148292fda41">MED_UNSTRUCTURED_MESH</a>,
                 <span class="stringliteral">&quot;un maillage pour test29&quot;</span>,<span class="stringliteral">&quot;s&quot;</span>, <a class="code" href="a00321_a5b97067a30629cd60470d074691d6798.html#a5b97067a30629cd60470d074691d6798ae896b6adfbde9870b4e875e5167eddd0">MED_SORT_DTIT</a>,
                 <a class="code" href="a00321_a57867e4bed1d104c865cfc9d23c9204d.html#a57867e4bed1d104c865cfc9d23c9204da682ef7f1042079519664eae87f90297e">MED_CARTESIAN</a>, nomcoo, unicoo) &lt; 0) {
    <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;Erreur a la creation du maillage : &quot;</span>); <a class="code" href="a00348_a257959db0a78623caa051d11ceb2f8cb.html#a257959db0a78623caa051d11ceb2f8cb">SSCRUTE</a>(maa);
    <span class="keywordflow">return</span> -1;
  }

  <span class="comment">/* Creation du joint */</span>
  <span class="keywordflow">if</span> (<a class="code" href="a01015_gab139ed60d40b7a61416f46eb5ff2dac2.html#gab139ed60d40b7a61416f46eb5ff2dac2" title="Cette routine permet de créer un joint dans un maillage.">MEDsubdomainJointCr</a>(fid,maa,jnt,des_jnt,dom_dist,maa_distant) &lt; 0) {
    <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;Erreur a la creation du joint&quot;</span>);
    <span class="keywordflow">return</span> -1;
  }

  <span class="comment">/* Ecriture de la correspondance Noeud, Noeud */</span>
  <span class="keywordflow">if</span> (<a class="code" href="a01015_ga78dd95846735f895e33876bf69e1d5a4.html#ga78dd95846735f895e33876bf69e1d5a4" title="Cette routine permet l&amp;#39;écriture d&amp;#39;une correspondance dans un joint pour...">MEDsubdomainCorrespondenceWr</a>(fid,maa,jnt,<a class="code" href="a00321_a8f72b6ceb3b6f5a67f9efd46cb90707a.html#a8f72b6ceb3b6f5a67f9efd46cb90707a">MED_NO_DT</a>,<a class="code" href="a00321_a95919207fd7a18ba26e6e03f04811e3f.html#a95919207fd7a18ba26e6e03f04811e3f">MED_NO_IT</a>,
                                   <a class="code" href="a00321_aab0e957294723517d5c3641bb71b0470.html#aab0e957294723517d5c3641bb71b0470a074507163b07b6d764823a78c5c07f0f">MED_NODE</a>,<a class="code" href="a00321_a9a2843c7d6eacffdd9377b5bfb8a6de3.html#a9a2843c7d6eacffdd9377b5bfb8a6de3">MED_NONE</a>,<a class="code" href="a00321_aab0e957294723517d5c3641bb71b0470.html#aab0e957294723517d5c3641bb71b0470a074507163b07b6d764823a78c5c07f0f">MED_NODE</a>,<a class="code" href="a00321_a9a2843c7d6eacffdd9377b5bfb8a6de3.html#a9a2843c7d6eacffdd9377b5bfb8a6de3">MED_NONE</a>,ncor,cor) &lt; 0) {
    <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;Erreur a l&apos;ecriture du tableau des correspondances (noeud,noeud)&quot;</span>);
    <span class="keywordflow">return</span> -1;
  }

  <span class="comment">/* Ecriture de la correspondance Noeud Maille */</span>
  <span class="keywordflow">if</span> (<a class="code" href="a01015_ga78dd95846735f895e33876bf69e1d5a4.html#ga78dd95846735f895e33876bf69e1d5a4" title="Cette routine permet l&amp;#39;écriture d&amp;#39;une correspondance dans un joint pour...">MEDsubdomainCorrespondenceWr</a>(fid,maa,jnt,<a class="code" href="a00321_a8f72b6ceb3b6f5a67f9efd46cb90707a.html#a8f72b6ceb3b6f5a67f9efd46cb90707a">MED_NO_DT</a>,<a class="code" href="a00321_a95919207fd7a18ba26e6e03f04811e3f.html#a95919207fd7a18ba26e6e03f04811e3f">MED_NO_IT</a>,
                                   <a class="code" href="a00321_aab0e957294723517d5c3641bb71b0470.html#aab0e957294723517d5c3641bb71b0470a074507163b07b6d764823a78c5c07f0f">MED_NODE</a>,<a class="code" href="a00321_a9a2843c7d6eacffdd9377b5bfb8a6de3.html#a9a2843c7d6eacffdd9377b5bfb8a6de3">MED_NONE</a>,<a class="code" href="a00321_aab0e957294723517d5c3641bb71b0470.html#aab0e957294723517d5c3641bb71b0470a227d14957ec5f221685cb1d6ec3b6c67">MED_CELL</a>,<a class="code" href="a00321_a4a1eb7ba296742a6f5eb8b5b23b39670.html#a4a1eb7ba296742a6f5eb8b5b23b39670">MED_TRIA3</a>,ncor,cor2) &lt; 0) {
    <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;Erreur a l&apos;ecriture du tableau des correspondances (noeud,maille TRIA3)&quot;</span>);
    <span class="keywordflow">return</span> -1;
  }

  <span class="comment">/* Fermeture du fichier */</span>
  <span class="keywordflow">if</span> (<a class="code" href="a01005_ga12a0e901c376be997a41a073ce426283.html#ga12a0e901c376be997a41a073ce426283" title="Fermeture d&amp;#39;un fichier MED.">MEDfileClose</a>(fid) &lt; 0) {
    <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;Erreur a la fermeture du fichier&quot;</span>);
    <span class="keywordflow">return</span> -1;
  }

  <span class="keywordflow">return</span> 0;
}




</pre></div> <div class="fragment"><pre class="fragment"><span class="comment">/*  This file is part of MED.</span>
<span class="comment"> *</span>
<span class="comment"> *  COPYRIGHT (C) 1999 - 2012  EDF R&amp;D, CEA/DEN</span>
<span class="comment"> *  MED is free software: you can redistribute it and/or modify</span>
<span class="comment"> *  it under the terms of the GNU Lesser General Public License as published by</span>
<span class="comment"> *  the Free Software Foundation, either version 3 of the License, or</span>
<span class="comment"> *  (at your option) any later version.</span>
<span class="comment"> *</span>
<span class="comment"> *  MED is distributed in the hope that it will be useful,</span>
<span class="comment"> *  but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="comment"> *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<span class="comment"> *  GNU Lesser General Public License for more details.</span>
<span class="comment"> *</span>
<span class="comment"> *  You should have received a copy of the GNU Lesser General Public License</span>
<span class="comment"> *  along with MED.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span>
<span class="comment"> */</span>

<span class="comment">/******************************************************************************</span>
<span class="comment"> * - Nom du fichier : test30.c</span>
<span class="comment"> *</span>
<span class="comment"> * - Description : lecture des joints d&apos;un maillage MED.</span>
<span class="comment"> *</span>
<span class="comment"> *****************************************************************************/</span>

<span class="preprocessor">#include &lt;med.h&gt;</span>
<span class="preprocessor">#define MESGERR 1</span>
<span class="preprocessor"></span><span class="preprocessor">#include &lt;med_utils.h&gt;</span>

<span class="preprocessor">#ifdef DEF_LECT_ECR</span>
<span class="preprocessor"></span><span class="preprocessor">#define MODE_ACCES MED_ACC_RDWR</span>
<span class="preprocessor"></span><span class="preprocessor">#elif DEF_LECT_AJOUT</span>
<span class="preprocessor"></span><span class="preprocessor">#define MODE_ACCES MED_ACC_RDEXT</span>
<span class="preprocessor"></span><span class="preprocessor">#else</span>
<span class="preprocessor"></span><span class="preprocessor">#define MODE_ACCES MED_ACC_CREAT</span>
<span class="preprocessor"></span><span class="preprocessor">#endif</span>
<span class="preprocessor"></span>
<span class="keywordtype">int</span> <a class="code" href="a00848_a71b3649850bcd40c06d87ca7a0ba13b9.html#a71b3649850bcd40c06d87ca7a0ba13b9">afficheCorres</a>(<a class="code" href="a00320_afa4ec8284026c8c5545e5333475fb65a.html#afa4ec8284026c8c5545e5333475fb65a">med_idt</a> fid, <span class="keywordtype">char</span> *maa, <span class="keywordtype">char</span> *jnt,
                 <a class="code" href="a00321_aab0e957294723517d5c3641bb71b0470.html#aab0e957294723517d5c3641bb71b0470">med_entity_type</a> typ_ent_local,   <a class="code" href="a00321_a1043613afc3cd2e24785dfc7c0452ab8.html#a1043613afc3cd2e24785dfc7c0452ab8">med_geometry_type</a> typ_geo_local,
                 <a class="code" href="a00321_aab0e957294723517d5c3641bb71b0470.html#aab0e957294723517d5c3641bb71b0470">med_entity_type</a> typ_ent_distant, <a class="code" href="a00321_a1043613afc3cd2e24785dfc7c0452ab8.html#a1043613afc3cd2e24785dfc7c0452ab8">med_geometry_type</a> typ_geo_distant,
                 <span class="keywordtype">char</span> *type);

<span class="keywordtype">int</span> <a class="code" href="a00750_a3c04138a5bfe5d72780bb7e82a18e627.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a> (<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> **argv)


{
  <a class="code" href="a00320_abd29d7c6abaef5da2a5ed1b73464f0ba.html#abd29d7c6abaef5da2a5ed1b73464f0ba">med_err</a> ret = 0;
  <a class="code" href="a00320_afa4ec8284026c8c5545e5333475fb65a.html#afa4ec8284026c8c5545e5333475fb65a">med_idt</a> fid;
  <span class="keywordtype">char</span> maa[<a class="code" href="a00321_a0ae989cbbfeecbb5296b3ceba8dab886.html#a0ae989cbbfeecbb5296b3ceba8dab886">MED_NAME_SIZE</a>+1],maa_dist[<a class="code" href="a00321_a0ae989cbbfeecbb5296b3ceba8dab886.html#a0ae989cbbfeecbb5296b3ceba8dab886">MED_NAME_SIZE</a>+1];
  <a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> mdim,sdim;
  <a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> njnt,ncor,ndom,nc;
  <span class="keywordtype">char</span> jnt[<a class="code" href="a00321_a0ae989cbbfeecbb5296b3ceba8dab886.html#a0ae989cbbfeecbb5296b3ceba8dab886">MED_NAME_SIZE</a>+1],corr[<a class="code" href="a00321_a0ae989cbbfeecbb5296b3ceba8dab886.html#a0ae989cbbfeecbb5296b3ceba8dab886">MED_NAME_SIZE</a>+1];
  <span class="keywordtype">char</span> des[<a class="code" href="a00321_ab69710ecf9f5257080a943579852d0f0.html#ab69710ecf9f5257080a943579852d0f0">MED_COMMENT_SIZE</a>+1];
  <span class="keywordtype">char</span> dtunit[<a class="code" href="a00321_a213ecd1a546eb96092b980a870bc386b.html#a213ecd1a546eb96092b980a870bc386b">MED_SNAME_SIZE</a>+1]=<span class="stringliteral">&quot;&quot;</span>;
  <span class="keywordtype">char</span> nomcoo[3*<a class="code" href="a00321_a213ecd1a546eb96092b980a870bc386b.html#a213ecd1a546eb96092b980a870bc386b">MED_SNAME_SIZE</a>+1];
  <span class="keywordtype">char</span> unicoo[3*<a class="code" href="a00321_a213ecd1a546eb96092b980a870bc386b.html#a213ecd1a546eb96092b980a870bc386b">MED_SNAME_SIZE</a>+1];
  <a class="code" href="a00321_a57867e4bed1d104c865cfc9d23c9204d.html#a57867e4bed1d104c865cfc9d23c9204d">med_axis_type</a> rep;
  <a class="code" href="a00321_a821a4dd94c5c6b095318432bdec8d8a1.html#a821a4dd94c5c6b095318432bdec8d8a1">med_mesh_type</a> type;
  <a class="code" href="a00321_a5b97067a30629cd60470d074691d6798.html#a5b97067a30629cd60470d074691d6798">med_sorting_type</a> sort;
  <a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> nstep=0,njstep=0,nodtitncor=0,nentity=0;
  <a class="code" href="a00321_aab0e957294723517d5c3641bb71b0470.html#aab0e957294723517d5c3641bb71b0470">med_entity_type</a> typ_ent_local,typ_ent_distant;
  <a class="code" href="a00321_a1043613afc3cd2e24785dfc7c0452ab8.html#a1043613afc3cd2e24785dfc7c0452ab8">med_geometry_type</a> typ_geo_local,typ_geo_distant;
  <span class="keywordtype">int</span> i,j,k;

  <span class="keywordflow">if</span> (argc != 2) {
    <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;Il faut passer un fichier MED en paramètre&quot;</span>);
    <span class="keywordflow">return</span> -1;
  }

  <span class="comment">/* Ouverture du fichier passe en argument en lecture seule */</span>
  <span class="keywordflow">if</span> ((fid = <a class="code" href="a01005_ga9376a1654b7bf099c3f8941074c5fdfb.html#ga9376a1654b7bf099c3f8941074c5fdfb" title="Ouverture d&amp;#39;un fichier MED.">MEDfileOpen</a>(argv[1],<a class="code" href="a00321_adcd0322de9fec3b5e199ffeda3f44c85.html#adcd0322de9fec3b5e199ffeda3f44c85a616bf8345c622a34f0787f42eb400f25">MED_ACC_RDONLY</a>)) &lt; 0) {
    <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;Erreur à l&apos;ouverture du fichier : &quot;</span>); <a class="code" href="a00348_a257959db0a78623caa051d11ceb2f8cb.html#a257959db0a78623caa051d11ceb2f8cb">SSCRUTE</a>(argv[1]);
    <span class="keywordflow">return</span> -1;
  }

  <span class="keywordflow">if</span> ((sdim=<a class="code" href="a01011_gad36ab4651405ed8542fb2a63e2fc44da.html#gad36ab4651405ed8542fb2a63e2fc44da" title="Cette routine permet de lire dans un maillage le nombre d&amp;#39;axes du repère des...">MEDmeshnAxis</a>(fid, 1)) &lt;0) {
    <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;Erreur à la lecture de la dimension de l&apos;espace du maillage :&quot;</span>);
    <a class="code" href="a00348_a257959db0a78623caa051d11ceb2f8cb.html#a257959db0a78623caa051d11ceb2f8cb">SSCRUTE</a>(maa);
    <span class="keywordflow">return</span> -1;
  }

  <span class="comment">/* Lecture des infos concernant le premier maillage */</span>
  <span class="keywordflow">if</span> ( <a class="code" href="a01011_ga71e0d79fbb40abdc9c20bc5be01441ac.html#ga71e0d79fbb40abdc9c20bc5be01441ac" title="Cette routine permet de lire les informations relatives à un maillage dans un fichier...">MEDmeshInfo</a>( fid, 1,  maa, &amp;sdim, &amp;mdim, &amp;type, des, dtunit, &amp;sort,
                    &amp;nstep,  &amp;rep, nomcoo,unicoo) &lt; 0 ) {
    <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;Erreur a la lecture des informations sur le maillage : &quot;</span>);<a class="code" href="a00348_a257959db0a78623caa051d11ceb2f8cb.html#a257959db0a78623caa051d11ceb2f8cb">SSCRUTE</a>(maa);
    <span class="keywordflow">return</span> -1;
  } <span class="keywordflow">else</span> {
    printf(<span class="stringliteral">&quot;Maillage de nom : |%s| , de dimension : &quot;</span>IFORMAT<span class="stringliteral">&quot; , et de type %d\n&quot;</span>,maa,mdim,type);
    printf(<span class="stringliteral">&quot;\t -Dimension de l&apos;espace : &quot;</span>IFORMAT<span class="stringliteral">&quot;\n&quot;</span>,sdim);
    printf(<span class="stringliteral">&quot;\t -Description du maillage : |%s|\n&quot;</span>,des);
    printf(<span class="stringliteral">&quot;\t -Noms des axes : |%s|\n&quot;</span>,nomcoo);
    printf(<span class="stringliteral">&quot;\t -Unités des axes : |%s|\n&quot;</span>,unicoo);
    printf(<span class="stringliteral">&quot;\t -Type de repère : %d\n&quot;</span>,rep);
    printf(<span class="stringliteral">&quot;\t -Nombre d&apos;étapes de calcul : &quot;</span>IFORMAT<span class="stringliteral">&quot;\n&quot;</span>,nstep);
    printf(<span class="stringliteral">&quot;\t -Unité des dates : |%s|\n\n&quot;</span>,dtunit);
  }

  <span class="comment">/* Lecture du nombre de joints */</span>
  <span class="keywordflow">if</span> ((njnt = <a class="code" href="a01015_ga90067f55ea12412a0688c6c304204e65.html#ga90067f55ea12412a0688c6c304204e65" title="Cette routine permet la lecture du nombre de joint dans un maillage.">MEDnSubdomainJoint</a>(fid,maa)) &lt; 0) {
    <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;Erreur a la lecture du nombre de joints&quot;</span>);
    <span class="keywordflow">return</span> -1;
  }
  printf(<span class="stringliteral">&quot;Nombre de joints : &quot;</span>IFORMAT<span class="stringliteral">&quot; \n&quot;</span>,njnt);

  <span class="comment">/* Lecture de tous les joints du maillage */</span>
  <span class="keywordflow">for</span> (i = 0;i&lt;njnt;i++) {
    printf(<span class="stringliteral">&quot;Joint numero : %d \n&quot;</span>,i+1);

    <span class="comment">/* Lecture des infos sur le joints */</span>
    <span class="keywordflow">if</span> (<a class="code" href="a01015_ga25a6e4dff83d09a8f46ed161136bf44c.html#ga25a6e4dff83d09a8f46ed161136bf44c" title="Cette routine permet de lire les informations sur un joint dans un maillage.">MEDsubdomainJointInfo</a>(fid,maa,i+1,jnt,des,&amp;ndom,maa_dist,&amp;njstep,&amp;nodtitncor) &lt; 0) {
      <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;Erreur a la lecture du joint d&apos;indice&quot;</span>);
      <a class="code" href="a00348_ae7ba0433e91c450cd44c3808c2acb497.html#ae7ba0433e91c450cd44c3808c2acb497">ISCRUTE_int</a>(i+1);
      <span class="keywordflow">return</span> -1;
    }
    printf(<span class="stringliteral">&quot;Nom du joint: |%s| \n&quot;</span>,jnt);
    printf(<span class="stringliteral">&quot;Description du joint      : |%s| \n&quot;</span>,des);
    printf(<span class="stringliteral">&quot;Domaine en regard         : &quot;</span>IFORMAT<span class="stringliteral">&quot; \n&quot;</span>,ndom);
    printf(<span class="stringliteral">&quot;Maillage distant          : |%s| \n&quot;</span>,maa_dist);
    printf(<span class="stringliteral">&quot;Nombre d&apos;étapes de calcul : &quot;</span>IFORMAT<span class="stringliteral">&quot; \n&quot;</span>,njstep);
    printf(<span class="stringliteral">&quot;Nombre de correspondance pour (NO_DT,NO_IT) : &quot;</span>IFORMAT<span class="stringliteral">&quot; \n&quot;</span>,nodtitncor);



    <span class="comment">/* lecture des correspondances une par une</span>
<span class="comment">       en connaissant leur type a priori */</span>

    <span class="comment">/* Lecture de la correspondance Noeud Noeud */</span>
    <a class="code" href="a00848_a71b3649850bcd40c06d87ca7a0ba13b9.html#a71b3649850bcd40c06d87ca7a0ba13b9">afficheCorres</a>(fid,maa,jnt,<a class="code" href="a00321_aab0e957294723517d5c3641bb71b0470.html#aab0e957294723517d5c3641bb71b0470a074507163b07b6d764823a78c5c07f0f">MED_NODE</a>,0,<a class="code" href="a00321_aab0e957294723517d5c3641bb71b0470.html#aab0e957294723517d5c3641bb71b0470a074507163b07b6d764823a78c5c07f0f">MED_NODE</a>,0,<span class="stringliteral">&quot;noeud/noeud&quot;</span>);

    <span class="comment">/* Lecture de la correspondance Noeud Maille */</span>
    <a class="code" href="a00848_a71b3649850bcd40c06d87ca7a0ba13b9.html#a71b3649850bcd40c06d87ca7a0ba13b9">afficheCorres</a>(fid,maa,jnt,<a class="code" href="a00321_aab0e957294723517d5c3641bb71b0470.html#aab0e957294723517d5c3641bb71b0470a074507163b07b6d764823a78c5c07f0f">MED_NODE</a>,0,<a class="code" href="a00321_aab0e957294723517d5c3641bb71b0470.html#aab0e957294723517d5c3641bb71b0470a227d14957ec5f221685cb1d6ec3b6c67">MED_CELL</a>,<a class="code" href="a00321_a4a1eb7ba296742a6f5eb8b5b23b39670.html#a4a1eb7ba296742a6f5eb8b5b23b39670">MED_TRIA3</a>,<span class="stringliteral">&quot;noeud/TRIA3&quot;</span>);


    <span class="comment">/* lecture des correspondances une par une</span>
<span class="comment">       sans connaitre leur type a priori</span>
<span class="comment">       -&gt; utilisation de la fonction MEDjointTypeCorres */</span>

    ncor=1;

    <span class="keywordflow">while</span> ( ncor &lt;= nodtitncor ) {
      <a class="code" href="a00348_a818470a84d2ad18a3fbb48170296cd95.html#a818470a84d2ad18a3fbb48170296cd95">ISCRUTE</a>(ncor);
      <span class="keywordflow">if</span> ( <a class="code" href="a01015_gae6262eba284cc7118a1c6b2617d471b4.html#gae6262eba284cc7118a1c6b2617d471b4" title="Cette routine permet de lire les informations sur les couples d&amp;#39;entités en correspondance...">MEDsubdomainCorrespondenceSizeInfo</a>(fid,maa,jnt,<a class="code" href="a00321_a8f72b6ceb3b6f5a67f9efd46cb90707a.html#a8f72b6ceb3b6f5a67f9efd46cb90707a">MED_NO_DT</a>,<a class="code" href="a00321_a95919207fd7a18ba26e6e03f04811e3f.html#a95919207fd7a18ba26e6e03f04811e3f">MED_NO_IT</a>,ncor,
                                           &amp;typ_ent_local,&amp;typ_geo_local,&amp;typ_ent_distant,&amp;typ_geo_distant,
                                              &amp;nentity) &lt; 0 ) {
        <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;Erreur a la lecture des infos sur le nombre d&apos;entite en regard&quot;</span>);
        <span class="keywordflow">return</span> -1;
      }

      <span class="comment">/* Lecture de la correspondance Noeud Noeud */</span>
      <a class="code" href="a00848_a71b3649850bcd40c06d87ca7a0ba13b9.html#a71b3649850bcd40c06d87ca7a0ba13b9">afficheCorres</a>(fid,maa,jnt,typ_ent_local,typ_geo_local,typ_ent_distant,typ_geo_distant,<span class="stringliteral">&quot;------&quot;</span>);

      ncor++;
    }

  }

  <span class="comment">/* Fermeture du fichier */</span>
  <span class="keywordflow">if</span> (<a class="code" href="a01005_ga12a0e901c376be997a41a073ce426283.html#ga12a0e901c376be997a41a073ce426283" title="Fermeture d&amp;#39;un fichier MED.">MEDfileClose</a>(fid) &lt; 0) {
    <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;Erreur a la fermeture du fichier &quot;</span>);
    <span class="keywordflow">return</span> -1;
  }

  <span class="keywordflow">return</span> ret;
}




<span class="keywordtype">int</span> <a class="code" href="a00848_a71b3649850bcd40c06d87ca7a0ba13b9.html#a71b3649850bcd40c06d87ca7a0ba13b9">afficheCorres</a>(<a class="code" href="a00320_afa4ec8284026c8c5545e5333475fb65a.html#afa4ec8284026c8c5545e5333475fb65a">med_idt</a> fid, <span class="keywordtype">char</span> *maa, <span class="keywordtype">char</span> *jnt,
                 <a class="code" href="a00321_aab0e957294723517d5c3641bb71b0470.html#aab0e957294723517d5c3641bb71b0470">med_entity_type</a> typ_ent_local,   <a class="code" href="a00321_a1043613afc3cd2e24785dfc7c0452ab8.html#a1043613afc3cd2e24785dfc7c0452ab8">med_geometry_type</a> typ_geo_local,
                 <a class="code" href="a00321_aab0e957294723517d5c3641bb71b0470.html#aab0e957294723517d5c3641bb71b0470">med_entity_type</a> typ_ent_distant, <a class="code" href="a00321_a1043613afc3cd2e24785dfc7c0452ab8.html#a1043613afc3cd2e24785dfc7c0452ab8">med_geometry_type</a> typ_geo_distant,
                 <span class="keywordtype">char</span> *type)
{
  <a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> nc;
  <a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> *cortab;
  <span class="keywordtype">int</span> k,ncor,ret=0;

  <a class="code" href="a00348_ae7ba0433e91c450cd44c3808c2acb497.html#ae7ba0433e91c450cd44c3808c2acb497">ISCRUTE_int</a>(typ_ent_local);<a class="code" href="a00348_ae7ba0433e91c450cd44c3808c2acb497.html#ae7ba0433e91c450cd44c3808c2acb497">ISCRUTE_int</a>(typ_geo_local);
  <a class="code" href="a00348_ae7ba0433e91c450cd44c3808c2acb497.html#ae7ba0433e91c450cd44c3808c2acb497">ISCRUTE_int</a>(typ_ent_distant);<a class="code" href="a00348_ae7ba0433e91c450cd44c3808c2acb497.html#ae7ba0433e91c450cd44c3808c2acb497">ISCRUTE_int</a>(typ_geo_distant);
  <span class="keywordflow">if</span> ( <a class="code" href="a01015_ga47aeb9b5072799cc4a3a0e672ad5d29f.html#ga47aeb9b5072799cc4a3a0e672ad5d29f" title="Cette routine permet la lecture du nombre d&amp;#39;entités en correspondance dans un...">MEDsubdomainCorrespondenceSize</a>(fid,maa,jnt,<a class="code" href="a00321_a8f72b6ceb3b6f5a67f9efd46cb90707a.html#a8f72b6ceb3b6f5a67f9efd46cb90707a">MED_NO_DT</a>,<a class="code" href="a00321_a95919207fd7a18ba26e6e03f04811e3f.html#a95919207fd7a18ba26e6e03f04811e3f">MED_NO_IT</a>,
                                      typ_ent_local,typ_geo_local,typ_ent_distant,typ_geo_distant,
                                      &amp;nc) &lt; 0) {
    <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;Erreur a la lecture des infos sur le nombre d&apos;entite en regard de type&quot;</span>);
    <a class="code" href="a00348_a257959db0a78623caa051d11ceb2f8cb.html#a257959db0a78623caa051d11ceb2f8cb">SSCRUTE</a>(type);
    <span class="keywordflow">return</span> -1;
  }

  printf(<span class="stringliteral">&quot;nb de couples d&apos;entites en regard |%s|: &quot;</span>IFORMAT<span class="stringliteral">&quot; \n&quot;</span>,type,nc);

  <span class="keywordflow">if</span> (nc &gt; 0) {
    cortab = (<a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a>*) malloc(<span class="keyword">sizeof</span>(<a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a>)*nc*2);
    <span class="keywordflow">if</span> ((ret=<a class="code" href="a01015_ga5170722fcd38ed65987bea79c4ac9d3b.html#ga5170722fcd38ed65987bea79c4ac9d3b" title="Cette routine permet la lecture d&amp;#39;une correspondance dans un joint pour un type...">MEDsubdomainCorrespondenceRd</a>(fid,maa,jnt,<a class="code" href="a00321_a8f72b6ceb3b6f5a67f9efd46cb90707a.html#a8f72b6ceb3b6f5a67f9efd46cb90707a">MED_NO_DT</a>,<a class="code" href="a00321_a95919207fd7a18ba26e6e03f04811e3f.html#a95919207fd7a18ba26e6e03f04811e3f">MED_NO_IT</a>,
                                          typ_ent_local,typ_geo_local,typ_ent_distant,typ_geo_distant,
                                          cortab)) &lt; 0) {
      <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;Erreur a la lecture des correspondances sur &quot;</span>);
      <a class="code" href="a00348_a257959db0a78623caa051d11ceb2f8cb.html#a257959db0a78623caa051d11ceb2f8cb">SSCRUTE</a>(type);
      ret = -1;
    }
    <span class="keywordflow">if</span> (ret == 0)
      <span class="keywordflow">for</span> (k=0;k&lt;nc;k++)
        printf(<span class="stringliteral">&quot;Correspondance %d : &quot;</span>IFORMAT<span class="stringliteral">&quot; et &quot;</span>IFORMAT<span class="stringliteral">&quot; \n&quot;</span>,k+1,*(cortab+2*k),
               *(cortab+2*k+1));
    free(cortab);
  }
  <span class="keywordflow">return</span> ret;
}

</pre></div> <div class="fragment"><pre class="fragment"><span class="comment">/*  This file is part of MED.</span>
<span class="comment"> *</span>
<span class="comment"> *  COPYRIGHT (C) 1999 - 2012  EDF R&amp;D, CEA/DEN</span>
<span class="comment"> *  MED is free software: you can redistribute it and/or modify</span>
<span class="comment"> *  it under the terms of the GNU Lesser General Public License as published by</span>
<span class="comment"> *  the Free Software Foundation, either version 3 of the License, or</span>
<span class="comment"> *  (at your option) any later version.</span>
<span class="comment"> *</span>
<span class="comment"> *  MED is distributed in the hope that it will be useful,</span>
<span class="comment"> *  but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="comment"> *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<span class="comment"> *  GNU Lesser General Public License for more details.</span>
<span class="comment"> *</span>
<span class="comment"> *  You should have received a copy of the GNU Lesser General Public License</span>
<span class="comment"> *  along with MED.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span>
<span class="comment"> */</span>

<span class="comment">/******************************************************************************</span>
<span class="comment"> * - Nom du fichier : test31.c</span>
<span class="comment"> *</span>
<span class="comment"> * - Description : ecriture d&apos;une numerotation globale dans un maillage MED </span>
<span class="comment"> *</span>
<span class="comment"> *****************************************************************************/</span>

<span class="preprocessor">#include &lt;med.h&gt;</span>
<span class="preprocessor">#define MESGERR 1</span>
<span class="preprocessor"></span><span class="preprocessor">#include &lt;med_utils.h&gt;</span>


<span class="preprocessor">#ifdef DEF_LECT_ECR</span>
<span class="preprocessor"></span><span class="preprocessor">#define MODE_ACCES MED_ACC_RDWR</span>
<span class="preprocessor"></span><span class="preprocessor">#elif DEF_LECT_AJOUT</span>
<span class="preprocessor"></span><span class="preprocessor">#define MODE_ACCES MED_ACC_RDEXT</span>
<span class="preprocessor"></span><span class="preprocessor">#else</span>
<span class="preprocessor"></span><span class="preprocessor">#define MODE_ACCES MED_ACC_CREAT</span>
<span class="preprocessor"></span><span class="preprocessor">#endif</span>
<span class="preprocessor"></span>
<span class="keywordtype">int</span> <a class="code" href="a00750_a3c04138a5bfe5d72780bb7e82a18e627.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a> (<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> **argv)


{
  <a class="code" href="a00320_abd29d7c6abaef5da2a5ed1b73464f0ba.html#abd29d7c6abaef5da2a5ed1b73464f0ba">med_err</a> ret = 0;
  <a class="code" href="a00320_afa4ec8284026c8c5545e5333475fb65a.html#afa4ec8284026c8c5545e5333475fb65a">med_idt</a> fid;
  <a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> mdim,sdim;
  <span class="comment">/* nom du maillage de longueur maxi MED_NAME_SIZE */</span>
  <span class="keywordtype">char</span> maa[<a class="code" href="a00321_a0ae989cbbfeecbb5296b3ceba8dab886.html#a0ae989cbbfeecbb5296b3ceba8dab886">MED_NAME_SIZE</a>+1];
  <span class="comment">/* le nombre de noeuds */</span>
  <a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> nnoe = 0;
  <span class="comment">/* table des numeros global */</span>
  <a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> *numglobalnoe=NULL;

  <span class="comment">/* variable de stockage pour reperer le maillage */</span>
  <a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> i;
  <span class="keywordtype">char</span> des[<a class="code" href="a00321_ab69710ecf9f5257080a943579852d0f0.html#ab69710ecf9f5257080a943579852d0f0">MED_COMMENT_SIZE</a>+1]=<span class="stringliteral">&quot;&quot;</span>;
  <span class="keywordtype">char</span> dtunit[<a class="code" href="a00321_a213ecd1a546eb96092b980a870bc386b.html#a213ecd1a546eb96092b980a870bc386b">MED_SNAME_SIZE</a>+1]=<span class="stringliteral">&quot;&quot;</span>;
  <span class="keywordtype">char</span> nomcoo[3*<a class="code" href="a00321_a213ecd1a546eb96092b980a870bc386b.html#a213ecd1a546eb96092b980a870bc386b">MED_SNAME_SIZE</a>+1]=<span class="stringliteral">&quot;&quot;</span>;
  <span class="keywordtype">char</span> unicoo[3*<a class="code" href="a00321_a213ecd1a546eb96092b980a870bc386b.html#a213ecd1a546eb96092b980a870bc386b">MED_SNAME_SIZE</a>+1]=<span class="stringliteral">&quot;&quot;</span>;
  <a class="code" href="a00321_a57867e4bed1d104c865cfc9d23c9204d.html#a57867e4bed1d104c865cfc9d23c9204d">med_axis_type</a> rep;
  <a class="code" href="a00321_a821a4dd94c5c6b095318432bdec8d8a1.html#a821a4dd94c5c6b095318432bdec8d8a1">med_mesh_type</a> type;
  <a class="code" href="a00321_a5b97067a30629cd60470d074691d6798.html#a5b97067a30629cd60470d074691d6798">med_sorting_type</a> sort;
  <a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> nstep=0;
  <a class="code" href="a00321_a23f7fa6d76886ed3c91dc33b59190dee.html#a23f7fa6d76886ed3c91dc33b59190dee">med_bool</a> chgt=<a class="code" href="a00321_a23f7fa6d76886ed3c91dc33b59190dee.html#a23f7fa6d76886ed3c91dc33b59190deea30b70cc2a253ed4141db9a78ba696046">MED_FALSE</a>,trsf=<a class="code" href="a00321_a23f7fa6d76886ed3c91dc33b59190dee.html#a23f7fa6d76886ed3c91dc33b59190deea30b70cc2a253ed4141db9a78ba696046">MED_FALSE</a>;



  <span class="keywordflow">if</span> (argc != 2) {
    <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;Il faut passer un fichier MED en param�tre&quot;</span>);
    <span class="keywordflow">return</span> -1;
  }

  <span class="comment">/* Ouverture du fichier passe en argument */</span>
  <span class="keywordflow">if</span> ((fid = <a class="code" href="a01005_ga9376a1654b7bf099c3f8941074c5fdfb.html#ga9376a1654b7bf099c3f8941074c5fdfb" title="Ouverture d&amp;#39;un fichier MED.">MEDfileOpen</a>(argv[1],<a class="code" href="a00321_adcd0322de9fec3b5e199ffeda3f44c85.html#adcd0322de9fec3b5e199ffeda3f44c85ab53f10a6b700d1087d7a50710fe29f00">MED_ACC_RDWR</a>)) &lt; 0) {
    <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;Erreur a l&apos;ouverture du fichier : &quot;</span>); <a class="code" href="a00348_a257959db0a78623caa051d11ceb2f8cb.html#a257959db0a78623caa051d11ceb2f8cb">SSCRUTE</a>(argv[1]);
    <span class="keywordflow">return</span> -1;
  }
  

  <span class="keywordflow">if</span> ((sdim=<a class="code" href="a01011_gad36ab4651405ed8542fb2a63e2fc44da.html#gad36ab4651405ed8542fb2a63e2fc44da" title="Cette routine permet de lire dans un maillage le nombre d&amp;#39;axes du repère des...">MEDmeshnAxis</a>(fid, 1)) &lt;0) {
    <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;Erreur � la lecture de la dimension de l&apos;espace du maillage :&quot;</span>);
    <a class="code" href="a00348_a257959db0a78623caa051d11ceb2f8cb.html#a257959db0a78623caa051d11ceb2f8cb">SSCRUTE</a>(maa);
    <span class="keywordflow">return</span> -1;
  }

  <span class="comment">/* Lecture des infos concernant le premier maillage */</span>
  <span class="keywordflow">if</span> ( <a class="code" href="a01011_ga71e0d79fbb40abdc9c20bc5be01441ac.html#ga71e0d79fbb40abdc9c20bc5be01441ac" title="Cette routine permet de lire les informations relatives à un maillage dans un fichier...">MEDmeshInfo</a>( fid, 1,  maa, &amp;sdim, &amp;mdim, &amp;type, des, dtunit, &amp;sort,
                    &amp;nstep,  &amp;rep, nomcoo,unicoo) &lt; 0 ) {
    <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;Erreur a la lecture des informations sur le maillage : &quot;</span>);<a class="code" href="a00348_a257959db0a78623caa051d11ceb2f8cb.html#a257959db0a78623caa051d11ceb2f8cb">SSCRUTE</a>(maa);
    <span class="keywordflow">return</span> -1;
  } <span class="keywordflow">else</span> {
    printf(<span class="stringliteral">&quot;Maillage de nom : |%s| , de dimension : &quot;</span>IFORMAT<span class="stringliteral">&quot; , et de type %d\n&quot;</span>,maa,mdim,type);
    printf(<span class="stringliteral">&quot;\t -Dimension de l&apos;espace : &quot;</span>IFORMAT<span class="stringliteral">&quot;\n&quot;</span>,sdim);
    printf(<span class="stringliteral">&quot;\t -Description du maillage : %s\n&quot;</span>,des);
    printf(<span class="stringliteral">&quot;\t -Noms des axes : %s\n&quot;</span>,nomcoo);
    printf(<span class="stringliteral">&quot;\t -Unit�s des axes : %s\n&quot;</span>,unicoo);
    printf(<span class="stringliteral">&quot;\t -Type de rep�re : %d\n&quot;</span>,rep);
    printf(<span class="stringliteral">&quot;\t -Nombre d&apos;�tapes de calcul : &quot;</span>IFORMAT<span class="stringliteral">&quot;\n&quot;</span>,nstep);
    printf(<span class="stringliteral">&quot;\t -Unit� des dates : %s\n\n&quot;</span>,dtunit);
  }

  <span class="comment">/* Lecture du nombre de noeuds */</span>
  <span class="keywordflow">if</span> ( (nnoe = <a class="code" href="a01011_ga45758103360dacf7b8a6c53ebfa4d7e5.html#ga45758103360dacf7b8a6c53ebfa4d7e5" title="Cette routine permet de lire le nombre d&amp;#39;entités dans un maillage pour une séquence...">MEDmeshnEntity</a>(fid,maa,<a class="code" href="a00321_a8f72b6ceb3b6f5a67f9efd46cb90707a.html#a8f72b6ceb3b6f5a67f9efd46cb90707a">MED_NO_DT</a>,<a class="code" href="a00321_a95919207fd7a18ba26e6e03f04811e3f.html#a95919207fd7a18ba26e6e03f04811e3f">MED_NO_IT</a>,
                              <a class="code" href="a00321_aab0e957294723517d5c3641bb71b0470.html#aab0e957294723517d5c3641bb71b0470a074507163b07b6d764823a78c5c07f0f">MED_NODE</a>,<a class="code" href="a00321_a9a2843c7d6eacffdd9377b5bfb8a6de3.html#a9a2843c7d6eacffdd9377b5bfb8a6de3">MED_NONE</a>,<a class="code" href="a00321_a25ee4b3675737fc23511b28b3245c61b.html#a25ee4b3675737fc23511b28b3245c61bad78949eab3c743083dfbf687c92bbdcb">MED_COORDINATE</a>,<a class="code" href="a00321_afcd26ca66a179b9aa82f5c90602c4ed8.html#afcd26ca66a179b9aa82f5c90602c4ed8a2b1e772016688b78b808e96a44d1ee02">MED_NO_CMODE</a>,
                              &amp;chgt,&amp;trsf)) &lt; 0) {
    <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;Erreur a la lecture du nombre de noeuds &quot;</span>);
    <span class="keywordflow">return</span> -1;
  }
  printf(<span class="stringliteral">&quot;Nombre de noeuds : &quot;</span>IFORMAT<span class="stringliteral">&quot; \n&quot;</span>,nnoe);

  <span class="comment">/* Allocations memoires */</span>

  <span class="comment">/* table de la numerotation globale</span>
<span class="comment">     profil : (nombre de noeuds ) */</span>
  <span class="keywordflow">if</span> (nnoe &gt; 0) {
    numglobalnoe = (<a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a>*) malloc(<span class="keyword">sizeof</span>(<a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a>)*nnoe);
    <span class="keywordflow">for</span> (i=0;i&lt;nnoe;i++) {
      numglobalnoe[i]=i+100;
    }
  }

  <span class="comment">/* ecriture de la numerotation globale */</span>

  <span class="keywordflow">if</span> (<a class="code" href="a01011_ga7368d6375462e4390041bae334cfcb43.html#ga7368d6375462e4390041bae334cfcb43" title="Cette routine permet l&amp;#39;écriture d&amp;#39;une numérotation globale sur un maillage...">MEDmeshGlobalNumberWr</a>(fid,maa,<a class="code" href="a00321_a8f72b6ceb3b6f5a67f9efd46cb90707a.html#a8f72b6ceb3b6f5a67f9efd46cb90707a">MED_NO_DT</a>,<a class="code" href="a00321_a95919207fd7a18ba26e6e03f04811e3f.html#a95919207fd7a18ba26e6e03f04811e3f">MED_NO_IT</a>,<a class="code" href="a00321_aab0e957294723517d5c3641bb71b0470.html#aab0e957294723517d5c3641bb71b0470a074507163b07b6d764823a78c5c07f0f">MED_NODE</a>,<a class="code" href="a00321_a9a2843c7d6eacffdd9377b5bfb8a6de3.html#a9a2843c7d6eacffdd9377b5bfb8a6de3">MED_NONE</a>,nnoe,numglobalnoe)&lt;0) {
    <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;Erreur a l&apos;&apos;ecriture de la numerotation globale&quot;</span>);
    <span class="keywordflow">return</span> -1;
  }

  free(numglobalnoe);

  <span class="comment">/* Fermeture du fichier */</span>
  <span class="keywordflow">if</span> (<a class="code" href="a01005_ga12a0e901c376be997a41a073ce426283.html#ga12a0e901c376be997a41a073ce426283" title="Fermeture d&amp;#39;un fichier MED.">MEDfileClose</a>(fid) &lt; 0) {
    <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;Erreur a la fermeture du fichier&quot;</span>);
    <span class="keywordflow">return</span> -1;
  }

  <span class="keywordflow">return</span> 0;
}




</pre></div> <div class="fragment"><pre class="fragment"><span class="comment">/*  This file is part of MED.</span>
<span class="comment"> *</span>
<span class="comment"> *  COPYRIGHT (C) 1999 - 2012  EDF R&amp;D, CEA/DEN</span>
<span class="comment"> *  MED is free software: you can redistribute it and/or modify</span>
<span class="comment"> *  it under the terms of the GNU Lesser General Public License as published by</span>
<span class="comment"> *  the Free Software Foundation, either version 3 of the License, or</span>
<span class="comment"> *  (at your option) any later version.</span>
<span class="comment"> *</span>
<span class="comment"> *  MED is distributed in the hope that it will be useful,</span>
<span class="comment"> *  but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="comment"> *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<span class="comment"> *  GNU Lesser General Public License for more details.</span>
<span class="comment"> *</span>
<span class="comment"> *  You should have received a copy of the GNU Lesser General Public License</span>
<span class="comment"> *  along with MED.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span>
<span class="comment"> */</span>

<span class="comment">/******************************************************************************</span>
<span class="comment"> * - Nom du fichier : test32.c</span>
<span class="comment"> *</span>
<span class="comment"> * - Description : lecture nominale d&apos;une numerotation globale dans un maillage MED </span>
<span class="comment"> *</span>
<span class="comment"> *****************************************************************************/</span>

<span class="preprocessor">#include &lt;med.h&gt;</span>
<span class="preprocessor">#define MESGERR 1</span>
<span class="preprocessor"></span><span class="preprocessor">#include &lt;med_utils.h&gt;</span>

<span class="preprocessor">#ifdef DEF_LECT_ECR</span>
<span class="preprocessor"></span><span class="preprocessor">#define MODE_ACCES MED_ACC_RDWR</span>
<span class="preprocessor"></span><span class="preprocessor">#elif DEF_LECT_AJOUT</span>
<span class="preprocessor"></span><span class="preprocessor">#define MODE_ACCES MED_ACC_RDEXT</span>
<span class="preprocessor"></span><span class="preprocessor">#else</span>
<span class="preprocessor"></span><span class="preprocessor">#define MODE_ACCES MED_ACC_CREAT</span>
<span class="preprocessor"></span><span class="preprocessor">#endif</span>
<span class="preprocessor"></span>
<span class="keywordtype">int</span> <a class="code" href="a00750_a3c04138a5bfe5d72780bb7e82a18e627.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a> (<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> **argv)


{
  <a class="code" href="a00320_abd29d7c6abaef5da2a5ed1b73464f0ba.html#abd29d7c6abaef5da2a5ed1b73464f0ba">med_err</a> ret = 0;
  <a class="code" href="a00320_afa4ec8284026c8c5545e5333475fb65a.html#afa4ec8284026c8c5545e5333475fb65a">med_idt</a> fid;
  <a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> mdim,sdim;
  <span class="keywordtype">char</span> maa[<a class="code" href="a00321_a0ae989cbbfeecbb5296b3ceba8dab886.html#a0ae989cbbfeecbb5296b3ceba8dab886">MED_NAME_SIZE</a>+1];
  <span class="comment">/* le nombre de noeuds */</span>
  <a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> nnoe = 0;
  <span class="comment">/* table des numeros global */</span>
  <a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> *numglobalnoe=NULL;
  <span class="comment">/* variable de stockage pour reperer le maillage */</span>
  <a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> i;
  <span class="keywordtype">char</span> des[<a class="code" href="a00321_ab69710ecf9f5257080a943579852d0f0.html#ab69710ecf9f5257080a943579852d0f0">MED_COMMENT_SIZE</a>+1]=<span class="stringliteral">&quot;&quot;</span>;
  <span class="keywordtype">char</span> dtunit[<a class="code" href="a00321_a213ecd1a546eb96092b980a870bc386b.html#a213ecd1a546eb96092b980a870bc386b">MED_SNAME_SIZE</a>+1]=<span class="stringliteral">&quot;&quot;</span>;
  <span class="keywordtype">char</span> nomcoo[3*<a class="code" href="a00321_a213ecd1a546eb96092b980a870bc386b.html#a213ecd1a546eb96092b980a870bc386b">MED_SNAME_SIZE</a>+1]=<span class="stringliteral">&quot;&quot;</span>;
  <span class="keywordtype">char</span> unicoo[3*<a class="code" href="a00321_a213ecd1a546eb96092b980a870bc386b.html#a213ecd1a546eb96092b980a870bc386b">MED_SNAME_SIZE</a>+1]=<span class="stringliteral">&quot;&quot;</span>;
  <a class="code" href="a00321_a57867e4bed1d104c865cfc9d23c9204d.html#a57867e4bed1d104c865cfc9d23c9204d">med_axis_type</a> rep;
  <a class="code" href="a00321_a821a4dd94c5c6b095318432bdec8d8a1.html#a821a4dd94c5c6b095318432bdec8d8a1">med_mesh_type</a> type;
  <a class="code" href="a00321_a5b97067a30629cd60470d074691d6798.html#a5b97067a30629cd60470d074691d6798">med_sorting_type</a> sort;
  <a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> nstep=0;
  <a class="code" href="a00321_a23f7fa6d76886ed3c91dc33b59190dee.html#a23f7fa6d76886ed3c91dc33b59190dee">med_bool</a> chgt=<a class="code" href="a00321_a23f7fa6d76886ed3c91dc33b59190dee.html#a23f7fa6d76886ed3c91dc33b59190deea30b70cc2a253ed4141db9a78ba696046">MED_FALSE</a>,trsf=<a class="code" href="a00321_a23f7fa6d76886ed3c91dc33b59190dee.html#a23f7fa6d76886ed3c91dc33b59190deea30b70cc2a253ed4141db9a78ba696046">MED_FALSE</a>;



  <span class="keywordflow">if</span> (argc != 2) {
    <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;Il faut passer un fichier MED en param�tre&quot;</span>);
    <span class="keywordflow">return</span> -1;
  }

  <span class="comment">/* Ouverture du fichier passe en argument */</span>
  <span class="keywordflow">if</span> ((fid = <a class="code" href="a01005_ga9376a1654b7bf099c3f8941074c5fdfb.html#ga9376a1654b7bf099c3f8941074c5fdfb" title="Ouverture d&amp;#39;un fichier MED.">MEDfileOpen</a>(argv[1],<a class="code" href="a00321_adcd0322de9fec3b5e199ffeda3f44c85.html#adcd0322de9fec3b5e199ffeda3f44c85ab53f10a6b700d1087d7a50710fe29f00">MED_ACC_RDWR</a>)) &lt; 0) {
    <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;Erreur a l&apos;ouverture du fichier : &quot;</span>); <a class="code" href="a00348_a257959db0a78623caa051d11ceb2f8cb.html#a257959db0a78623caa051d11ceb2f8cb">SSCRUTE</a>(argv[1]);
    <span class="keywordflow">return</span> -1;
  }

  <span class="keywordflow">if</span> ((sdim=<a class="code" href="a01011_gad36ab4651405ed8542fb2a63e2fc44da.html#gad36ab4651405ed8542fb2a63e2fc44da" title="Cette routine permet de lire dans un maillage le nombre d&amp;#39;axes du repère des...">MEDmeshnAxis</a>(fid, 1)) &lt;0) {
    <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;Erreur � la lecture de la dimension de l&apos;espace du maillage :&quot;</span>);
    <a class="code" href="a00348_a257959db0a78623caa051d11ceb2f8cb.html#a257959db0a78623caa051d11ceb2f8cb">SSCRUTE</a>(maa);
    <span class="keywordflow">return</span> -1;
  }

  <span class="comment">/* Lecture des infos concernant le premier maillage */</span>
  <span class="keywordflow">if</span> ( <a class="code" href="a01011_ga71e0d79fbb40abdc9c20bc5be01441ac.html#ga71e0d79fbb40abdc9c20bc5be01441ac" title="Cette routine permet de lire les informations relatives à un maillage dans un fichier...">MEDmeshInfo</a>( fid, 1,  maa, &amp;sdim, &amp;mdim, &amp;type, des, dtunit, &amp;sort,
                    &amp;nstep,  &amp;rep, nomcoo,unicoo) &lt; 0 ) {
    <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;Erreur a la lecture des informations sur le maillage : &quot;</span>);<a class="code" href="a00348_a257959db0a78623caa051d11ceb2f8cb.html#a257959db0a78623caa051d11ceb2f8cb">SSCRUTE</a>(maa);
    <span class="keywordflow">return</span> -1;
  } <span class="keywordflow">else</span> {
    printf(<span class="stringliteral">&quot;Maillage de nom : |%s| , de dimension : &quot;</span>IFORMAT<span class="stringliteral">&quot; , et de type %d\n&quot;</span>,maa,mdim,type);
    printf(<span class="stringliteral">&quot;\t -Dimension de l&apos;espace : &quot;</span>IFORMAT<span class="stringliteral">&quot;\n&quot;</span>,sdim);
    printf(<span class="stringliteral">&quot;\t -Description du maillage : %s\n&quot;</span>,des);
    printf(<span class="stringliteral">&quot;\t -Noms des axes : %s\n&quot;</span>,nomcoo);
    printf(<span class="stringliteral">&quot;\t -Unit�s des axes : %s\n&quot;</span>,unicoo);
    printf(<span class="stringliteral">&quot;\t -Type de rep�re : %d\n&quot;</span>,rep);
    printf(<span class="stringliteral">&quot;\t -Nombre d&apos;�tapes de calcul : &quot;</span>IFORMAT<span class="stringliteral">&quot;\n&quot;</span>,nstep);
    printf(<span class="stringliteral">&quot;\t -Unit� des dates : %s\n\n&quot;</span>,dtunit);
  }

  <span class="comment">/* Lecture du nombre de noeuds */</span>
  <span class="keywordflow">if</span> ( (nnoe = <a class="code" href="a01011_ga45758103360dacf7b8a6c53ebfa4d7e5.html#ga45758103360dacf7b8a6c53ebfa4d7e5" title="Cette routine permet de lire le nombre d&amp;#39;entités dans un maillage pour une séquence...">MEDmeshnEntity</a>(fid,maa,<a class="code" href="a00321_a8f72b6ceb3b6f5a67f9efd46cb90707a.html#a8f72b6ceb3b6f5a67f9efd46cb90707a">MED_NO_DT</a>,<a class="code" href="a00321_a95919207fd7a18ba26e6e03f04811e3f.html#a95919207fd7a18ba26e6e03f04811e3f">MED_NO_IT</a>,
                              <a class="code" href="a00321_aab0e957294723517d5c3641bb71b0470.html#aab0e957294723517d5c3641bb71b0470a074507163b07b6d764823a78c5c07f0f">MED_NODE</a>,<a class="code" href="a00321_a9a2843c7d6eacffdd9377b5bfb8a6de3.html#a9a2843c7d6eacffdd9377b5bfb8a6de3">MED_NONE</a>,<a class="code" href="a00321_a25ee4b3675737fc23511b28b3245c61b.html#a25ee4b3675737fc23511b28b3245c61bad78949eab3c743083dfbf687c92bbdcb">MED_COORDINATE</a>,<a class="code" href="a00321_afcd26ca66a179b9aa82f5c90602c4ed8.html#afcd26ca66a179b9aa82f5c90602c4ed8a2b1e772016688b78b808e96a44d1ee02">MED_NO_CMODE</a>,
                              &amp;chgt,&amp;trsf)) &lt; 0) {
    <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;Erreur a la lecture du nombre de noeuds &quot;</span>);
    <span class="keywordflow">return</span> -1;
  }
  printf(<span class="stringliteral">&quot;Nombre de noeuds : &quot;</span>IFORMAT<span class="stringliteral">&quot; \n&quot;</span>,nnoe);


  <span class="comment">/* Allocations memoires */</span>

  <span class="comment">/* table de la numerotation globale</span>
<span class="comment">     profil : (nombre de noeuds ) */</span>
  <span class="keywordflow">if</span> (nnoe &gt; 0) {
    numglobalnoe = (<a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a>*) malloc(<span class="keyword">sizeof</span>(<a class="code" href="a00320_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a>)*nnoe);
  }

  <span class="comment">/* lecture de la numerotation globale attachee aux noeuds*/</span>
  <span class="keywordflow">if</span> (<a class="code" href="a01011_gab28f41670fee25385d66d45a0d86d93f.html#gab28f41670fee25385d66d45a0d86d93f" title="Cette routine permet la lecture d&amp;#39;une numérotation globale sur un maillage pour...">MEDmeshGlobalNumberRd</a>(fid,maa,<a class="code" href="a00321_a8f72b6ceb3b6f5a67f9efd46cb90707a.html#a8f72b6ceb3b6f5a67f9efd46cb90707a">MED_NO_DT</a>,<a class="code" href="a00321_a95919207fd7a18ba26e6e03f04811e3f.html#a95919207fd7a18ba26e6e03f04811e3f">MED_NO_IT</a>,<a class="code" href="a00321_aab0e957294723517d5c3641bb71b0470.html#aab0e957294723517d5c3641bb71b0470a074507163b07b6d764823a78c5c07f0f">MED_NODE</a>,<a class="code" href="a00321_a9a2843c7d6eacffdd9377b5bfb8a6de3.html#a9a2843c7d6eacffdd9377b5bfb8a6de3">MED_NONE</a>,numglobalnoe)&lt;0) {
    <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;Erreur a la lecture de de la numerotation globale&quot;</span>);
    <span class="keywordflow">return</span> -1;
  }

  <span class="comment">/* ecriture a l&apos;ecran des resultats */</span>
  <span class="keywordflow">for</span> (i=0;i&lt;nnoe;i++)
    printf(<span class="stringliteral">&quot;Numero global du noeud &quot;</span>IFORMAT<span class="stringliteral">&quot; : &quot;</span>IFORMAT<span class="stringliteral">&quot; \n&quot;</span>,i+1,numglobalnoe[i]);

  free(numglobalnoe);

  <span class="comment">/* Fermeture du fichier */</span>
  <span class="keywordflow">if</span> (<a class="code" href="a01005_ga12a0e901c376be997a41a073ce426283.html#ga12a0e901c376be997a41a073ce426283" title="Fermeture d&amp;#39;un fichier MED.">MEDfileClose</a>(fid) &lt; 0) {
    <a class="code" href="a00348_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;Erreur a la fermeture du fichier &quot;</span>);
    <span class="keywordflow">return</span> -1;
  }

  <span class="keywordflow">return</span> 0;
}

</pre></div> <p><br/>
<br/>
  </p>
</div>
<hr size="1"/><address style="text-align: right;"><small>Généré le Mon Nov 19 15:43:45 2012 pour MED fichier par&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
